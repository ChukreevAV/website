<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Начало работы с OpenStreetMap</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Начало работы с OpenStreetMap</h1>
<p class="ann">Как принять участие в OpenStreetMap от А до Я.</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=2419"--></span></p>
<p><a href="http://openstreetmap.org/" target="_blank" class="external">OpenStreetMap</a> (далее OSM) - онлайн карта мира и удивительный феномен современной геоинформатики, получивший свое распространение засчет бурного развития веб-картографии и концепции свободного программного обеспечения (opensource), включающей активное использование краудсорсинга (crowdsourcing). <a href="http://ru.wikipedia.org/wiki/%D0%9A%D1%80%D0%B0%D1%83%D0%B4%D1%81%D0%BE%D1%80%D1%81%D0%B8%D0%BD%D0%B3" target="_blank" class="external">Краудсорсинг</a> - процесс создание чего-либо силами сообщества, члены которого мало связаны между собой. Каждый добавляет по кусочку и результаты, как правило, тоже являются достоянием общественности. Данные создаваемые в рамках OpenStreetMap распространяются по лицензии <a href="http://creativecommons.org/licenses/by-sa/2.0/" title="http://creativecommons.org/licenses/by-sa/2.0/" target="_blank" class="external" rel="nofollow">Creative Commons Attribution-ShareAlike 2.0</a>, подразумевающей свободное распространение, результаты любых изменений должны публиковаться под той же лицензией. Несмотря на название, в OSM содержится и картируется масса других данных, помимо уличной сети. </p>
            <p>Данная статья представляет из себя быстрое введение в тему, написанное специально для тех, кто хочет начать работу с OSM.  В статье демонстрируется программное обеспечение работающее под Windows, но все упоминаемые продукты так же работают и под  системами на базе Unix. Следует отметить, что на сайте OpenStreetMap есть подобное описание работы с системой, в чем-то более подробное. Мы всячески рекомендуем использовать его для ознакомления, если информации в данной статье недостаточно. Так же, рекомендуем обратить в <a href="http://forum.openstreetmap.org/viewforum.php?id=21" target="_blank" class="external">русскоязычный форум</a> сообщества OpenStreetMap, где обязательно найдется ответ на ваш вопрос. Данное руководство, хотя и написано полностью заново, во многом перекликается по структуре с &quot;<a href="http://wiki.openstreetmap.org/index.php/Ru:Beginners_Guide" target="_blank" class="external">Руководством для начинающих</a>&quot; размещенного на Wiki OpenStreetMap, с которым мы всячески рекомендуем ознакомиться, при возникновении проблем.</p>
            <p>Для начала установим некоторые определения:</p>
            <ul>
              <li>трек - набор точек, полученных с помощью GPS;</li>
              <li>объект - точечный, линейный или полигональный объект созданный по треку или аэро/космоснимку.</li>
            </ul>
            <p>Вариантов создания данных в OSM существует несколько, в данной статей мы рассмотрим создание объектов по собранным трекам (отметим, что принимать участие в OSM можно и не имея GPS в принципе, об этом в следующих статьях). Итак, для работы нам понадобятся: </p>
            <ul>
              <li>GPSBabel</li>
              <li>Трэки</li>
              <li>Доступ в интернет и, соответственно, веб-браузер</li>
            </ul>
            <p><strong>Оглавление</strong></p>
            <ol>
              <li><a href="#01">Сбор данных </a></li>
              <li><a href="#02">Подготовка данных</a></li>
              <li><a href="#03">Загрузка данных в OSM</a></li>
              <li><a href="#04">Редактирование данных</a>
                <ul>
                  <li><a href="#start">Начало работы</a> </li>
                  <li><a href="#view">Настройка вида </a></li>
                  <li><a href="#gps">Просмотр треков GPS</a></li>
                  <li><a href="#correct">Исправление снимка</a></li>
                  <li><a href="#create">Создание объекта </a></li>
                  <li><a href="#attrib">Редактирование атрибутивной информации</a> </li>
                  <li><a href="#finish">Завершение работы </a></li>
                  <li><a href="#results">Просмотр результатов</a></li>
                </ul>
              </li>
            </ol>
            <!-- Первый раздел -->
            <p>Рассмотрим работу на конкретном примере. </p>
            <h2>1. <a name="01" id="01"></a>Сбор данных</h2>
            <p>Подразумевается, что перед началом работы вы уже прошлись/проехались по улицам/дорогам отсутствующим в OSM и эти данные в виде треков присутствуют в вашем GPS. Для удобства и чтобы не загружать в OSM лишних данных, некоторые из которых могут быть конфиденциальными, рекомендуется так или иначе обособить трек, который нужно загрузить в OSM. Это можно сделать например пройдя/проехав маршрут в определенный день (включив GPS в начале и выключив в конце трека), маршрутом может быть определенная улица, тропинка, контур-полигон.</p>
            <p>Если вы по ошибке загрузили в OSM трек с данными, которые бы вы не хотели показывать сообществу по той или иной причине, например в трек попало расположение дома, где вы живете, ничего страшного - вы сможете, нарисовав дорогу, удалить трек из OSM или же, при загрузке трека в базу, сделать его доступным только для вас (статус: PRIVATE).</p>
            <h2>2. <a name="02" id="02"></a>Подготовка данных</h2>
            <p>Данные, собранные с помощью GPS, нужно преобразовать в формат GPX. Для этого можно воспользоваться программой GPSBabel (<a href="http://www.gpsbabel.org/download.html" target="_blank" class="external">загрузить</a>). В данном примере показана работа с устройством Garmin, для других устройств (Magellan, DeLorme) необходимо выбрать соответствующую запись в пункте Input [Device]. Для работы с программой необходимо:</p>
            <ol>
              <li> Подключить GPS к компьютеру с помощью USB или COM кабеля. </li>
              <li>Включить режим получения данных с устройства ([Device])</li>
              <li>Выбрать источник данных (например Garmin serial/USB protocol)</li>
              <li>Выбрать порт (в нашем случае USB или COM)</li>
              <li>Выбрать выходной формат (GPX XML) и имя файла</li>
              <li>Выбрать то что нужно получить с GPS (в нашем случае Tracks)</li>
            </ol>
            <p align="center"><img src="/images/osm-begin-01.gif" alt="osm-begin" width="714" height="470" align="center" /></p>
            <p>В соответствие с иллюстрацией, того же результата можно добиться просто запустив вариант GPSBabel для командной строки, используя команду: </p>
            <pre>gpsbabel.exe -p &quot;&quot; -t -i garmin -f usb: -o gpx -F &quot;C:\temp\new.gpx&quot;</pre>
            <p>Для того, чтобы немного упорядочить процесс редактирования, загрузим только часть треков, ограничив выборку по времени некоторой датой. Для этого либо укажем нужную дату в настройках Filter\Start at, либо модифицируем строку вызова (в данном случае будут загружены все данные собранные 27 июля 2008):</p>
            <pre>gpsbabel.exe -p &quot;&quot; -t -i garmin -f usb: -x track,start=20080728000000 -o gpx -F &quot;C:\temp\osm-begin\picnic.gpx&quot;</pre>
            <h2>3.<a name="03" id="03"></a>Загрузка данных в OSM</h2>
            <p>Перед загрузкой данных необходимо <a href="http://openstreetmap.org/user/new" target="_blank" class="external">создать учетную запись</a> в OSM, имейте в виду, что учетная запись в OSM Wiki и самом OSM - разные вещи.</p>
            <p>После создания учетной записи, необходимо зайти в OSM, используя ее и перейти в личный раздел<strong> </strong>щелкнув на своем имени в правом верхнем углу.</p>
            <p>На открывшейся странице, нужно выбрать <strong>My traces</strong> (мои треки), указать файл GPX, задать описание и ключевые слова. В зависимости от того, хотите ли вы чтобы трек был доступен и другим пользователям или хотите оставить его только для своей работы можно установить или снять флаг Public. Заметим, что людям, работающим в этом же районе ваши треки могут пригодиться, поэтому рекомендуем его все-таки включать.</p>
            <p>Каждый трек получает уникальный номер.  </p>
            <p>После того как трек загружен, он показывается как Pending, это означает, что он стоит в очереди загрузки в систему.</p>
            <p align="center"><img src="/images/osm-begin-04.gif" alt="osm-begin" width="458" height="65" align="center" /></p>
            <p>Однако это не значит, что мы не можем немедленно начать использовать эти данные, поэтому, выбрав Edit (редактировать) на только загруженном треке (не обращая внимания на надпись Pending), перейдем к редактированию. Через некоторое время, обычно 2-3 дня этот статус сменяется на анимированное изображение трека, нам дожидаться этого момента необязательно.</p>
            <h2>4. <a name="03" id="03"></a>Редактирование данных</h2>
            <p><a name="start" id="start"></a>Два основных способа редактирования данных в OSM это онлайн редакция с помощью инструмента Potlatch построенного на базе Flash или оффлайн редакция с помощью <a href="http://josm.openstreetmap.de" target="_blank" class="external">JOSM</a> (Java) или <a href="http://wiki.openstreetmap.org/index.php/Merkaartor" target="_blank" class="external">Merkaator</a>(С++). JOSM/Merkaator устанавливается как отдельное приложение, может загружать существующие данные из OSM и треки GPS, а так же создавать/редактировать данные по трекам или изображениям (<a href="/qa/josm-start.html">подробнее о работе в JOSM</a>). Merkaator обладает несколько меньшими системными требованиями. Оба инструмента находятся в активной разработке. Для того, чтобы получить максимум функциональности от оффлайн редакторов все же необходимо подключение к интернет, для загрузки снимков и выгрузки данных обратно в OSM. </p>
            <p>Хотя JOSM обладает несравненно большей функциональностью, в целях простоты иллюстрации в этой статье мы рассмотрим работу с Potlatch. Как уже говорилось вначале, загрузить GPS треки в OSM мало, нужно еще создать объекты используя эти треки.</p>
            <h3><strong>Начало работы</strong></h3>
            <p>После загрузки треков с помощью формы на OSM Wiki, нажмем на ссылку Edit (Правка) или просто найдем область работы и нажмем Edit.</p>
            <p align="center"><img src="/images/osm-begin-23.gif" alt="osm-begin" width="554" height="322" align="center" /></p>
            <p>Это приведет к тому, что в текущем окне браузера запустится приложение Potlatch, сфокусированное на то место, где находятся данные только что загруженного трека. Некоторое время понадобится на загрузку трека:</p>
            <p align="center"><span><img src="/images/osm-begin-05.gif" alt="osm-begin" width="321" height="70" align="center" /></span></p>
            <p>После первой загрузки появится окно, предлагающее выбрать из двух режимов редактирования. Первый: Edit with save - вы сначала редактируете, а потом, когда хотите - сохраняете. Второй: любые изменения сразу сохраняются. Если вы новичок, рекомендуем воспользоваться первым режимом. </p>
            <p align="center"><img src="/images/osm-begin-03.gif" alt="osm-begin" width="349" height="266" align="center" /></p>
            <p>При редактировании данных OSM, соблюдайте несколько простых правил. </p>
            <ul>
              <li>данные не должны копироваться из других, особенно несвободных источников</li>
              <li>точность - важна, картируйте места которые хорошо знаете</li>
              <li>и наконец - получайте удовольствие от процесса редактирования карт. </li>
            </ul>
            <p align="center">&nbsp;</p>
            <p>Для начала редактирования - нажмем кнопку <em>Edit with save</em> или <em>Edit live</em>. </p>
            <h3><strong><a name="view" id="view"></a></strong>Настройка общего вида </h3>
            <p>По умолчанию, если вы имеете дело со снимками, они показываются осветленными, чтобы выключить этот режим и видеть снимки контрастно, выберем кнопку <span><img src="/images/osm-begin-13.gif" alt="osm-begin" width="25" height="22" align="center" /></span>и выключим режим осветления (галочка на Fade background должна быть снята).</p>
            <p align="center"><span><img src="/images/osm-begin-20.gif" alt="osm-begin" width="430" height="246" align="center" /></span></p>
            <p>После этого снимки приобретут контрастный и красочный вид.</p>
            <p align="center"><span><img src="/images/osm-begin-21.gif" alt="osm-begin" width="600" height="379" align="center" /></span> </p>
            <p>Если Вы работаете по Европейской части России и на вашу территорию снимки по умолчанию не очень хорошего качества, попробуйте использовать данные спутника IRS. Для этого, в настройках в поле Custom введите: </p>
            <pre>http://retile.latlon.org/irs/!/!/!.jpg</pre>
            <h3><strong><a name="gps" id="gps"></a></strong>Просмотр треков GPS </h3>
            <p>Вернемся к данным GPS, свежезагруженные треки показываются светлоголубым цветом. Если у вас нет своего трека - не беда, можно использовать чужие треки, если они загружены для общего пользования, если Вы хотите использовать чужие треки, необходимо включить их отображение с помощью кнопки Show GPS tracks.</p>
            <p align="center"><span><img src="/images/osm-begin-06.gif" alt="osm-begin" width="500" height="433" align="center" /></span></p>
            <p>Красная надпись Editing map показывает, что мы находимся в режиме редактирование и объекты, которые мы собираемся создать будут сохранены в базе данных OSM. На некоторые территории существуют данные высокого разрешения, предоставленные OSM Yahoo!, о чем свидетельствует их логотип в нижнем правом углу. Эти данные могут сильно помочь процессу создания объектов, хотя их можно создать и без них. </p>
            <p>После загрузки трека и основы, загрузятся уже существующие в данном районе данные OSM, к которым мы собираемся добавить наш объект.</p>
            <p align="center"><span><img src="/images/osm-begin-07.gif" alt="osm-begin" width="500" height="431" align="center" /></span> </p>
            <h3><a name="correct" id="correct"></a>Исправление снимка</h3>
            <p>Внимательно изучим совпадение трека и снимка. Редакторы Potlatch и JOSM позволяют исправить положение снимка, если трек с ним не совпадает. Необходимо иметь в виду, что в 99.9% случаев, данные трека являются более точными, чем данные дистанционного зондирования - особенно космическая съемка <a href="http://gis-lab.info/projects/ss/sensor/etmplus.html" target="_blank" class="external">Landsat</a>, используемая для подавляющего большинства территорий. Поэтому, если снимок не точно соответствует треку - можно его (снимок) скорректировать. Для этого, при нажатом пробеле можно перемещать снимок вверх-вниз-вправо-влево для лучшего соответствия треку. Следует учесть, что это не всегда необходимо и рекомендуется использовать только при наличие треков. </p>
            <h3><a name="create" id="create"></a>Создание объекта</h3>
            <p>Используя трек создадим по нему наш объект, в данном случае тропинку в лесу, последовательно щелкая вдоль трека до соединения с другой тропинкой. Используем некоторые правила:</p>
            <ol>
              <li>Если треков GPS несколько (что обычно и происходит если один и тот же маршрут пройден несколько раз), описывающая их линия должна являться их средней.</li>
              <li>Если первый/последний узел маршрута лежит на другом объекте, то он должен начинаться с этого одного из узлов этого объекта. Корректная связь объектов между собой сделает результирующую картинку более четкой и сделает возможной работу с данными как со связанной сетью </li>
            </ol>
            <p>Для начала выделим существующий объект, другую дорожку:</p>
            <p align="center"><span><img src="/images/osm-begin-09.gif" alt="osm-begin" width="500" height="431" align="center" /></span> </p>
            <p>Для начала отрисовки нашего объекта нужно определить узел с которого он будет начинаться. При создании объектов, кто собственно их самих, так же важно следить за их правильными взаимоотношениями с другими объектами (топологией), в частности это означает, что пересечения и соединения линейных объектов должны иметь общий узел. Соблюдение этих правил позволит использовать данные OSM для прокладки маршрутов и других задач, учитывающих такие отношения. Итак найдем узел подходящий для начала нашей дороги:</p>
            <p align="center"><span><img src="/images/osm-begin-10.gif" alt="osm-begin" width="168" height="80" align="center" /></span> </p>
            <p>Нажав клавишу SHIFT, щелкнем на этом узле:</p>
            <p align="center"><span><img src="/images/osm-begin-11.gif" alt="osm-begin" width="161" height="72" align="center" /></span></p>
            <p> Продолжим отрисовку, последовательно щелкая вдоль трека, создав таким образом весь маршрут:</p>
            <p align="center"><span><img src="/images/osm-begin-12.gif" alt="osm-begin" width="500" height="179" align="center" /></span> </p>
            <p>Так как завершение линии тоже требует примыкания, при создании последнего узла следует быть внимательным. При наведении курсора на линию к которой примыкает новая нужно убедиться, что последний узел попадает на подходящий узел линии, к которой осуществляется примыкание. Узлы создаваемой линии показываются красным цветом, узлы линии, к которой осуществляется примыкание - синим. Закончить линию можно двойным щелчком мыши. </p>
            <p align="center"><span><img src="/images/osm-begin-14.gif" alt="osm-begin" width="160" height="176" align="center" /></span></p>
            <p>После завершения, новая линия будет отображаться серым цветом по умолчанию:</p>
            <p align="center"><span><img src="/images/osm-begin-15.gif" alt="osm-begin" width="652" height="271" align="center" /></span> </p>
            <h3><a name="attrib" id="attrib"></a>Редактирование атрибутивной информации</h3>
            <p>Второй неотъемлимой частью пространственных данных, кроме геометрии, которую мы только что создали является атрибутивная информация. Каждому созданному объекту необходимо задать один или больше параметров. Редактирование атрибутики осуществляется с помощью панели расположенной внизу окна Potlatch, под картой. Так выглядит эта часть окна, если ни один объект не выбран: </p>
            <p><span><img src="/images/osm-begin-08.gif" alt="osm-begin" width="725" height="131" align="center" /></span></p>
            <p>После создания объекта, поля заполнены некоторыми значениями по умолчанию, как мы видим у нового линейного объекта пока нет атрибутов и номер объекта - отрицательный, что говорит о том, что он еще не загружен в общую базу и не получил уникального идентификатора в системе:</p>
            <p><span><img src="/images/osm-begin-16.gif" alt="osm-begin" width="725" height="130" align="center" /></span> </p>
            <p>Для изменения значений можно использовать два подхода. Первый, изменять значения, сначала выбрав тип объекта, нажав на пиктограмму автомобиля, затем выбрать из выпадающего списка подтип. Затем нажав на кнопку с знаком плюс добавить необходимое количество тэгов, таких как имя (name), тип дороги (highway) и другие. Изучить атрибуты других объектов в окрестностях можно просто нажимая на них. Посмотрим на соседнюю тропу такого же типа, как и вновь нами созданная:</p>
            <p><span><img src="/images/osm-begin-17.gif" alt="osm-begin" width="701" height="502" align="center" /></span> </p>
            <p>Второй, быстрый способ ввести атрибуты  использовать кнопку копирования атрибутов с другого объекта. </p>
            <p><span><img src="/images/osm-begin-18.gif" alt="osm-begin" width="694" height="512" align="center" /></span></p>
            <p>Она работает следующим образом, копирование осуществляется с последнего выбранного объекта. То есть, вы выбираете объект с атрибутами, затем выбираете свой и нажимаете кнопку копировать атрибуты. </p>
            <p><img src="/images/osm-begin-19.gif" alt="osm-begin" width="700" height="474" align="center" /></p>
            <h3><a name="finish" id="finish"></a>Завершение работы</h3>
            <p>Геометрия и атрибуты созданы, редактирование закончено. Для сохранения результатов нужно сохранить изменения щелкнув где-либо вне редактируемого объекта, чтобы снять с него выделение.</p>
            <p>После этого, необходимо нажать на кнопку <em>Save</em> и ввести краткое описание изменений:</p>
            <p align="center"><img src="/images/osm-begin-22.gif" alt="osm-begin" width="301" height="159" align="center" /> </p>
            <h3><a name="results" id="results"></a>Просмотр результатов</h3>
            <p>Потребуется некоторое время (от нескольких минут до 1-2 часов) для того, чтобы созданные объекты  появились на самой карте. При этом для редактирования они будут доступны уже сейчас. Результат окончательной отрисовки на OpenStreetMap с помощью Mapnik будет выглядеть примерно так:</p>
            <p align="center"><span><img src="/images/osm-begin-02.gif" alt="osm-begin" width="645" height="437" align="center" /></span> </p>
            <p class="discuss">
				<span><!--#include virtual="/scripts/forum-comments-num.php?i=2419"--></span>
			</p>
			<div class="links">
			<h2>Ссылки по теме</h2>
			<ul>
               <li><a href="osm2shp-ubuntu.html">Подготовка к работе с треками для OSM: GPSBabel и JOSM</a></li>
               <li><a href="http://forum.openstreetmap.org/viewforum.php?id=21" target="_blank" class="external">Русскоязычный форум OpenStreetMap</a></li>
			</ul>
			</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 01.09.2008
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=2" target="_blank">Максим Дубинин</a></span></p>
<!--#include virtual="/inc/footer2.php" -->