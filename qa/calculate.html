<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Использование калькулятора значений при работе с атрибутивной информацией в ArcMap</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Использование калькулятора значений при работе с атрибутивной информацией в ArcMap</h1>
<p class="ann">Использование калькулятора значений при работе с атрибутивной информацией в ArcMap.</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=723"--></span></p>
<p>Calculate Values (калькулятор значений) мощное средство для работы с атрибутивной информации в ArcMap. Данный инструмент позволяет быстро вводитьновые значения, в том числе на основе данных содержащихся в атрибутивной таблице, с помощью него можно значительно автоматизировать часть работы по вводу данных.</p>
            <p>Для того чтобы воспользоваться калькулятором значений, необходимо добавить шейп фаил, геобазу данных, или любой другой поддерживаемый ArcMap векторный фаил в mxd-документ, открыть его таблицу атрибутов, далее выделев какой-либо из столбцов (если вы ничего не меняли в настройках он подсветится светло-голубым цветом) нажать правую кнопку мыши и в появишемся меню выбрать <strong>Calculate Value</strong>.</p>
            <p> Если Вы все сделали правильно, появится следующее окно:</p>
            <table width="100%"  border="0">
              <tr>
                <td valign="top"><ul>
                    <li><strong>Fields - </strong>cписок столбцов содержащихся в таблице;</li>
                    <li><strong>Type - </strong>тип вводимых данных</li>
                    <li><strong>Functions -</strong> список функций доступных для выбраного типа данных;</li>
                    <li>Операторы (умножить, разделить и т.д.) </li>
                    <li>Поле ввода выражения или значения, флажок <strong>Advanced - </strong>включение режима вводе VBA Script кода;. </li>
                    <li><strong>Save / Load -</strong> Сохранить/загрузить составленное выражение.</li>
                  </ul></td>
                <td><span><img src="/images/calculate-01.jpg" width="468" height="431" /></span></td>
              </tr>
            </table>
            <p><strong>Примеры</strong></p>
            <p>Рассмотрим три примера для простого режима, режима Advanced и для работы с текстовыми строками.</p>
            <p><img src="/images/1.gif" width="33" height="41" align="left" />Необходимо расчитать плотность населения некоторого региона. В атрибутивной таблице имеется два поля. Количество населения (<strong><strong>c</strong>olpop</strong>) и Площадь (<strong>sqa</strong>). Для нахождения плотности необходимо Количество населения проживающего в регионе разделить на площадь данного региона. Мы создаем новое поле Плотность населения (<strong>density</strong>) и в калькуляторе значений пишем:</p>
            <p>[<strong>colpop</strong>] / [<strong>sqa</strong>]</p>
            <p> Расчитанное значение будет записано в поле Плотность населения (<strong>density</strong>).</p>
            <p><img src="/images/2.gif" width="33" height="41" align="left" />Предположим, имеется некоторая атрибутивная таблица с одним полем (например, количество постоянного населения какого-либо региона - <strong>colpop</strong>) состоящая из 10 000 записей. Вам необходимо проранжировать данные значения и в зависимости от ранга ввести некий новый код в соответствующее поле. Разумеется, вручную переработать такой объем информации невозможно. Но, применив <strong> VBA </strong><strong> script</strong> можно автоматизировать данный процесс.</p>
            <p>В режиме VBA (переключатель Advanced установлен) нужно ввести следующий текст в поле <strong>Pre-logic VBA Script Code</strong> </p>
            <p align="center"><strong> if [colpop] &gt; 200 then df= &quot;BIG&quot; </strong></p>
            <p align="center"><strong> if [colpop] &lt; 200 then df= &quot;LOW&quot; </strong></p>
            <p>В следующем текстовом поле нужно ввести <strong>df</strong>. В результате все должно выглядеть так:</p>
            <p align="center"><img src="/images/calculate-03.gif" width="361" height="180" /> </p>
            <p>В данном случае, результат (присвоенный код) сохраняется в поле, которое также называется <strong>df</strong> (это поле должно быть текстового типа, так как вводимые значения - &quot;BIG&quot;, &quot;SMALL&quot; - представляют из себя текстовые строки).</p>
            <p>Этот код выполняет два простых условия:</p>
            <p>Если значение колонки <strong>[</strong><strong>colpop] </strong>больше 40, то переменная df равна <strong>&quot;</strong><strong>BIG&quot;, </strong> а если значение меньше 40, то переменная df равна <strong>&quot;LOW&quot;. </strong>Результат, которых получает переменная <strong> df </strong>записывается в одноименное поле (имя поля может быть и другим).</p>
            <p><img src="/images/3.gif" width="33" height="41" align="left" />Очень удобно использовать <strong> Calculate </strong><strong> Values</strong> как расширенную альтернативу инструмента <strong> Найти и заменить (Find &amp; </strong><strong> Replace). </strong></p>
            <p>Данная операция позволяет быстро найти определенную подстроку и заменить ее на другую, результат операции может быть записан в то же поле где хранятся исходные значения и в новое поле. </p>
            <p align="center"><strong>Replace([field] , &quot;text1&quot;, &quot;text2&quot;)</strong></p>
            <p>Пример: Значение &quot;ABC&quot; при операции Replace([field] , &quot;BC&quot;, &quot;BBBBBC&quot;) будет заменено на &quot;ABBBBBC&quot;.</p>
            <p>Если у Вас есть замечания, предложения или иные пути решения обсуждаемых проблем - будем рады добавить недостающую информацию к этой статье. Вы можете отправить свои комментарии используя форму или адрес электронной почты приведенные ниже.</p>
            <p class="discuss">
				<span><!--#include virtual="/scripts/forum-comments-num.php?i=723"--></span>
			</p>
			<div class="links">
			<h2>Ссылки по теме</h2>
			<ul>
               <li><a href="/qa/calculate-funclist.html">Список функций доступных в калькуляторе значений (Calculate)</a></li>
			</ul>
			</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 04.12.2005
<br>Автор(ы): Сергей Шаповалов</p>
<!--#include virtual="/inc/footer2.php" -->