<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Автоматическая установка рабочей папки в Arcview GIS</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Автоматическая установка рабочей папки  в Arcview GIS </h1>
<p class="ann">Как сделать так, чтобы новый проект открывался сразу с настроенной папкой</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=832"--></span></p>

            <p>Тем, кто часто создает проекты Arcview, наверное, задается вопросом,
        как сделать так, чтобы рабочая папка (<b>Working directory</b>) по умолчанию
        была не <b>c:\windows\temp</b> или <b>c:\gis\arcview3</b>, то есть какая-то
        одна (заданная в лучшем случае переменной <b>HOME</b>, см. &quot;<a href="addprjav.html">Добавление
        пользовательских проекций к Arcview</a>&quot;), а, например, была равна той папке в которой содержатся  данные для определенной операции или проекта.
        Это очень удобно, поскольку экономит временя на поиск
        нужной папки в дереве каталогов.</p>
            <h2>1. Изменить рабочую папку </h2>
            <p><span>Самый
              простой способ сделать это, изменив в свойствах ярлыка вызывающего
              проект Arcview рабочую папку. Но этот способ недостаточно гибок и не очень удобен тем, кто держит не несколько настроенных
              проектов и только их использует, а постоянно создает проекты для
              временных операций с данными, при этом папки из которых загружаются
              данные могут быть самыми разными. </span></p>
            <h2>2. Автоматическая установка стартовой папки</h2>
            <p><span>Как
              сделать так чтобы рабочая папка проекта всегда была равно той
              директории из которой загружается Arcview?</span></p>
            <p><span>Достаточно просто, нужно <a href="/qa/addscript.html">добавить
              специальный скрипт</a> (не забудьте его скомпилировать, иначе он
              не будет видем в списке доступных скриптов) и <a href="/qa/addprjav.html#2">добавить
              две переменные окружения <b>PATH</b> и <b>HOME</b></a> (если это
              еще не сделано, также не забудьте перегрузить компьютер после их
              установки):</span></p>
            <p><a href="../programs/scripts/setworkingdir.ave">Скрипт</a>
              должен иметь следующее содержание: </p>
            <pre>aproject = av.GetProject
filen = FileName.GetCWD
aProject.SetWorkDir(filen)</pre>
            <p>Если нужно, чтобы все время задавалась все время одна
              - определенная директория, то нужно модифицировать скрипт следующим
              образом, подставив вместо c:\temp - путь к нужной вам директории:</p>
		<pre>aproject = av.GetProject
filen = FileName.Make(&quot;<b>c:\temp</b>&quot;)
aProject.SetWorkDir(filen)</pre>
            <p>Далее по шагам:</p>
      <p>Шаг 1. В проект по умолчанию (default.apr, если его не существует нужно
        его создать) добавить <b>StartUp</b> скрипт, то есть скрипт, исполняемый
        при загрузке проекта (<b>Project\Properties\StartUp</b>). Work directory должно иметь значение $HOME. </p>
      <p align="center"><img src="../images/av-workdir.gif" width="356" height="290" /></p>
            <p>Шаг 2. Создать или изменить системную переменную Path, добавив
              путь к папке Arcview.<br />
            Пример: <b>PATH=C:\WINDOWS;C:\WINDOWS\COMAND;C:\GIS\ARCVIEW</b></p>
            <p>Шаг 3. Добавить переменную <b>HOME</b>, если она еще
              не добавлена, о том как это сделать можно прочитать в заметке &quot;<a href="addprjav.html">Добавление
              пользовательских проекций к Arcview</a>&quot;. Ее значение должно
              быть равно тому пути, который вы добавили к переменной PATH.</p>
            <h2>3. Запуск Arcview</h2>
            <p>После этого, находясь в нужной папке с помощью
              Total Commander, Far или другого файлового менеджера, достаточно
              набрать в командной строке <b>default.apr</b> что б открыть проект в котором
              уже будет прописана рабочая папка, то есть та папка из которой
              вы запустили <b>default.apr</b>, эта же папка будет появляться первой
              при добавлении тем, что очень удобно. </p>
            <p>Для еще более быстрого запуска Arcview из командной строки с установкой рабочей директории равной той, откуда он запущен, можно создать файл <b>av.bat</b>,
              в который добавить  строку:</p>
              <pre>start /B <b>default.apr</b></pre>
            <p>Файл <b>av.bat</b> нужно поместить в рабочую директорию Arcview по умолчанию (определенную переменной HOME). Тогда запускать настроенный
          проект будет еще проще, просто набрав <b>av</b> в командной строке файлового менеджера, если она у него есть, (например Total Commander).</p>
            <p><b>Совет.</b> Файлу default.apr, после установки
              скрипта лучше назначить атрибут &quot;только для чтения&quot;.</p>
			  <p class="discuss">
			  	<span><!--#include virtual="/scripts/forum-comments-num.php?i=832"--></span>
			</p>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 30.11.2002
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=2" target="_blank">Максим Дубинин</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
