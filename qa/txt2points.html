<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Импорт текстовых табличных данных с координатной привязкой в shape-файл</title>
<!--#include virtual="/inc/header2.txt" -->
<!--Contents start-->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<h1>Импорт  табличных данных с координатной привязкой в shape-файл (Arcview GIS) </h1>
            <p class="ann">XLS -&gt; TXT(CSV) -&gt;
                    SHP Выполнение операции с помощью Arcview GIS</p>
            <p>Если у вас имеется таблица в одном
              из распространенных форматов (простой текстовый файл или файл в
              формате Excel), ее достаточно легко можно превратить в точечный
              (point) файл в формате shape, который затем можно будет легко использовать
              в этой ГИС.</p>
            <p>Единственным условием успешного перевода является
              наличие в вашей таблице минимум двух полей (колонок) в одной из
              которых будут записаны значения широты, а в другой долготы (или
              наоборот, большого значения это не имеет).</p>
            <p><img src="/images/1.gif" width="33" height="41" align="left" /> <b>Сохранение из Excel</b></p>
            <p>&nbsp;</p>
            <p>Допустим ваши данные находятся в таблице Excel. Для
              правильного их сохранения, в первой строке, у всех колонок должно
              быть название поля, иначе названием поля станет первая цифра (значение)
              стоящая в первой строке этого поля и вы потеряете одну точку.</p>
            <p align="center"><img src="/images/import-points01.gif" width="586" height="154" /></p>
            <p>Далее, если экспорт производится из формата CSV (comma-separated
              values), нужно в свойствах системы установить правильный разделитель
              элементов списка - <b>им должна быть запятая</b> (comma), по умолчанию
              в системе разделителем является точка с запятой (semicolon). Так
              же нужно, чтобы <b>разделителем целой и дробной части числа была
              точка</b>, а не запятая (по умолчанию).</p>
            <p><img src="/images/import-points02.gif" width="301" height="358" align="left" /></p>
            <p>Для смены разделителей, нужно в свойствах Windows
              Пуск\Настройка\Панель управления\Язык и стандарты, в закладке &quot;Числа&quot;
              изменить разделитель с точки - запятой, на просто запятую.</p>
            <p>Если в тексте содержащемся в таблицах уже присутствуют
              запятые, то придется предварительно заменить их на что-либо похожее,
              например точку с запятой.</p>
            <p>Arcview требует, чтобы значения в текстовом файле
              разделялись запятой.</p>
            <p>&nbsp;</p>
            <p>&nbsp;</p>
            <p>&nbsp;</p>
            <p>Далее нужно сохранить таблицу как CSV файл (в Excel
              выбрать в качестве типа сохраняемого файла &quot;CSV comma delimited&quot;),
              закрыть таблицу и сменить расширение файла на TXT. Или сразу при
              сохранении давать название CSV файлу как &quot;filename.txt&quot;
              в кавычках, иначе расширение CSV будет автоматически добавлено. </p>
            <p align="center"><img src="/images/import-points03.gif" width="594" height="155" border="1" /></p>
            <p><img src="/images/2.gif" width="33" height="41" align="left" /><b>Импорт
              в Arcview</b></p>
            <p>&nbsp;</p>
            <p>Для открытия получившегося файла в Arcview, нужно
              при активном окне менеджера проекта сделать активным пункт Tables
              и нажать на кнопку Add. В открывшемся окне нужно сменить тип файла
              на TXT и открыть созданный вами файл. Если структура файла правильная
              он откроется как таблица.</p>
            <p><img src="/images/import-points04.gif" width="545" height="215" border="1" /></p>
            <p><img src="/images/import-points05.gif" width="564" height="208" border="1" /></p>
            <p><img src="/images/3.gif" width="33" height="41" align="left" /><b>Конвертация
              в shape-файл</b></p>
            <p>&nbsp;</p>
            <p>В активном окне Вида (View), выберите View\Add event
              theme… в появившемся окне, в таблице нужно выбрать добавленную таблицу
              (она будет называться также, как называется ее файл) и указать в
              каком поле хранятся значения широты, а в каком долготы. </p>
            <p>*Если в таблице поля широта\долгота называются стандартно<b> Lat\Long</b> или <b>Latitude\Longitude</b>, Arcview автоматически
              распознает и подставит эти значения.</p>
            <p>После нажания кнопки ОК, в вид добавится тема с вашими
              точками, после этого остается только сконвертировать ее в настоящий
              shape-файл <b>Theme\Convert to shapefile</b>.</p>
            <p align="center"><img src="/images/import-points06.gif" width="526" height="415" /></p>
            <p>*Если вы работаете с данными спроектированными не
              методами Arcview (то есть у вида не задана проекция), не стоит ожидать,
              что импортированные точки совпадут с вашими слоями. Проще всего
              решить эту проблему так:</p>
            <ol>
              <li> Создать новый Вид (<b>View</b>)</li>
              <li> Задать ему проекцию (<b>View\Properties\Projection</b>)</li>
              <li> Добавить таблицу как точечную тему (<b>View\Add
                event theme…</b>)</li>
              <li> Сконвертировать таблицу (<b>Theme\Convert to shapefile</b>)</li>
            </ol>
            <p>В этом случае таблица сохранится в нужной вам
              проекции, отличной от географической, после этого ее можно будет
              загружать в вид, где проекция не задана и если ваши данные также
              находятся в этой проекции, слои должны совпасть.</p>
            <p class="discuss">
				<span><!--#include virtual="/scripts/forum-comments-num.php?i=631"--></span>
			</p>
			<div class="links">
			   <h2>Ссылки по теме</h2>
			   <ul>
			               <li><a href="/qa/txt2points-ag.html">Импорт  табличных данных с координатной привязкой в shape-файл (ArcGIS)</a></li>
			   </ul>
			</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 20.10.2008
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=2" target="_blank">Максим Дубинин</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
