<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Конвертирование полигональных shape-файлов в покрытия Arcinfo с исправлением ошибок топологии</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Конвертирование полигональных shape-файлов в покрытия Arcinfo с исправлением ошибок топологии</h1>
<p class="ann">Конвертируем shape в покрытия Arcinfo</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=3858"--></span></p>
<p>При создании вручную shape-файлов с прилегающими друг к другу полигонами (например, ручное дешифрирование инструментами типа Stream Digitizing с применением операций Subtract и Union) часто возникают топологические ошибки - пересечение полигонов. Они могут влиять на отображение слоя (внезапная &quot;заливка&quot; всего дисплея в Arcview GIS); вызывать ошибки при экспорте слоя в векторную графику и при выводе на печать. Для исправления этих ошибок можно использовать следующие операции в ArcINFO Workstation любой версии.</p>
            <h2>1. Конвертирование без атрибутов </h2>
            <p>Конвертирование полигональных shape-файлов в покрытия Arcinfo <strong>без сохранения</strong> атрибутивной информации. В этом случае, вся атрибутивная информация, соответствующая полигонам в шейп-файле будет потеряна. Данный подход имеет смысл, если сохранение атрибутивной информации не требуется. </p>
            <p>1. Импорт shape-файла в покрытие без региональной топологии (топологические ошибки, такие как, например, пересекающиеся полигоны недопустимы) </p>
            <pre>shapearc inputshape outcover</pre>
            <p>2. Построение полигональной топологии</p>
            <pre>build outcover poly</pre>
            <p>Если появляется сообщение об ошибке, то необходимо проивести чистку топологии:</p>
            <pre>clean outcover # 0.0000000000001 0.0000000000000001 poly </pre>
            <p>Оператор # означает пропуск параметра и, в данном случае, проведение операции над самим покрытием. Если нужно сохранить outcover, а результат чистки положить в новое покрытие - можно вместо него задать [путь-имя] нового покрытия. </p>
            <pre>clean outcover outcover2 0.0000000000001 0.0000000000000001 poly </pre>
            <h2>2. Конвертирование с атрибутами </h2>
            <p>Конвертирование полигональных shape-файлов в покрытия Arcinfo <strong>с сохранением</strong> атрибутивной информации.    Данная операция применяется для т.н. &quot;чистки&quot; топологии, удаления пересекающихся частей полигонов, преобразования пустых замкнутых пространств между ними в полигоны и т.д. Идея заключается в том, чтобы использовать полигональное покрытие Arcinfo которое не допускает наличие подобного рода топологических ошибок. </p>
            <p>1. Импорт shape-файла в покрытие с региональной топологией (топологические ошибки, такие как, например, пересекающиеся полигоны допустимы). Результирующее покрытие ничем отличаться от исходного shape-файла по сути не будет.</p>
            <p>Item - название для класса регионов, условное имя, может быть любым. Это же название должно использоваться в шаге 3.  </p>
            <pre>shapearc inputshape tempcover item</pre>
            <p>2. Чистка региональной топологии, пересекающией регионы разбиваются на части, атрибутика сохраняется
              (см. примечание к операции 2 выше):</p>
            <pre>clean tempcover # 0.000000000001 0.00000000001 poly </pre>
            <p>В принципе на этом шаге можно остановиться, если вас устраивает региональная топология. Покрытие вы получили и атрибутивная информация сохранена, такое покрытие является полным эквивалентом импортированного shape-файла. Однако с покрытиями в региональной топологии невозможно выполнить некоторые операции, поэтому возможно вам также понадобится произвести следующий шаг. </p>
            <p>3. Переход от региональной к полигональной топологии<br>
            Осуществляется с помощью команды regionpoly, учитывающей пересечения. </p>
            <p>itemtab - название вспомогательной выходной таблицы INFO содержащей информацию о регионах соответствующих каждому полигону (пересекающихся).</p>
            <pre>regionpoly tempcover outcover item itemtab</pre>
            <p>Близкие аналоги этих операций имеются в ArcToolbox. </p>
            <p>4. Удаление временного покрытия </p>
            <p>Если результат вас устраивает, можно удалить временное покрытие:</p>
            <pre>kill tempcover </pre>
            <p>Дополнительную информацию о команде regionpoly можно посмотреть в справке:</p>
            <pre>help</pre>
            <p>Примечание: В процессе работы возможны сообщения об ошибках:</p>
            <ol>
              <li><em>Directory pathname too long</em> - полный путь к рабочему покрытию слишком длинный. Общий путь не должен превышать 79 символов. Решение - перенесите покрытие временно в папку, путь к которой покороче.</li>
              <li><em>AML ERROR   - Invalid expression on &amp;IF directive\\              line 202 of file с:\gis\arcgis\arcexe9x\atool\arc\regionpoly.aml</em> - забыли указать имя таблицы для сохранения непланарных полигонов (itemtab). Укажите и перезапустите regionpoly. </li>
            </ol>
<p class="discuss"><span><!--#include virtual="/scripts/forum-comments-num.php?i=3858"--></span></p>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 24.09.2009
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=2" target="_blank">Максим Дубинин</a></span></p>
<!--#include virtual="/inc/footer2.php" -->