<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Классификация данных ДЗЗ используя метод опорных векторов и imageSVM</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Классификация данных ДЗЗ используя метод опорных векторов и imageSVM</h1>
<p class="ann">Руководство к действию для классификации данных методом опорных векторов</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=6085"--></span></p>

<p><a href="http://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%BE%D0%BF%D0%BE%D1%80%D0%BD%D1%8B%D1%85_%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%BE%D0%B2" target="_blank" class="external">Метод опорных векторов</a> (Support Vector Machines) - один из способов решения задачи классификации из группы методов машинного обучения (Machine Learning). </p>
<p>Это статья не ставит целью объяснение того как работает SVM, но пошагово демонстрирует процесс классификации с программным обеспечением imageSVM, использующим IDL и работающим в ENVI.</p>
<p>Для начала работы, необходимо иметь 1 или несколько снимков, например Landsat. Пример рассмотренный здесь связан с дешифрированием классов изменений, поэтому используется два изображения за разные года.</p>
<p>ImageSVM можно загрузить, предварительно зарегистрировавшись на сайте Университета Гумбольдта, он может работать под IDL ENVI и в <a href="http://www.ittvis.com/ProductServices/IDL/VirtualMachine.aspx" target="_blank" class="external">виртуальной машине IDL</a>, без ENVI. <a href="http://www2.hu-berlin.de/hurs/projects/downloadImageSVM.php" target="_blank" class="external">Получить</a> ImageSVM. </p>
<h2>Установка и запуск imageSVM</h2>
<p><img src="/images/imagesvm-05.gif" width="408" height="47"></p>
<h2>Сбор тренировочных данных </h2>
<p>Перед началом работы необходимо собрать некоторое количество тренировочных данных в точечной форме, где каждой точке соответствует выходной класс. Значение класса должно храниться в одном из атрибутивных полей, например ID. Рекомендованное количество точек - 100 на класс. Рекомендуется производить сбор тренировочных данных в порядке увеличения класса 1, 2, 3 и т.д., это облегчит управление данными и экспорт результирующей классификации в формат GeoTIFF. </p>
<p>Система координат точечного слоя должна совпадать с СК классиицируемых данных ДЗЗ.</p>
<p>Точечный слой должен иметь корректный PRJ файл.</p>
<h2><strong>Подготовка данных ДЗЗ</strong></h2>
<p>  В качестве исходных данных используются изображения в формате GeoTIFF. В случае дешифрирования классов изменений, как правило необходимо собрать данные ДЗЗ в единое композитное изображение, где первая группа слоёв соответствует снимкам &quot;до&quot;, а вторая &quot;после&quot;. </p>
<p>Это можно сделать в QGIS, ERDAS IMAGINE, ENVI (<a href="/qa/layerstack.html">подробнее</a>). </p>
<p>Если мультиканальное изображение сделано не в ENVI, то далее необходимо:</p>
<p> 
  Открыть мультиканальный снимок в ENVI: 
  File\Open Image File</p>
<p>Сохранить файл как standard ENVI raster: 
  File\Save File As\ENVI Standard</p>
<p>Закрыть изначально открытый снимок и переоткрыть его из файла ENVI Standard.</p>
<h2>Предобработка данных ДЗЗ</h2>
<p> Для работы со снимком в imageSVM необходимо сначала масштабировать растр.</p>
<p>  imageSVM\Pre-Processing\Scale image</p>
<p>Необходимо выбрать:  Individual Bands и Set extreme Values to 0/1, а также указать имя выходного файла. После этого необходимо нажать Accept. </p>
<p align="center"><img src="/images/imagesvm-01.gif" width="354" height="538"></p>
<h2>Подготовка тренировочных данных</h2>
<p>  Откроем точечный слой в формате shape: 
  File\Open Vector File</p>
<p>В диалоге открытия, убедимся в правильности имени и пути выходного файла EVF (они назначаются автоматически) и убедимся что правильно распозналась проекция слоя. Нажмем OK. </p>
<p align="center"><img src="/images/imagesvm-10.gif" width="282" height="633"></p>
<p>Экспортируем слой в ROI</p>
<p>Для этого выберем его в появившемся списке слоев:</p>
<p align="center"><img src="/images/imagesvm-02.gif" width="302" height="403"></p>
<p>Выберем: Choose File\Export layers to ROI</p>
<p>Сконвертируем все записи слоя EVF в новый ROI используя поле ID в качестве источника значений:</p>
<p align="center"> <img src="/images/imagesvm-03.gif" width="301" height="180"></p>
<p>Откроем масштабированное изображение в просмотровщике данных. Для этого вызовем список растровых слоёв: 
  Window\Available Bands List</p>
<p>  Откроем в просмотровщике снимок, не важно в какой комбинации: Load RGB</p>
<p align="center"><img src="/images/imagesvm-06.gif" width="475" height="696"></p>
<p>Чтобы вызвать редактор ROI щелкнем правой кнопкой на изображении и выберем ROI Tool, появится окно с таблицей где каждой точке ROI соответствует запись:</p>
<p align="center"><img src="/images/imagesvm-07.gif" width="632" height="637"></p>
<p>  ROI Tool используется, чтобы объединить все точечные значения в единые тренировочные классы и назначить им цвета. Объединение производится следующим образом: </p>
<p>1. В меню: Options\Merge Regions<br>
  2. В новом окне, выбираем первую запись для первого класса как Base ROI (левая часть окна). Иногда, список пролистан в конец, в этом случае необходимо переместиться в самое начало.<br>
  3. В правой части окна, нужно выбрать все ROI имеющие тот же класс (например ID=1), для выбора можно использвоать SHIFT. Таким образом, слева выбираем первую запись класса, справа - все записи этого класса. Переключатель Delete Merged ROIs должен быть установлен в Yes. <br>
  5. OK</p>
<p align="center"><img src="/images/imagesvm-08.gif" width="476" height="391"></p>
<p>В результате все ROI будут объединены по ID этого класса. </p>
<p align="center"><img src="/images/imagesvm-09.gif" width="593" height="436"></p>
<p> Эту операцию нужно повторить для других классов. Не забудьте каждый раз изменять базовый ROI. После того как все классы объединены, щелкните правой кнопкой на каждый класс и выберите подходящий цвет, который будет обозначать этот класс на результирующей классификации. </p>
<p align="center"><img src="/images/imagesvm-11.gif" width="673" height="455"></p>
<p> Далее нужно растеризовать тренировочные данные: 
  Options\Create Class Image from ROIs. Для этого, выберите все классы и нажмите OK, будет создано новое изображение и файл hdr. </p>
<p align="center"><img src="/images/imagesvm-12.gif" width="270" height="359"></p>
<p>Можно также сохранить созданные классы и в векторной форме. Для этого в ROI Tool выберите: File\Save ROIs, выберите все классы и имя файла и нажмите OK. </p>
<p align="center"><img src="/images/imagesvm-13.gif" width="270" height="391"></p>
<p>Векторный слой будет иметь расширение *.roi. После этого ROI Tool можно закрыть.</p>
<h2>Параметризация</h2>
<p>Для обучения классификатора с помощью тренировочных данных выберите:   imageSVM\Classification\Parameterize SV Classifier (SVC)</p>
<p>Выберите масштабированное изображение и созданную растровую тренировочную матрицу и нажмите Accept:</p>
<p align="center"><img src="/images/imagesvm-14.gif" width="558" height="180"></p>
<p>  Далее нужно выбрать имя файл в который будет сохранена обученная модель:</p>
<p align="center"><img src="/images/imagesvm-15.gif" width="470" height="144"></p>
<p>  Нажмите OK и дождитесь окончания процесса. Он может занять несколько минут в зависимости от количества тренировочных данных. Например: для 1200 тренировочных точек на Pentium 4 параметризация занимает 2.5 минуты. </p>
<h2>Классификация</h2>
<p>Полученную модель можно использовать для классификации изображения: <br>
  imageSVM\Classification\Classify Image</p>
<p>Выберите файл SVC созданный при параметризации на предыдущем шаге и масштабированное изображение и нажмите Accept:</p>
<p align="center"><img src="/images/imagesvm-16.gif" width="457" height="210"></p>
<p> В следующем окне выберите имя для результирующей классификации и выключите режим Output Class Probabilities для более быстрого обсчета. Нажмите 
  Accept.</p>
<p align="center"><img src="/images/imagesvm-17.gif" width="466" height="168"></p>
<p>Классификация может занять значительное время, для сцены Landsat с 12 каналами (6 каналов за период) и 1200 тренировочных точек время классификации составляет примерно 2 часа. </p>
<!-- обсуждение на форуме, цифра изменяется при публикации статьи -->   
<p class="discuss"><span><!--#include virtual="/scripts/forum-comments-num.php?i=6085"--></span></p>
<!-- ссылки -->
<div class="links">
	<h2>Ссылки по теме</h2>
		<ul>
			<li><a href="/qa/classify-trees-r.html">Классификация растровых данных с помощью деревьев решений в R</a></li>
			</ul>
</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 04.08.2010
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=2" target="_blank">Максим Дубинин</a></span></p>
<!--#include virtual="/inc/footer2.php" -->