<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Импорт данных SRTM с помощью Arcview Spatial Analyst</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Импорт данных SRTM с помощью Arcview Spatial Analyst</h1>
            <p class="ann">В данной статье описывается
                    импорт данных SRTM с помощью пакета Arcview 3.x и модуля Spatial
                    Analyst</p>
            <p>Подробнее о миссии
              SRTM и данных, а так же о импорте с помощью Arcinfo Workstation <a href="/qa/srtm.html">читайте здесь</a>. Там же находится программа
              генерации sml-файлов сильно облегчающий обработку большого количества
              данных SRTM с помощью Arcinfo Workstation.</p>
            <p>Эта статья  нужна вам только если вы работаете с данными SRTM представленными фрагментами 1x1 градус в формате HGT. Если вы работаете с мозаиками 5x5 градусов - они уже готовы к работе. </p>
            <h2>1. Подготовка
              данных для импорта в формат GRID</h2>
            <p>Название каждой матрицы рельефа соответствует координатам ее <b>левого нижнего</b> угла. </p>
            <p>Например:<br />
              <b>n45e136</b> /45 гр. с.ш., 136 гр.в.д</p>
            <p>Для начала работы необходимо:
            <p>а) Определить, какие именно матрицы вам нужны, это
              можно сделать наложив обычную сетку через 1 градус и определив
              название матрицы (см. выше). Легко найти нужный лист можно использовав <a href="/other/grid1dg.zip">покрытие grid1dg</a>, которое представляет
              собой готовую сетку через 1 градус, в атрибутивной таблице которой,
              в поле <b>Tilename</b> каждой градусной ячейке приписано имя соответствующей
              матрицы
            <p>б) Разархивировать нужный файл и изменить его расширение
              с HGT на BIL</p>
            <p>в) Создать новый текстовый файл, с именем таким же
            как имя файла BIL, и с расширением HDR (файл заголовка). Например: <b>n45e136.bil</b> и <b>n45e136.hdr. </b>Содержание файла HDR постоянно для любой матрицы рельефа. </p>
            <p>Примечание 1: если файл hdr редактируется в notepad, необходимо иметь в виду, что по-умолчанию ему будет присвоено расширение txt, для того чтобы этого избежать, необходимо   при сохранении файла задать ему имя таким образом: &quot;<b>n45e136.hdr</b>&quot; и &quot;<b>n45e136.blw</b>&quot; (включая кавычки). Если этого не сделать, notepad присвоит файлам имена: <b>n45e136.hdr.txt</b> и <b>n45e136.blw.txt</b> соответственно и попытке загрузить bil в Arcview будет выдаваться сообщение об ошибке: Unable to read standard header.</p>
            <p>Примечание 2: если файл hdr редактируется в notepad, необходимо при сохранении убедиться, что Encoding (кодировка) установлена в значение ANSI, при установке Unicode, bil файл будет загружен в Arcview, но просмотреть его будет нельзя. При попытке сохранить данные как GRID будет выдаваться ошибка: NXXeXXX.bil could not be converted to a grid....  </p>
            <p>Содержание текстового файла <b>HDR</b> должно быть следующим:<br />
            </p>
            <tcode>BYTEORDER M<br />
                    LAYOUT BIL<br />
                    NROWS 1201<br />
                    NCOLS 1201<br />
                    NBANDS 1<br />
                    NBITS 16<br />
                    BANDROWBYTES 2402<br />
                    TOTALROWBYTES 2402<br />
                    BANDGAPBYTES 0</tcode>
            <p>г) Создать новый текстовый файл, с именем таким же
              как имя файла BIL, и с расширением BLW (файл привязки). Например: <b>n45e136.bil</b> и <b>n45e136.blw. </b>Содержание текстового
              файла <b>BLW</b> должно быть следующим:</p>
            <li><tcode>0.000833333333333<br />
                      0<br />
                      0<br />
                      -0.000833333333333<br />
                      136<br />
                      46</tcode>
            </li>
            <p>Приведенные выше строки можно просто скопировать
                и вставить в созданный <b>BLW</b> файл, изменить значение нужно
                в двух последних строках (координаты X и Y вернего левого угла).
                Как упоминалось выше, эти данные можно взять из названия, однако
                следует помнить, что название файла является координатами левого
                нижнего угла, а записывать нужно координаты левого верхнего.
                Таким образом, параметр <b>ULYMAP</b> будет отличаться от цифры
                в названии файла на единицу в сторону увеличения (см. название
                файла и содержание <b>HDR</b> файла, параметр <b>ULYMAP</b>).</p>
            <p>Согласно документации:</p>
            <tcode>For example, the coordinates of the lower-left corner of tile N40W118 are 40 degrees north latitude and 118 degrees west longitude. To be more exact, these coordinates refer to the <strong>geometric center of the lower left pixel</strong></tcode>
            <p>Так как в Arcview координаты пиксела определяются также вычисляются не по его верхнему левому углу, а по центральной точке, то изменять координаты путем прибавления\вычитания половины пиксела - <strong>не нужно</strong>. <br />
              Размер одного пиксела составляет
            0.000833333333333 градусов по ширине и высоте.</p>
            <p>Таким образом каждая матрица рельефа будет представлена
              тремя файлами с одинаковыми названиями, но разным разрешением.<br />
            </p>
            <h2>2. Импорт
              и обработка данных</h2>
            <p>Перед конвертацией данных, нужно включить расширение
              Spatial Analyst и загрузить получившийся <b>BIL</b> файл в Arcview
            (View/Add Theme, SourceTypes - &gt;&gt; Image Data Source). </p>
            <p align="center"><img src="/images/srtm-sa1.gif" width="375" height="249" /> </p>
            <p>1. Конвертация в формат GRID. </p>
            <p>Активировать загруженную матрицу и выбрать <b>Theme\Convert
              to Grid</b> из меню Вида. Далее нужно выбрать имя под которым будет
              сохранена матрица рельефа в формате GRID. По умолчанию Spatial Analyst
              предлагает сохранить новый GRID под именем Nwgrd1.</p>
            <p align="center"><img src="/images/srtm-sa0.gif" width="425" height="252" border="1" /><br />
            </p>
            <p>2. Восстановление отрицательных значений. Осуществляется
              с помощью пункта меню <b>Analysis\Map Calculator</b> модуля Spatial
              Analyst. Допустим название конвертированной в GRID матрицы <b>Nwgrd1</b>,
              тогда выражение, необходимое, чтобы восстановить нормальные значения
              будет иметь вид:<br />
            </p>
            <tcode><b>([Nwgrd1] &gt;= 32768).con([Nwgrd1] - 65536,
                    [Nwgrd1])</b></tcode>
            <p align="center"><img src="/images/srtm-sa2.jpg" width="529" height="260" border="1" /></p>
            <p>После ввода выражения нужно нажать кнопку Evaluate,
              входной GRID будет пересчитан, в содержание Вида будет добавлен
              новый, по умолчанию его название будет <b>Map Calculation 1</b>.</p>
            <p>3. Установка значения NODATA. Осуществляется с помощью
              команды SETNULL, так же в окне <b>Map Calculator</b>.<br />
            </p>
            <tcode><b>([Map Calculation 1] &lt;= -32768).setnull
                    ([Map Calculation 1])</b></tcode>
            <p align="center"><img src="/images/srtm-sa3.jpg" width="521" height="352" border="1" /></p>
            <p>Результатом операции будет новый <b>GRID</b> с правильными значениями высот и именем <b>Map Calculation 2</b></p>
            <p>4. Мозаицирование.</p>
            <p>Если у вас несколько матриц, которые необходимо склеить в единое поле, то сделать это можно с помощью того же инструмента <b>Map Calculator</b> (Analysis\Map Calculator). </p>
            <p>В поле вводу необходимо ввести выражение, которое склеит все перечисленные матрицы рельефа, таким образом:</p>
            <tcode><b>[grid1].mosaic({[grid2],[grid3]})</b></tcode>
            <p>В этом выражении, на первом месте (grid1) должно стоять одной из матриц, далее в круглых, а затем фигурных скобках должны быть перечислены названия всех остальных матриц, причем каждое из названий матриц (как первого, так и остальных) должно быть заключено в квадратные скобки. </p>
            <p align="center"><img src="/images/srtm-sa4.gif" alt="мозаицирование" width="543" height="338" border="1" />  </p>
            <p>5. Сохранение результата. Получившуюся
              матрицу рельефа можно сохранить под нормальным, нужным вам названием
              с помощью <b>Theme\Save Data Set...</b></p>
            <p>Если количества матриц рельефа достаточно
              велико и есть доступ к Arcinfo Workstation, то лучше воспользоваться
              генератором sml-файлов, который создаст специальный командный файл,
              выполнив который в Arcinfo, вы получите сразу импортированную, подготовленную
              и склеенную в единое покрытие матрицу рельефа. <a href="/qa/srtm.html">Подробнее
              здесь</a>.<br />
            </p>
			<p class="discuss">
				<span><!--#include virtual="/scripts/forum-comments-num.php?i=2090"--></span>
			</p>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 23.01.2004
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=2" target="_blank">Максим Дубинин</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
