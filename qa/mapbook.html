<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Экспорт макета карты с разрезкой на листы заданного масштаба\размера</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Экспорт макета карты с разрезкой на листы заданного масштаба\размера</h1>
<p class="ann">Решение задачи с помощью ArcGIS. </p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=207"--></span></p>

            <p><strong>Задача:</strong> Для некоторой карты любого размера и масштаба, разрезать на листы и экспортировать\напечатать ее с заданным масштабом и печатным размером.</p>
            <p><strong>Решение:</strong> Использование расширения Mapbook для ArcGIS. </p>
            <p>Mapbook – очень удобное расширение позволяющее в автоматическом режиме нарезать карту на листы и экспортировать в нужном формате. Расширение создано ESRI и распространяется бесплатно. </p>
            <p><img src="/images/1.gif" align="left" /><strong>Загрузка и установка расширения</strong></p>
            <p> Расширение доступно в двух вариантах (исходный и модифицированный) для двух версий ArcGIS. Исходная версия - доступна также для загрузки с сайта ESRI. Модифицированная версия (отредактирована GIS-Lab) позволяющая экспортировать результаты работы расширения в формат EPS и исправляющая некоторые ошибки (ArcGIS 8), добавлен экспорт в AI (ArcGIS 9).</p>
            <table width="60%"  border="0" align="center">
              <tr>
                <th><p><strong>Исходная версия </strong></p></th>
                <th><p><strong>Модицифицированная версия </strong></p></th>
              </tr>
              <tr>
                <td><p align="center"><a href="/programs/vb/mapbook-v1-8.zip">ArcGIS 8.x</a></p></td>
                <td><p align="center"><a href="/programs/vb/mapbook-v2-8.zip">ArcGIS 8.x</a></p></td>
              </tr>
              <tr>
                <td><p align="center"><a href="/programs/vb/mapbook-v1-9.zip">ArcGIS 9.x</a></p></td>
                <td><p align="center"><a href="/programs/vb/mapbook-v2-9.zip">ArcGIS 9.x</a></p></td>
              </tr>
            </table>
            <p>Для начала работы с расширением необходимо его загрузить и инсталлировать, запустив файл _INSTALL.bat.</p>
            <p>После запуска ArcGIS, в меню <strong>Tools\Customize</strong> появится новая панель инструментов – <strong>Map Series</strong> <img src="/images/mapbook-00.jpg" width="113" height="53" align="left" />. Ее необходимо включить, чтобы она появилась в рабочем окне ArcGIS. Одновременно появляется и третья закладка внизу панели ТОС – Map Book.</p>
            <p align="center"><img src="../images/mapbook-01.jpg" width="455" height="255" /></p>
            <p><img src="/images/2.gif" align="left" /><strong>Работа с расширением</strong></p>
            <p> К резке на листы целесообразно приступать, когда карта полностью сформатирована и готова к выводу на печать. Принцип работы расширения очень прост, оно позволяет виртуально разделить макет карты на некоторое количество макетов меньшего размера, сама карта и основной макет остаются без изменений.</p>
            <p>Для работы расширения необходимо, чтобы в виде присутствовала хотя бы одна тема. Вид при этом может быть как спроектированным, так и неспроектированным. Далее нужно создать сетку (grid), по которой будет осуществляться «нарезка» или выбрать существующую сетку, созданную ранее. Для этого нужно нажать третью слева кнопку на появившейся панели – Create/ Update Map Grids <img src="/images/mapbook-13.jpg" width="18" height="18" />. Появится следующее диалоговое окно: </p>
            <p align="center"><img src="/images/mapbook-03.jpg" width="329" height="371" /></p>
            <p>При этом можно использовать опции:</p>
            <ul>
              <li> <strong>clear existing grids</strong> – удалять существующие ячейки, если вы выбрали вариант с существующей сеткой, то можно создать в этой теме ячейки заново, удалив существующие полигоны;</li>
              <li> <strong>don’ t create empty grids</strong> – не создавать пустые ячейки, в этом случае нужно выбрать тему и проверять наличие объектов из нее в создаваемой ячейке, если объектов в ячейке нет, то ее не создавать.</li>
            </ul>
            <p>Однако наиболее простой способ – создать новый слой, который и будет определять разрезку карты на листы. Для этого выбирается опция Create a new layer и в прилегающей строке выбирается или вводится вручную расположение и название файла-сетки. После этого станет активной кнопка Next. При переходе по ней появится следующее диалоговое окно:</p>
            <p align="center"><img src="/images/mapbook-04.jpg" width="329" height="371" /></p>
            <p>В этом окне необходимо ввести желаемый масштаб выходной карты (или оставить установленный в Data Frame) и выбрать координаты левого верхнего и правого нижнего углов карты. Если все слои обрезаны как надо и должны войти в карту, то можно нажать All Layers – границы будут установлены по крайним границам всех тем карты. Если общий экстент карты выведен в View, нужно использовать кнопку Current Extent. Если же границы общей карты достаточно условны, их просто можно «считать» из вида выведя курсор в левый верхний и правый нижний угол карты и ввести вручную (в единицах карты). В любом случае получившуюся сетку можно будет в дальнейшем отредактировать убрав ненужные листы. После перехода по Next появится следующее диалоговое окно:</p>
            <p align="center"><img src="/images/mapbook-05.jpg" width="329" height="371" /></p>
            <p>Здесь необходимо либо согласиться с первой опцией (размер одного листа карты будет соответствовать имеющему место в компоновке), либо ввести вручную ширину и высоту листа в сантиметрах (соответствующие А0-А4 или любого другого). После перехода по Next появится следующее диалоговое окно:</p>
            <p align="center"><img src="/images/mapbook-06.jpg" width="329" height="371" /></p>
            <p>Здесь предлагаются различные варианты нумерации листов выходной карты – буквенные и числовые. Они будут сохранены в атрибутивной таблице темы-шаблона, режущей карту на листы. Нужно выбрать необходимый вариант и нажать « Finish», после чего начнется расчет сетки. Сетка сразу будет добавлена в ТОС на верхний уровень, со сплошной заливкой, которую рекомендуется поменять на прозрачную чтобы можно было посмотреть макет резки относительно карты. На приведенном рисунке полученная сетка показана ярко-фиолетовыми прямоугольниками – это границы листов выходной карты. </p>
            <p align="center"><img src="/images/mapbook-07.jpg" width="501" height="368" border="1" /></p>
            <p>После этого необходимо перейти на вкладку MapBook в ТОС. Пока там только одна «строка» - MapBook.</p>
            <p align="center"> <img src="/images/mapbook-08.jpg" width="197" height="127" /></p>
            <p>Щелкнув по ней правой кнопкой мыши, выбираем <strong>Add Map Series…</strong>, в появившемся диалоге нужно выбрать тему – шаблон резки. </p>
            <p align="center"><img src="/images/mapbook-08a.jpg" width="467" height="299" /> <img src="/images/mapbook-09.jpg" width="467" height="299" /></p>
            <p>Во втором диалоговом окне можно выбрать, будут ли выведены все темы Вида, только видимые или темы, включаемые в выходные листы, будут выбраны особо. В третьем диалоговом окне имеется ряд дополнительных опций, в нашем случае необходимо было получение несколько листов одинакового масштаба. </p>
            <p align="center"><img src="/images/mapbook-11.jpg" width="467" height="299" /></p>
            <p align="center"><img src="/images/mapbook-12.jpg" width="197" height="92" /></p>
            <p>После этого в разделе MapBook появляется серия карт, которые можно по одной выводить на печать или экспортировать в графические форматы нажатием правой кнопкой мыши на соответствующем листе. Двойными щелчками левой кнопкой мыши по листам карты в Map Series можно просматривать как будут выглядеть определенные листы на выходе.</p>
            <p>Далее, щелкнув правой кнопкой мыши
              на конкретном листе или всей серии, можно экспортировать все листы в нужный формат или распечатать их. Используя модифицированную версию расширения можно экспортировать листы в формат EPS.</p>
            <p class="discuss">
				<span><!--#include virtual="/scripts/forum-comments-num.php?i=207"--></span>
			</p>
			<div class="links">
			<h2>Ссылки по теме</h2>
			<ul>
               <li><a href="http://gis-lab.info/programs/avenue/auto_til.zip">Экспорт макета карты с разрезкой на листы в Arcview 3.x</a></li>
			</ul>
			</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 07.12.2004
<br>Автор: <a href="/forum/memberlist.php?mode=viewprofile&u=3" target="_blank">Игорь Поспелов (taimyr)</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
