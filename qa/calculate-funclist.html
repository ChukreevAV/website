<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Список функций доступных через калькулятор значений (Calculate)</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Список функций доступных через калькулятор значений (Calculate)</h1>
<p class="ann">Перечень основных функций с описанием и примерами</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=722"--></span></p>
<p>В списке содержащемся в окне инструмента Калькулятор значений (Calculate) входят не все функции, существует также некоторое количество других, в этот список не входящих. Этот список приводит перечень функций, которые можно использовать с помощью Калькулятора значений, как содержащихся в его окне, так и дополнительных (например Replace). </p>
            <p>Функции разбиты на следующие блоки:</p>
            <ul>
              <li> <a href="#num">Операции с числовыми значениями</a></li>
              <li><a href="#str"> Операции со строковыми значениями</a></li>
              <li><a href="#date">Операции со значениями даты и времени</a></li>
              <li><a href="#color">Таблица цветов</a></li>
              <li><a href="#param">Константы конвертирования</a> </li>
            </ul>
            <p>У многих из приводимых функций есть ряд настраиваемых параметров. </p>
            <p>Более подробную информацию и примеры можно получить в справочной системе <strong> Visual Basic for Applications</strong>, который присутствует в системе, если у вас установлен ArcGIS. Для получения подробной справки по каждой функции в ArcGIS yажмите <strong> Alt+F11 </strong>или выберите <strong>Tools\Macros\Visual Basic Editor</strong>. Откроется окно редактора<strong> VBA</strong>. Нажмите <strong> F1 </strong>и в появившейся справочной системе перейдите на закладку <strong> Index </strong>в поле ввода введие имя интересующей функции. Например,<strong> Abs Function. </strong></p>
            <p><strong><strong><a name="num" id="num"></a></strong>Операции с числовыми значениями </strong></p>
            <table width="95%" align="center" cellpadding="0" cellspacing="0">
              <tr bgcolor="#CCCCCC">
                <td width="30%" valign="middle"><p align="center"><strong> Функция</strong></p></td>
                <td width="40%"><p align="center"><strong>Действие</strong></p></td>
                <td width="30%"><p align="center"><strong> Пример</strong></p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Abs()</strong></p></td>
                <td width="40%"><p>Возвращает абсолютное значение</p></td>
                <td width="30%"><p align="center"> abs(-3.14) = 3.14</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Atn() </strong></p></td>
                <td width="40%"><p>Возвращает арктангенс</p></td>
                <td width="30%"><p align="center"> 4 * Atn(1) = Pi </p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Cos() </strong></p></td>
                <td width="40%"><p>Возвращает косинус</p></td>
                <td width="30%"><p align="center"> cos(0.27)</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Exp() </strong></p></td>
                <td width="40%"><p>Возвращает экспоненту</p></td>
                <td width="30%"><p align="center">exp(0.27)</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Fix() </strong></p></td>
                <td width="40%"><p>Возвращает целое число, округленное в меньшую сторону</p></td>
                <td width="30%"><p align="center"> fix(-2.5) = -2</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Int() </strong></p></td>
                <td width="40%"><p>Возвращает целое число, округленное в большую сторону</p></td>
                <td width="30%"><p align="center"> int(-2.5) = -3</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Log() </strong></p></td>
                <td width="40%"><p>Возвращает логарифм</p></td>
                <td width="30%"><p align="center"> log(0.27)</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong>Sin()</strong></p></td>
                <td width="40%"><p>Возвращает синус</p></td>
                <td width="30%"><p align="center">sin(0.27)</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong>Sqr()</strong></p></td>
                <td width="40%"><p>Возвращает квадратный корень</p></td>
                <td width="30%"><p align="center">sqr(0.27)</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong>Tan()</strong></p></td>
                <td width="40%"><p>Возвращает тангенс</p></td>
                <td width="30%"><p align="center">tan(0.27)</p></td>
              </tr>
            </table>
            <p><strong><a name="str" id="str"></a>Операции с строковыми значениями</strong></p>
            <table width="95%" align="center" cellpadding="0" cellspacing="0">
              <tr bgcolor="#CCCCCC">
                <td width="30%" valign="middle"><p align="center"><strong> Функция</strong></p></td>
                <td width="40%"><p align="center"><strong>Действие</strong></p></td>
                <td width="30%"><p align="center"><strong> Пример</strong></p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Asc() </strong></p></td>
                <td width="40%"><p>Возвращает ANSI код символа</p></td>
                <td width="30%"><p align="center"> asc(&quot;s&quot;) = 115</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Chr() </strong></p></td>
                <td width="40%"><p>Возвращает символ соответствующий коду</p></td>
                <td width="30%"><p align="center"> chr(115) = &quot;s&quot;</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Format() </strong></p></td>
                <td width="40%"><p>Возвращает значение  в соответствии с инструкциями содержащимися в выражении, приведенное к некоторому формату</p></td>
                <td width="30%" valign="top"><p>MyTime = #17:04:23# <br />
                    Format(MyTime, &quot;h:m:s&quot;) = &quot;17:4:23&quot;</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> IntStr() </strong></p></td>
                <td width="40%"><p>Возвращает номер символа в строке с которого начинается исходная подстрока</p></td>
                <td width="30%"><p align="center"> InStr(1,&quot;test&quot;,&quot;e&quot;) = 2 </p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Lcase() </strong></p></td>
                <td width="40%"><p>Преобразует символы строки в строчные</p></td>
                <td width="30%"><p align="center">Lcase(&quot;ПРивЕТ&quot;) = &quot;привет&quot;</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Left() </strong></p></td>
                <td width="40%"><p>Возвращает часть строки слева длинной N символов </p></td>
                <td width="30%"><p align="center">Left(&quot;Привет&quot;,3) = &quot;При&quot;</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Len() </strong></p></td>
                <td width="40%"><p>Возвращает длину строки </p></td>
                <td width="30%"><p align="center">Len(&quot;Привет&quot;) = 6 </p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Ltrim() </strong></p></td>
                <td width="40%"><p>Удаляет  пробелы в начале строки </p></td>
                <td width="30%"><p align="center">Ltrim(&quot; Привет&quot;) = &quot;Привет&quot;</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Mid() </strong></p></td>
                <td width="40%"><p> Возвращает часть строки начиная с позиции &quot;начало&quot; и длиной N символов</p></td>
                <td width="30%"><p align="center">Mid(&quot;Привет&quot;,3,2) = &quot;ве&quot;</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> QBColor() </strong></p></td>
                <td width="40%"><p>Возвращает представление кода RGB цвета с помощью <a href="#color">кодовой таблицы цветов</a><strong>&nbsp;</strong></p></td>
                <td width="30%"><p align="center">MyForm.BackColor = QBColor(ColorCode)</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Right() </strong></p></td>
                <td width="40%"><p> Возвращает  часть строки справа длинной N символов</p></td>
                <td width="30%"><p align="center">Right(&quot;Привет&quot;,3) = &quot;вет&quot;</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Rtrim() </strong></p></td>
                <td width="40%"><p> Удаляет  пробелы в конце строки </p></td>
                <td width="30%"><p align="center">Rtrim(&quot;Привет &quot;) = &quot;Привет&quot;</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Space() </strong></p></td>
                <td width="40%"><p>Строка из (число) пробелов</p></td>
                <td width="30%"><p align="center">Space(5) = &quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; </p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> StrConv() </strong></p></td>
                <td width="40%"><p>Конвертирует строку в соответствии с <a href="#param">задаными параметрами<strong>&nbsp;</strong></a></p></td>
                <td width="30%"><p align="center">StrConv(&quot;ABCDEFG&quot;, vbFromUnicode)</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> String() </strong></p></td>
                <td width="40%"><p> Возвращает  строку из N повторяющихся символов</p></td>
                <td width="30%"><p align="center">String(5,&quot;A&quot;) = &quot;AAAAA&quot;</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Trim() </strong></p></td>
                <td width="40%"><p>Удаляет начальные и конечные пробелы</p></td>
                <td width="30%"><p align="center">Trim(&quot; Привет &quot;) = &quot;Привет&quot;</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle"><p align="center"><strong> Ucase()</strong></p></td>
                <td width="40%"><p> Преобразует символы строки в заглавные буквы</p></td>
                <td width="30%"><p align="center">Ucase(&quot;ПРивЕТ &quot;) = &quot;ПРИВЕТ&quot;</p></td>
              </tr>
              <tr>
                <td width="30%" valign="middle">&nbsp;</td>
                <td width="40%"><p>Заменяет подстроку в строке на другую строку</p></td>
                <td width="30%"><p>Replace(&quot;ABC&quot;, &quot;BC&quot;, &quot;DC&quot;) = &quot;ADC&quot; </p></td>
              </tr>
            </table>
            <p><strong><a name="date" id="date"></a>Операции со  значениями даты и времени </strong></p>
            <table width="95%" align="center" cellpadding="0" cellspacing="0">
              <tr bgcolor="#CCCCCC">
                <td width="30%" valign="middle"><p align="center"><strong> Функция</strong></p></td>
                <td width="40%"><p align="center"><strong>Действие</strong></p></td>
                <td width="30%"><p align="center"><strong> Пример</strong></p></td>
              </tr>
              <tr>
                <td width="30%"><p align="center"><strong> Date() </strong></p></td>
                <td width="40%"><p>Возвращает текущую дату </p></td>
                <td width="30%"><p>Date() = текущая дата </p></td>
              </tr>
              <tr>
                <td width="30%"><p align="center"><strong> DateAdd() </strong></p></td>
                <td width="40%"><p> Возвращает  дату через определенный интервал времени относительно начального</p></td>
                <td width="30%"><p> DateAdd(&quot;m&quot;, 5, &quot;12.10.1985&quot;) = &quot;12.03.1986&quot; </p></td>
              </tr>
              <tr>
                <td width="30%"><p align="center"><strong> DateDiff() </strong></p></td>
                <td width="40%"><p>Возвращает разницу между двумя датами.</p></td>
                <td width="30%"><p>DateDiff(&quot;d&quot;, Now, &quot;12.10.1985&quot;) = -7358 </p></td>
              </tr>
              <tr>
                <td width="30%"><p align="center"><strong> DatePart() </strong></p></td>
                <td width="40%"><p>Возвращает часть даты\времени</p></td>
                <td width="30%"><p>DatePart(&quot;yyyy&quot;, &quot;12.10.1985&quot;) = 1985 </p></td>
              </tr>
              <tr>
                <td width="30%"><p align="center"><strong> Now()</strong></p></td>
                <td width="40%"><p>Возвращает текущую системную дату и время</p></td>
                <td width="30%"><p>Now() = текущая системная дата и время</p></td>
              </tr>
            </table>
            <p><strong><strong><a name="color" id="color"></a></strong>Таблица цветов</strong></p>
            <table align="center" cellpadding="0" cellspacing="4">
              <tr bgcolor="#CCCCCC">
                <td width="13%"><p align="center"><strong> Number </strong></p></td>
                <td width="27%"><p align="center"><strong> Color </strong></p></td>
                <td width="15%"><p align="center"><strong> Number </strong></p></td>
                <td width="39%"><p align="center"><strong> Color </strong></p></td>
              </tr>
              <tr>
                <td width="13%"><p align="center"> 0 </p></td>
                <td width="27%"><p align="center"> Black </p></td>
                <td width="15%"><p align="center"> 8 </p></td>
                <td width="39%"><p align="center"> Gray </p></td>
              </tr>
              <tr>
                <td width="13%"><p align="center"> 1 </p></td>
                <td width="27%"><p align="center"> Blue </p></td>
                <td width="15%"><p align="center"> 9 </p></td>
                <td width="39%"><p align="center"> Light Blue </p></td>
              </tr>
              <tr>
                <td width="13%"><p align="center"> 2 </p></td>
                <td width="27%"><p align="center"> Green </p></td>
                <td width="15%"><p align="center"> 10 </p></td>
                <td width="39%"><p align="center"> Light Green </p></td>
              </tr>
              <tr>
                <td width="13%"><p align="center"> 3 </p></td>
                <td width="27%"><p align="center"> Cyan </p></td>
                <td width="15%"><p align="center"> 11 </p></td>
                <td width="39%"><p align="center"> Light Cyan </p></td>
              </tr>
              <tr>
                <td width="13%"><p align="center"> 4 </p></td>
                <td width="27%"><p align="center"> Red </p></td>
                <td width="15%"><p align="center"> 12 </p></td>
                <td width="39%"><p align="center"> Light Red </p></td>
              </tr>
              <tr>
                <td width="13%"><p align="center"> 5 </p></td>
                <td width="27%"><p align="center"> Magenta </p></td>
                <td width="15%"><p align="center"> 13 </p></td>
                <td width="39%"><p align="center"> Light Magenta </p></td>
              </tr>
              <tr>
                <td width="13%"><p align="center"> 6 </p></td>
                <td width="27%"><p align="center"> Yellow </p></td>
                <td width="15%"><p align="center"> 14 </p></td>
                <td width="39%"><p align="center"> Light Yellow </p></td>
              </tr>
              <tr>
                <td width="13%"><p align="center"> 7 </p></td>
                <td width="27%"><p align="center"> White </p></td>
                <td width="15%"><p align="center"> 15 </p></td>
                <td width="39%"><p align="center"> Bright White </p></td>
              </tr>
            </table>
            <p><strong><strong><a name="param" id="param"></a></strong>Константы  конвертирования</strong></p>
            <table width="95%" align="center" cellpadding="0" cellspacing="4">
              <tr bgcolor="#CCCCCC">
                <td width="18%"><p align="center"><strong> Constant </strong></p></td>
                <td width="7%"><p align="center"><strong> Value </strong></p></td>
                <td width="72%"><p align="center"><strong> Description </strong></p></td>
              </tr>
              <tr>
                <td width="18%"><p><strong> vbUpperCase</strong></p></td>
                <td width="7%"><p> 1 </p></td>
                <td width="72%"><p> Конвертирует символы строки в верхний регистр</p></td>
              </tr>
              <tr>
                <td width="18%"><p><strong> vbLowerCase</strong></p></td>
                <td width="7%"><p> 2 </p></td>
                <td width="72%"><p> Конвертирует символы строки в нижний регистр</p></td>
              </tr>
              <tr>
                <td width="18%"><p><strong> vbProperCase</strong></p></td>
                <td width="7%"><p> 3 </p></td>
                <td width="72%"><p> Конвертирует первый символ каждого слова строки в верхний регистр</p></td>
              </tr>
              <tr>
                <td width="18%"><p><strong> vbWide</strong></p></td>
                <td width="7%"><p> 4 </p></td>
                <td width="72%"><p> Конвертирует однобайтные символы строки в двухбайтные</p></td>
              </tr>
              <tr>
                <td width="18%"><p><strong> vbNarrow</strong></p></td>
                <td width="7%"><p> 8 </p></td>
                <td width="72%"><p> Конвертирует двухбайтные символы строки в однобайтные</p></td>
              </tr>
              <tr>
                <td width="18%"><p><strong> vbKatakana</strong></p></td>
                <td width="7%"><p> 16 </p></td>
                <td width="72%"><p> Конвертирует  символы Хирагана строки в символы Катакана </p></td>
              </tr>
              <tr>
                <td width="18%"><p><strong> vbHiragana</strong></p></td>
                <td width="7%"><p> 32 </p></td>
                <td width="72%"><p> Конвертирует  символы Хирагана строки в символы Катакана</p></td>
              </tr>
              <tr>
                <td width="18%"><p><strong> vbUnicode</strong></p></td>
                <td width="7%"><p> 64 </p></td>
                <td width="72%"><p> Конвертирует  строку в Unicode используя кодовую страницу по умолчанию  (не доступно на Macintosh)</p></td>
              </tr>
              <tr>
                <td width="18%"><p><strong> vbFromUnicode</strong></p></td>
                <td width="7%"><p> 128 </p></td>
                <td width="72%"><p> Конвертирует  строку из Unicode в кодовую страницу по умолчанию  (не доступно на Macintosh)</p></td>
              </tr>
            </table>
            <p>Если у Вас есть замечания, предложения или иные пути решения обсуждаемых проблем - будем рады добавить недостающую информацию к этой статье. Вы можете отправить свои комментарии используя форму или адрес электронной почты приведенные ниже.</p>
            <p class="discuss">
				<span><!--#include virtual="/scripts/forum-comments-num.php?i=722"--></span>
			</p>
			<div class="links">
			<h2>Ссылки по теме</h2>
			<ul>
               <li><a href="/qa/calculate.html">Использование калькулятора значений при работе с атрибутивной информацией в ArcMap</a></li>
			</ul>
			</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 04.12.2005
<br>Автор(ы): Сергей Шаповалов</p>
<!--#include virtual="/inc/footer2.php" -->
