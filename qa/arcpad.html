<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Аппаратное обеспечение и начало работы с ArcPad</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Аппаратное обеспечение и начало работы с ArcPad</h1>
<p class="ann">Синтез опыта работы с ArcPad в поле на КПКв условиях Российской Арктики (некоторые романтические подробности - <a href="http://blog.gis-lab.info/2008-09/khatanga/">здесь</a>)</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=2531"--></span></p>
            <p><strong>Оглавление</strong></p>
            <ol>
                  <li><a href="#01">Выбор GPS и КПК</a></li>
                  <li><a href="#02">Подготовка данных для ArcPad</a></li>
                  <li><a href="#03">Начало работы – создание проекта и начало навигации</a></li>
            </ol>
            <p><strong><img src="/images/1.gif" alt="1" width="33" height="41" align="left" /><a name="01" id="01"></a>Выбор GPS и КПК</strong></p>
            <p>Выбор типа используемого  GPS-приемника во многом определяет продуктивность, удобство и точность работы с  ArcPad, поэтому уместно начать данную статью с этого. В настоящее время все  имеющиеся GPS можно поделить на 4 группы. Рассмотрим достоинства и недостатки   этих групп:</p>
            <p>              А. GPS-приемники, встроенные в КПК и иные мобильные  устройства. К достоинствам безусловно можно отнести компактность и экономию  денег (как правило цены на КПК с GPS-приемником и без него одинаковы), эти GPS  также не очень энергоемки и не требуют своего источника питания. Недостатки: в  такие GPS намертво зашит датум WGS-84, что может создать определенные трудности  в подготовке данных (об этом ниже); низкая (сравнительно) точность без  использования активной антенны GPS (не на всех КПК есть под нее разъем).</p>
            <p> Б. «Слотовые» GPS-приемники CF и SD. В настоящее время с  рынка постепенно уходят. Достоинства – компактность, дешевизна, энергоэкономичны  (хотя ресурс батареи КПК с их использованием и несколько падает). Недостатки –  практическая невозможность использования на КПК с одним слотом для карты памяти  (негде хранить данные), а КПК с 2 слотами сравнительно немного (правда мне  приходилось слышать про CF-GPS, имеющие в своем составе и карту памяти, но  довольно смешных размеров – 256 мб-1гб) , опять же сравнительно низкая точность  без активной антенны, и опять же намертво зашитый датум WGS -84.</p>
            <p> В. Bluetooth-GPS приемники. Достоинства –  удобство использования (нет лишних проводов), компактность. Недостатки –  ресурс батареи КПК при использовании Bluetooth-интерфейса падает в разы (сравните: КПК HP 4700 с батареей на 5000 ма/ч на обычном GPS, соединенном по кабелю, обеспечивает 26-28 часов непрерывной навигации, а c Bluetooth-GPS - 8-9 часов), в самих приемниках батареи  тоже не слишком высокой емкости, к тому же несменяемые, и опять же намертво  зашитый датум WGS -84. Точность и чувствительность этих приемников  (современных), однако, заметно выше двух описанных выше. Не исключено, что уже появились или вот-вот появятся WiFi GPS - это позволит снизить расход энергии.</p>
            <p> Г. Обычные GPS-приемники, связываемые проводом с КПК.  Достоинства – нет проблем с электропитанием (свои сменные аккумуляторы или  батарейки), самая высокая точность из возможных, возможность выбрать нужный  датум. Недостатки – труднодоступность и высокая стоимость кабелей, неудобство  использования – кабели цепляются за все и рвутся.  Предпочтение в этом отношении явно за GPS с цилиндрическим  разъемом интерфейса  (Garmin 12XL, 60  CS(x) и т.д.),  в разъеме, применяемом на  eTrex («площадка») кабель держится откровенно плохо, да и сам разъем непрочен.<br />
              <br />
              На выборе КПК остановимся очень кратко. Из старых моделей, наилучший выбор это Hewlett-Paccard iPAQ 4700 Или Fujitsu-Siemens Pocket Loox 720 p. Оба обладают большим дисплеем (4,5 и 4 дюйма соответственно) и достаточно мощным процессором. Недавно произошло радостное событие - хоть Hewlett-Paccard и объявил в апреле 2006 г., что навсегда уходит с рынка КПК на рынок смартфонов, выпустила<a href="http://h10010.www1.hp.com/wwpc/ru/ru/ho/WF06a/215348-215348-64929-215384-215384-3544060.html" target="_blank" class="external"> iPAQ 214</a> - достойного наследника легендарного 4700-го практически с теми же характеристиками, но с более удобным управлением и новой ОС. Нужно быть также готовым к приобретению сразу же дополнительной батареи к КПК максимальной мощности, какую производят, а также по возможности более быструю карту памяти.</p>
            <p> Не исключено, что скоро надо будет смотреть в сторону уcтройств типа Asus EEE-PC или <a href="http://xdevice.ru/umpc.htm" target="_blank" class="external">вот таких</a> , не имеющих пока определенного единого названия, кроме, пожалуй UMPC - ультрамобильны ПК. Но хотя на них уже можно будет ставить и обычное ПО Windows/Unix, использование ArcPad, специально &quot;заточенного&quot; как мобильная ГИС, не потеряет актуальности. Тем более что цена подобных устройств пока высоковата (в России 25000-90000 руб.)</p>
            <p><strong><img src="/images/2.gif" alt="2" width="33" height="41" align="left" /><a name="01" id="01"></a>Подготовка данных для ArcPad<br />
            </strong><br />
            При использовании ArcPad крайне  важно правильно подготовить данные в правильном формате и проекции. Если вы используете  первые 3 из приведенных типов GPS, то все данные, подготавливаемые для проекта  ArcPad, должны базироваться на датуме WGS-84. Растровые данные, по  спецификациям ArcPad 7x, могут быть в форматах .sid, .jpg и .tiff. В реальности же  мне не удалось никакими способами использовать привязанные данные в формате .jpg,  не совсем понятно, как именно должна быть организована привязочная информация,  но файлы .jpg с world-файлом jpgw ArcPad корректно не отображал. Фомат tiff пригоден только для  одноканальных (монохромных) растров небольших размеров, иначе он будет  грузиться достаточно долго даже с быстрых карт расширения. Поэтому правильнее всего  использовать формат sid. Преобразовать имеющийся растр в .sid можно в Erdas Imagine, При этом можно зайти в Advanced  и в параметрах преобразования повысить на пару единиц параметр Gamma –  это увеличит контрастность картинки на экране КПК.  </p>
            <p>Затем надо создать файл проекции для проекта  ArcPad. Проще всего это сделать в ArcGis 9.x. Идем в пустом проекте в  Layers-Properites-Coordinate Systems  и создаем нужную проекцию (например, я использую проекцию <a href="/qa/gis-lab-projections.html">Albers-Siberia</a>)   в поля новой проекции вводим все ее параметры, кроме датума –  вместо него устанавливаем WGS-84 и сохраняем эту проекцию под новым именем  (в моем случае Albers-Siberia-WGS). Потом нахожу соответствующий файл в c:\Program Files\ArcGIS\Coordinate Systems и  копирую его в каталог будущего проекта ArcPad. Можно и самому создать файл проекции, как описано <a href="/qa/newcs-ag.html">здесь</a>, или  взять файл prj от shape-файла в нужной проекции.</p>
            <p> Если же у вас обычный GPS,  соединенный кабелем КПК, то можно работать на любом датуме, надо только не  забыть выставить его на GPS и (<span class="стиль3">важно!</span>) – перевести в настройках GPS протокол  передачи данных с стоящего по умолчанию Garmin на NMEA Out. Правда, должен  сказать, что мой первый GPS eTrex не всегда корректно работал с User Datum  Pulkovo-1942 (то есть сам работал корректно – некорректно передавал данные в КПК).  Но думаю, что во всех современных моделях этой ошибки уже нет (проверено на  Garmin 12XL, 60CSx, eTrex Legend, eTrex Vista).</p>
            <p> Векторные данные необходимо  сохранить в спроектированном виде в этой же проекции. К сожалению, данные в  географической проекции ArcPad преобразовывать «на лету» не умеет, что  вообще-то странно (например, трек GPS он сохраняет в географической проекции).<br />
              <br />
              <strong><img src="/images/3.gif" alt="3" width="33" height="41" align="left" /><a name="01" id="01"></a>Начало работы – создание проекта и начало навигации<br />
              </strong><br />
              Итак, запускаем ArcPad.

            Нажимаем стандартную кнопку <img src="/images/arcpad-01.jpg" width="27" height="27" /> и добавляем тему (лучше начать с растра, если он  есть).  Затем идем в Layers <img src="/images/arcpad-02.jpg" width="23" height="22" />,  выводится диалоговое окно с слоями  проекта.</p>
            <p align="center">              <img src="/images/arcpad-03.jpg" width="346" height="316" /></p>
            <p>              Жмем на самую верхнюю левую кнопку <img src="/images/arcpad-03a.jpg" width="39" height="32" />, и указываем созданный нами  ранее файл проекции. Теперь наш проект имеет географическую привязку. При  добавлении новых тем ArcPad будет спрашивать соответствие их заданной проекции,  т.к. ранее мы создали все слои в одной проекции – надо соглашаться. Впоследствии при помощи стрелок справа в диалоговом окне можно распределить слои в нужном порядке, а при помощи кнопки <img src="/images/arcpad-03b.jpg" width="24" height="23" /> - задать символы для векторного слоя, а также неотображаемый Background для растра, и многие другие характеристики отображения слоя (вид диалогового окна, вызываемого этой кнопкой, меняется в зависимости от типа слоя). Когда компоновка слоев закончена, надо сохранить проект под вразумительным именем с расширением .apm, лучше всего в тот же каталог, где и остальные слои проекта.</p>
            <p>В принципе, проект может быть собран обычными способами и в ArcMap на локальной машине, и при помощи панели инструментов ArcPad (которая появится в ArcMap автоматически при наличии установленного на машине ArcPad) экспортировать его в проект ArcPad .apm.</p>
            <p> Проверяем надежность соединения  с GPS (если соединение кабельное) и убеждаемся что он включен (для кабельных и Bluetooth-GPS). Если используется Bluetooth–GPS  – сначала его нужно «подружить» с КПК, что делается через мастер установки Bluetooth-соединений в Windows Mobile 2003 и младше (поддержка GPS начиная с WindowsMobile 2005  добавлена непосредственно в ОС) и достаточно хорошо описано на сайтах, посвещенных КПК, а также в Руководстве  пользователя GPS. Как правило, с CF-SD- Bluetooth GPS поставляется примитивная  программа для GPS от производителя,  ее лучше установить, т.к. она позволит протестировать устройство и, главное,  скажет  какой номер COM-порта использует GPS. КПК при связывании с Bluetooth-устройством  также показывает, на каком порту создано соединение.<br />
              Жмем на кнопку GPS <img src="/images/arcpad-04.jpg" width="41" height="25" />,  откроется диалоговое окно GPSPreferences</p>
            <p align="center"><img src="/images/arcpad-05.jpg" width="346" height="241" /></p>
            <p>              На первой вкладке выставляем порт, который присвоен GPS системой (если соединение идет по кабелю с обычным GPS,  то это как правило COM1, если же CF-SD- Bluetooth или встроенный – смотрим порт  в родной программе, иначе придется потом перебирать все порты). Флажок на Automatically Activate нужно установить, если вы хотите, чтоб GPS-навигация включалась сразу же при запуске проекта. Baud можно выставить максимальный,  тогда скорость передачи данных будет ограничена только возможностями самого GPS. Флажок Automaticaly Pan View надо выставить, если нужно,  чтобы вид автоматически сдвигался при выходе местополжоения за пределы экрана КПК. </p>
            <p> Теперь включаем GPS – Стрелка рядом  с кнопкой GPS – GPS Active.</p>
            <p align="center">              <img src="/images/arcpad-08.jpg" width="420" height="270" /></p>
            <p>              Если вы хотите, чтобы велась запись вашей траектории движения (трека), надо активировать пункт меню GPS tracklog.  Также надо зайти в меню Layers – и установить флажок видимости  для GPS Tracklog. Трек будет записываться в формате точечного shape-файла, причем в отличие от обычного трека, выкачанного из GPS <a href="gps-dnrgarmin.html">при помощи скажем DNRGarmin</a>, содержит массу полезной атрибутивной информации - например, точность привязки, направление и скорость движения, для каждой точки (см. таблицу атрибутики tracklog).</p>
            <p align="center"><img src="/images/arcpad-10.gif" width="626" height="388" /></p>
            <p align="center"><img src="/images/arcpad-13.gif" width="583" height="385" /></p>
            <p>Частота снятия точек трека при движении устанавливается при помощи кнопки <img src="/images/arcpad-03b.jpg" width="24" height="23" /> в меню Layers. Здесь же можно очистить tracklog и выбрать место его сохранения.</p>
            <p align="center">              <img src="/images/arcpad-11.jpg" width="356" height="249" /></p>
            <p>              Если  GPS уже «поймал» спутники, появится ваше местоположение на карте или снимке (то  есть на том, что вы загрузили в проект). Кроме того появится окошко GPS Position Window, содержащее  полезную информацию о ваших координатах, абсолютной высоте, точности привязки (PDOP), направлении и скорости движения (SOG), дистанции до следующей точки маршрута (если она указана) - DST, количестве видимых/распознанных спутников и т.д., но если оно мешает, можно его закрыть. </p>
            <p> На рисунке ниже - фрагмент данных высокого разрешения, GPS Bluetooth GlobalSat BT-338 лежит на подоконнике. Достаточно точно, несмотря на то, что более половины небесной сферы закрыто.</p>
            <p align="center">              <img src="/images/arcpad-12.jpg" width="605" height="716" /></p>
            <p> Если же он еще не «поймал» спутники –  ArcPad начнет показывать  диалоговое окно No current position fix available.</p>
            <p align="center">                <img src="/images/arcpad-09.jpg" width="251" height="179" /></p>
            <p>              Тогда  идем опять же в меню GPS – пункт GPS/Rangefinder Debug (см. рисунок с меню GPS выше). Если на появившемся  черном экране вы видите бегущие зеленые строки – ArcPad ваш GPS«видит»  , просто еще не поймал достаточное количество спутников.</p>
            <p align="center">              <img src="/images/arcpad-06.jpg" width="558" height="699" /></p>
            <p>              Если на нем вы не  видите ничего – проверьте кабель (в случае с обычным GPS) или подбирайте  порт, как было описано выше.
              Если же все видно, есть «перекрестие»  GPS, но оно не соответствует реальности – возможно вы ошиблись с проекцией  данных или они неправильно привязаны.<br />
              <br />
              <span class="стиль2">Небольшое дополнение: очень редко  наблюдалось странное поведение ArcPad – GPS/Rangefinder Debug показывал передачу  данных, но показывать позицию без включенного и настроенного  Rangefinder (GPS-Rangefinder Active) категорически отказывался. Решение проблемы было следующее – в  меню GPS-Rangefinder Preferences «повесить» его на любой незанятый порт, а  потом отключить.</span><br />
              <br />
              На этом вводная часть закончена,  о других возможностях ArcPad, надеюсь продолжить в следующих статьях.</p>
            <p align="right"><em>Игорь Поспелов для GIS-Lab.info </em></p>
<p class="discuss">
	<span><!--#include virtual="/scripts/forum-comments-num.php?i=2531"--></span>
</p>
<div class="links">
    <h2>Ссылки по теме</h2>
    <ul>
		<li><a href="gps-onlinenav.html">Онлайн-навигация в Arcview GIS/ArcGIS с помощью DNRGarmin</a></li>
		<li><a href="http://blog.gis-lab.info/2008-09/khatanga/">Особенности национального использования геотехнологий в полевых условиях – Крайний Север</a></li>
    </ul>
</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 03.11.2008
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=3" target="_blank">Игорь Поспелов (taimyr)</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
