<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Анализ спектральных смесей – теория</title>
<!--#include virtual="/inc/header2.txt" -->
<!--Contents start-->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<h1>Анализ спектральных смесей – теория</h1>
<p class="ann">Анализ спектральных смесей (spectral mixture analysis – SMA)</p>
            <p><strong>Популярное объяснение</strong></p>
            <p>Исследуемую территория можно представить в виде множество  разноцветных пятен (пикселей, если речь идет о ДЗЗ).  Когда наблюдатель сильно удален и пятна становятся все меньше и меньше, они смешиваются друг с другом и дают новый цвет,  который является простой смесью цветов. Представьте область, покрытую на 50%  красными пятнами и на 50% зелеными. Если мы будем смотреть на это область  издалека, то мы не сможем различить отдельные пятна, мы увидим один желтый  цвет. В зависимости от разных пропорций зеленого и красного мы будем видеть  разные цвета, и если мы знаем, что на самом деле область покрыта красным и  зеленым цветом, то мы сможет вычислить пропорции красного и зеленого, исходя из  того цвета, который видим. Важно отметить, что каждый участок при этом дает  одинаковый вклад в то, что мы видим. Такое смешивание называют линейным.</p>
            <p align="center"><img src="/images/sma-theory-09.gif" alt="landsat" width="300" height="280" /></p>
            <p><strong>Введение</strong></p>
            <p>Анализ спектральных смесей (далее SMA) - один  из видов так называемого субпиксельного анализа, при котором, в отличие от  классификации, каждому пикселу в результате назначается не единое значение класс, а  совокупность долей (фракций) каждого  класса.</p>
            <p>Подобный анализ подразумевает, что пиксели являются  смешанными и могут (но не обязательно) одновременно  относиться к разным классам.</p>
            <p>Смешанные пиксели – это пиксели, спектральные характеристики  которых являются комбинацией нескольких различных спектральных характеристик (например: вода, растительность, открытый грунт),  получаются если в поле зрения одного элемента матрицы сенсора (IFOV – instantaneous field of view)  попадает больше одного типа поверхностей. Количество смешанных пикселей и  характер смешивания зависит от разрешения сенсора и размеров изучаемых объектов. </p>
            <p align="center"><img src="/images/sma-theory-07.gif" alt="landsat" width="300" height="292" />  <img src="/images/sma-theory-08.gif" alt="landsat" width="300" height="292" /></p>
            <p align="center">Сравнение фрагмента изображения ETM+ и аэрофото представляющих одну и ту же территорию. Увеличивая масштаб, хорошо видно, что каждый пиксел ETM+ может включать разнообразные классы поверхностей в разных пропорциях. </p>
            <p>Ситуация, когда один пиксел представляет из себя смесь  различных информационных классов не редки, поэтому результаты SMA, в определенном смысле, представляют  более реалистичную картину поверхности, чем назначение этому пикселу одного  единственного информационного класса.</p>
            <p>Наилучшие результаты SMA дает при анализ гиперспектральных  данных (Hyperion,   AVIRIS),  однако существует много примеров применения этого метода и для анализа других  данных, особенно Landsat TM/ETM+.</p>
            <p><strong>Метод</strong><strong> </strong></p>
            <p>SMA подразумевает сравнение смешанных спектров с набором  «чистых» спектральных образцов (endmembers). Чистые образцы  могут быть получены двумя способами:</p>
            <ul>
              <li>Измерены в лаборатории или в полевых  исследованиях с помощью специальных приборов – спектрометров, или: </li>
              <li>Получены с самого изображения экспертно. </li>
            </ul>
            <p>Получение хороших спектральных образцов – один из залогов успеха SMA и главная его трудность. При  выборе образцов подразумевается что 100% территории заняты только этим  объектом. Так например чистый образец растительности может быть представлен  полем по посевной культурой с большим проективным покрытием или густым тропическим  лесом, чистый образец почвы – голый грунт, песок, открытые горные породы и т.д.</p>
            <p>Существует несколько способов описания, как происходит  комбинация спектров, самой распространенной является линейная модель  смешивания. Согласно этой модели, полученный от определенной площади земной  поверхности спектральный отклик является линейной композицией индивидуальных  спектров составляющих присутствующих на этой площади.</p>
            <p align="center">спектральный отклик =  спектр1*доля1 + спектр2*доля2 и т.д.</p>
            <p>Согласно этой модели, вес каждого чистого спектра определяется  долей территории, которую он занимает.</p>
            <p>Зная спектральные характеристики чистых образцов (полученных в поле или из изображения) и спектральных  откликов – собственно значений пикселей, можно решив систему уравнений получить  набор изображений, число которых равно числу образцов. Каждое изображение  представляет из себя матрицу значений показывающих долю конкретного образца в данном  пикселе.</p>
            <p>Например, если конечных спектров 3: вода, грунт,  растительность, то результатом SMA будет 3 изображения, каждое из которых будет показывать  процент или долю воды, растительности или грунта в данном пикселе.</p>
            <p>Сумма долей конечных спектров должна быть равна единице.  </p>
            <p align="center"><img width="235" height="56" src="/images/sma-theory-01.gif" /></p>
            <p>где,</p>
            <p><em>Fi</em> – доля образца i<br />
              N – количество образцов</p>
            <p>Хотя значения долей вне диапазона 0..1 физически невозможны (определенный тип ландшафта не может занимать больше 100%), обычно это ограничение в систему уравнений не вводят, оставляя только ограничение на сумму долей. Анализ получаемых значений позволяет судить о правильности выбора конечных спектров, то есть, если большое количество пикселей принимает значения значительно меньшие чем 0 или большие чем 1, вероятно, что, либо конечные спектры были подобраны неудачно, либо данный метод просто плохо работает для данного случая (например типы ландшафтов изначально плохо разделяются спектрально).</p>
            <p>В нашем примере N=3, для воображаемого пиксела:<br />
              0.3 растительности + 0.5 воды + 0.2 открытого грунта = 1</p>
            <p>Для данного спектрального диапазона (канала данных), значение  в этом канале (DN) для  каждого пиксела является суммой значений, которые могли бы быть получены с  этого пиксела, если бы он был на 100% занят данным конечным спектром  (теоретическое значение - DNl,N), умноженных на долю на самом  деле занятую этим конечным спектром (практическое значение - FN) + некоторую неизвестную  ошибку.</p>
            <p align="center"><img src="/images/sma-theory-02.gif" alt="формулы" width="196" height="53" /><br /></p>
            <p>или</p>
            <p align="center"><img src="/images/sma-theory-03.gif" alt="формулы" width="376" height="34" /></p>
            <p>Где, <br />
                <em>Fi</em> – доля образца i<br />
              N – количество образцов <br />
  <em>DN</em><em>l</em> <em>– </em>яркость пиксела  в канале l<br />
  <em>DN</em><em>l,</em><em>i – </em>яркость образца i в канале l<br />
  <em>Ei – </em>ошибка моделирования в данном канале.</p>
            <p>Например, допустим в нашем примере, что, для первого канала Landsat, «чистые» спектры  наших информационных классов, то есть значения которые бы они принимали, если  бы занимали 100% пиксела, следующие: <br />
              «вода» = 57<br />
              «растительность» = 100<br />
              «грунт» = 200<br />
              То, при долях, соответственно: 0.3, 0.5, 0.2 значение  результирующего пиксела:</p>
            <p align="center">DN = 0.3*57  + 0.5*100 + 0.2*200 + ошибка = 167.1 + ошибка </p>
            <p>В случае многоканальных данных, для каждого канала будет  свое уравнение для вычисления значения пиксела. Таким образом, для N каналов,  для каждого пиксела будет N  уравнений, плюс еще одно, для приведения суммы долей к единице. </p>
            <p>Таким образом, неизвестными являются именно доли F и  их определение и является задачей анализа, поэтому часто этот процесс называют  «разделением» или «декомпозиции» (unmixing), то есть  получением из целого - состовляющих. Количество образцов должно быть меньше или  равно количеству спектральных диапазонов +1. Для 4 канального снимка можно  определить доли покрытия пяти классов (без определения   ошибки) или меньшего количества (с   определением ошибки).</p>
            <p>Если количество образцов равно количеству спектральных  диапазонов - 1, то система уравнений может быть решена с определением показателя  ошибки. Например, допустим, что у нас 3 конечных спектра (N=3) и 4  канала Landsat:</p>
            <p align="center"><img src="/images/sma-theory-04.gif" alt="формулы" width="341" height="158" /></p>
            <p>Значение DNl,i известно  и получается из конечных спектров, DNl также известно и является результирующим значение пиксела в  данном канале. Остается найти только F1, F2,  F3 решением  этой системы уравнений. Система таких уравнений решается методом наименьших  квадратов.</p>
            <p>Ошибка метода определяется как разница между смоделированным  значением спектрального отклика в данном спектрально диапазоне и его реального  значения (DN пиксела), данное  значение называется остатком в данном канале (band residual). После  вычисления долей, он вычисляется очень просто:</p>
            <p align="center"><img src="/images/sma-theory-05.gif" alt="формулы" width="370" height="34" /></p>
            <p>Из формулы очевидно, что после осуществления декомпозиции каждый  пиксел получает набор остаточных ошибок (residuals), число которых равно числу каналов (ошибка моделирования в каждом канале). Анализ этих значений может помочь определить наиболее проблематичные каналы – значения  в которых плохо поддались моделированию.</p>
            <p>Все остаточные ошибки по каналам (band residuals, B – число   каналов) можно объединить в один показатель –  среднеквадратичную ошибку. Анализ распределения этой ошибки так же может помочь понять, какие типы ландшафтов были разложены в ряд компонентов с большой ошибкой, а какие с небольшой.</p>
            <p align="center"><img src="/images/sma-theory-06.gif" alt="формулы" width="161" height="86" /></p>
            <p><strong>Недостатки </strong><strong>SMA</strong></p>
            <p>К сожалению, в реальном мире, смешивание спектральных  откликов не всегда линейно, помимо отраженных спектров, в значение  результирующего пиксела могут также включаться многократные переотраженные  спектры (например между листвой и почвой).  В этом случае необходимо применять для разделения более сложные нелинейные  модели спектрального смешивания. Также могут быть полезны   алгоритмы, не подразумевающие нормального распределения исходных данных и не  исходящие из предположения, что чистые спектры смешиваюся линейно, такие как нейросети и деревья классификации.</p>
            <p>Другой проблемой является часто практическая невозможность  разделить два типа поверхностей из-за недостатка спектральной разрешающей  способности конкретного сенсора, например открытая почва и сухая растительность  имеют очень похожие спектральные кривые и используя данные сенсора TM/ETM+ различить их сложно. </p>
            <p class="discuss">
				<span><!--#include virtual="/scripts/forum-comments-num.php?i=852"--></span>
			</p>
			<div class="links">
			<h2>Ссылки по теме</h2>
			<ul>
               <li><a href="modislandprod.html">Ссылка на дополнительный источник информации внутренняя</a></li>
               <li><a href="http://lpdaac.usgs.gov/landdaac/tools/modis/about.asp" target="_blank" class="external">Ссылка на дополнительный источник информации внешняя</a></li>
			</ul>
			</div>
            <!--#include virtual="/scripts/date.php" -->
<!--Contents end-->
<!--#include virtual="/inc/footer2.php" -->
