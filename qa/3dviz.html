<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Визуализация рельефа в Arcview GIS</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Визуализация рельефа в Arcview GIS</h1>
<p class="ann">Данная заметка не претендует на исчерпывающее
                    объяснений теории цифровых моделей рельефа, а преследует цель
                    проиллюстрировать начинающему пользователю подход, который можно
                    использовать для их получения с помощью Arcview 3.x</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=4072"--></span></p>
<p>Придание карте, подготавливаемой к публикации в печати
  или Internet, рельефного вида весьма повышает ее привлекательность.
  ArcView GIS при наличии подключаемых модулей Spatial Analyst и 3D
  Analyst имеет неплохие возможности для создания подобных карт.</p>
            <p><b>Часть 1. Создание базового слоя который будет представлять
              рельеф (GRID)</b><br />
              Для придания изображению видимого объема необходимо наличие слоя,
              представляющего непрерывное поле значений высот. Если работа с этим
              слоем идет в Arcview\ArcInfo то этот слой скорее всего будет представлен
              специальным форматом GRID. GRID можно рассматривать как одноканальный
              растровый слой, каждому пикселу которого, присвоено определенное
              значение, в нашем случае - высота над уровнем моря.</p>
            <p>Для создания GRID необходимо иметь shape-файл, отражающий
              рельеф, в большинстве случаев это линейный слой горизонталей, в
              числе атрибутов которого есть поле высоты. Непосредственно по горизонталям
              GRID можно построить средствами ArcInfo или Erdas, в ArcView 3x
              ситуация несколько сложнее, так как GRID здесь можно построить только
              по точечной теме. </p>
            <p>Для начала нужно получить базой GRID, на основе которого
              будут получаться другие слои, которые придадут нашему рельефу объем.
              Ниже описывается 2 способа построения основного GRID'a в ArcView.<br />
            </p>
            <p><img src="/images/1.gif" width="33" height="41" align="left" /> <strong>Способ более сложный, но более точный</strong></p>
            <p>Линейную тему необходимо <a href="lines2points.html">превратить в точечную</a> (точки ставятся в узлах линий).
              Активизируем тему рельефа в горизонталях и запускаем скрипт. После
              запуска будет предложено выбрать место сохранения и имя создаваемой
              точечной темы, а также какое из полей атрибутивной таблицы будет
              выведено - естественно, выбираете поле в котором записано значение
              высоты соответствующей изолинии. Итогом действия этого скрипта будет
              точечная тема с массой атрибутивных полей в таблице, из которых
              нам нужно только одно, а именно поле высоты, которое сохранило имя,
              бывшее в атрибутивной таблице исходной темы. Остальные поля можно
              смело удалить из таблицы.</p>
            <p align="center"><img src="/images/3dviz-01.gif" width="269" height="261" border="1" /></p>
            <p>Небольшое примечание. Для повышения точности построения
              можно также конвертировать в точечный слой гидрографические темы,
              имеющие параметр высоты уреза над ур.моря, а затем сшиваю с помощью
              Geoprocessing Wizard точечные слои, построенные на основе горизонталей
              и гидрографии с точечным слоем отметок высот (пунктов триангуляции
              и т д.) и другими слоями объекты которых имеют такую характеристику
              как высота над уровнем моря - то есть все эти темы сливаются в один
              слой, по которому расчитывается GRID. <br />
            </p>
            <p>Подгружаем модуль Spatial Analyst (<b>File\Extensions</b>).
              В строке меню появится 2 новых пункта - &quot;<b>Analisys</b>&quot;
              и &quot;<b>Surface</b>&quot; Делаем активной созданную только что
              точечную тему и выбираем <b>Surface\Interpolate Grid</b>. В появившемся
              диалоговом окне (рис.2) нужно выбрать область построения GRID и
              задать размер ячейки GRID в единицах вида (чаще всего - в метрах). </p>
            <p align="center"><img src="/images/3dviz-02.gif" width="328" height="242" border="1" /></p>
            <p>Поля Rows и Columns установятся сами после установки
              размера ячейки. Жмем ОК, появляется второе диалоговое окно. </p>
            <p align="center"><img src="/images/3dviz-03.gif" width="284" height="260" border="1" /></p>
            <p>Здесь нужно обратить особое внимание на поле <b>Z
              value</b> - проверьте, что это действительно поле, соответствующее
              высоте (если вы, конечно, не удалили все прочие поля). Методы интерполяции
              вам вполне подойдут те, что стоят по умолчанию (обычно используется
              метод <b>IDW</b>). Что же касается поля Barriers, то в принципе
              оно предназначено, чтобы при построении GRID учитывалась и линейная
              тема горизонталей как границ между классами значений высот, но использование
              этой возможности сильно добавляет вычислений процессору.</p>
            <p class="text10px">Примечание. ArcView не спрашивает,
              куда сохранять полученный GRID - тему, а отправляет ее в системный
              директорию определенную переменной <b>TEMP</b>. Имеет смысл ее скопировать
              его потом в нужное место (обратите внимание - GRID это не файл,
              а каталог) или выполнить Theme\Convert to grid, где и указать для
              созданной темы ПМЖ.</p>
            <p align="center"><img src="/images/3dviz-04.gif" width="443" height="428" border="1" /></p>
            <p><img src="/images/2.gif" width="33" height="41" align="left" /> Более простой способ. Подгружаем модули <b>Spatial Analyst </b>и <b>3D Analyst </b>(<b>File\Extensions</b>). Активизируем слой горизонталей
              и выбираем Surface\Create TIN from Features. Появится диалоговое
              окно, где нужно обратить внимание на поле Height Source - должно
              быть задано поле, содержащее значение высот. Жмем ОК, получаем модель
              рельефа <b>TIN</b> (рис. 6) (о сущности этой модели - в другой заметке,
              здесь она нам требуется только как промежуточный этап). Активизируем <b>TIN</b>, выбираем<b> Theme\Convert to grid</b>. Будет предложено
              задать имя и место сохранения GRID, а потом выбрать размер ячейки
              и область построения. Результат - тот же, что и при первом способе.</p>
            <table width="75%" border="0" align="center">
              <tr>
                <td><p><img src="/images/3dviz-05.gif" width="422" height="224" /></p>
                  <p><img src="/images/3dviz-06.gif" width="364" height="324" alt="Рельеф представленный моделью данных TIN" /></p></td>
              </tr>
            </table>
            <p><b>Часть 2. Создание карт теневого рельефа</b></p>
            <p>Исходные данные мы подготовили, начинается художественное
              творчество. Для начала &quot;перекрашиваем&quot; GRID в цвета, соответствующие
              общепринятым нормам отмывки рельефа. Дважды щелкаем мышью по GRID
              в содержании вида, вызываем редактор легенды. В списке &quot;<b>Color
              ramps</b>&quot; выбираем &quot;<b>Terrain Elevation</b>&quot; (3
              варианта) - если у вас есть в GRID морские глубины (отрицательные
              высоты), или &quot;<b>Land Cover</b>&quot; (2 варианта) - если их
              нет. Можно также поменять классификацию (по умолчанию выставляется
              9 классов), ввести вручную значения высот, чтобы они шли не абы
              как, а с правильным интервалом (0-50, 50-100 и т.д. ). Лучше всего
              один раз поработать и создать наиболее приемлемую для ваших целей
              шкалу и сохранить ее как файл <b>.avl</b>, а далее применять ее
              всегда. Уже красивее…</p>
            <p align="center"><img src="/images/3dviz-07.jpg" width="317" height="231" border="1" /></p>
            <p>Теперь нам нужно оттенить рельеф, добавить ему теней.
              Делаем тему базового рельефа активной и выбираем <b>Surface\Compute
              Hilshade</b>. В диалоговом окне предлагают указать азимут на источник
              освещения, от которого будут зависеть направления теней (<b>azimuth</b>)
              и высоту солнца (<b>altitude</b>) над горизонтом.</p>
            <p align="center"><img src="/images/3dviz-08.gif" width="381" height="134" border="1" /></p>
            <p>Результат c настройками по умолчанию, тема с названием <b>Hilshade of GRID</b>… Легенда ее - градиентный цветовой переход
              от черного к белому, можно ее не трогать. Тема сама по себе довольно
              информативна, но мы ее будем использовать как дополнительную к базовому
              слою, для получения не просто теневого рельефа, а еще и раскрашенного
              по цветам.</p>
            <p align="center"><img src="/images/3dviz-09.jpg" width="309" height="235" /></p>
            <p align="left"><b>Часть 3. Создание карт теневого рельефа
              раскрашенных по высотам</b></p>
            <p>Возвращаемся к теме базового рельефа. Вызываем редактор
              легенды, нажимаем &quot;<b>Advanced</b>&quot;. В качестве <b>Brightness
              Theme </b>указываем только что созданную тему теневого рельефа.
              Минимальное значение яркости делаем меньше (10-20-30 - экспериментируйте
              !!!), максимальное указываем 100, для большего контраста. Нажимаем
              ОК, затем Apply. Результат - карта с оттененным рельефом раскрашенным
              по высотной зональности.</p>
            <p align="center"><img src="/images/3dviz-11.jpg" width="371" height="274" border="1" /></p>
            <p>Примечание. Подбор нижнего значения
              яркости нужно осуществлять с учетом соотношение горных и равнинных
              территорий. Сильное оттенение гор (низкие значения минимума) приводит
              к выравниванию цветов на низменности.</p>
            <p>Иногда бывает необходимо наложить на рельеф монотонные
              полигональные объекты (на нашем примере - заповедные территории),
              но в то же время сохранить рельефность поверхности под ними. Задача
              решается следующим образом. Делаем активной полигональную тему и
              выбираем Theme - Convert to grid. В появившемся окне указываем,
              куда и с каким именем сохранить тему, затем выбираем область анализа
              (конвертации) и размер ячейки, последний выставьте тот же, что и
              у базового рельефа. Далее будет предложено выбрать поле из атрибутивной
              таблицы, которое будет присоединено к GRID - теме. Лучше всего заранее
              создать в таблице исходной векторной темы поле, в котором будут
              нужные значения (например, код ООПТ - заповедник, заказник и т.д),
              тогда присоединяем это поле. Далее будет еще раз предложено присоединить
              эти атрибуты к GRID - теме, ответьте &quot;Yes&quot; Результат -
              GRID - тема с легендой, в которой присутствуют значения согласно
              ранее выбранным атрибутивным полям и значение &quot;No Data&quot;,
              которое надо &quot;обесцветить&quot; при помощи стандартных средств
              редактора легенды Редактировать цвета прочих классов легенды лучше
              после &quot;оттенения&quot; рельефа, так как они серьезно при этом
              поменяются. </p>
            <p>Чтобы &quot;оттенить&quot; рельеф, делаем то же, что
              ранее - редактор легенды - &quot;Advanced&quot; - выбор темы с теневым
              рельефом, но уже не для базового рельефа, а для полученного GRID
              для дополнительных объектов.</p>
            <p align="center"><br />
              <img src="/images/3dviz-12.jpg" width="358" height="226" border="1" /></p>
<p class="discuss"><span><!--#include virtual="/scripts/forum-comments-num.php?i=4072"--></span></p>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 25.05.2003
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=3" target="_blank">Игорь Поспелов (taimyr)</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
