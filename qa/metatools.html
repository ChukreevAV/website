<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Работа с метаданными при помощи Metatools для QGIS</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Работа с метаданными при помощи Metatools для QGIS</h1>
<p class="ann">Описание инструмента редактирования и просмотра метаданных
для QGIS.</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=8390"--></span></p>

<p>В настоящее время доступно более 150 расширений для QGIS. Функционал
ядра системы тоже растет необычайно быстро. Но не смотря на это, в QGIS
до недавних пор не было возможности работать с такой важной информацией как
метаданные. Это не давало полноценно обрабатывать массивы
геоданных, так как нет возможности ни просматривать, ни подготавливать
сопряженную метаинформацию.</p>
<p>До недавнего времени единственным инструментом, позволяющим открывать
и частично редактировать метаданные, являлось расширение <a href="http://plugins.qgis.org/plugins/24/" target="_blank" class="external">MetaEdit</a>
(автор Alex Mandel). Но его разработка была прекращена более
года назад, а большая часть заложенного функционала так и не была реализована.</p>
<p>Для исправления ситуации силами NextGIS был разработан новый модуль для
QGIS&nbsp;&mdash; Metatools, позволяющий создавать, редактировать и просматривать
метаданные.</p>
<p>Разработка расширения выполнена NextGIS по заказу Linifiniti Consulting.</p>

<div style="text-align:center;margin:10px 0;"><a href="http://nextgis.ru" target="_blank"><img height="33" width="100" alt="Комания NextGIS: Создание открытого ПО ГИС и реализация проектов" src="http://nextgis.ru/img/nextgis.png" style="margin: 0pt 7px 0pt 0pt; vertical-align: middle;"></a><strong style="font: bold 11px Arial;">Создание открытого ПО ГИС и реализация проектов</strong></div>

<p><strong>Оглавление</strong></p>
<ol>
  <li><a href="#01">Получение и установка</a></li>
  <li><a href="#02">Работа с расширением</a></li>
  <li><a href="#03">Заключение</a></li>
  <li><a href="#04">Контакты</a></li>
</ol>

<h2><strong><a name="01" id="01"></a></strong>1. Получение и установка</h2>
<p>Расширение доступно из <a href="http://gis-lab.info/programs/qgis/qgis-repo.xml">репозитория ГИС-Лаб</a>.</p>
<p>Metatools разработан для QGIS версии 1.5.0 и старше. Для своей работы
требует наличия Qt 4.6.0 или старше и соответствующую версию PyQt, кроме
того необходимо наличие GDAL и её привязок (bindings) к Python. Все необходимые
компоненты доступны в как при использованиии standalone установщика, так и
при использовании OSGeo4W.</p>
<p>Исходный код модуля можно получить выполнив команду</p>
<pre>svn co http://svn.gis-lab.info/metatools/trunk metatools</pre>

<h2><strong><a name="02" id="02"></a></strong>2. Работа с расширением</h2>
<p>После подключения расширение создает две панели и добавляет вложенное
меню в пункт &laquo;Модули&raquo;.</p>

<p align="center"><img src="/images/metatools-01.png" alt="Панель расширения" width="354" height="40"></img></p>
<p align="center"><img src="/images/metatools-02.png" alt="Расширение в меню" width="462" height="341"></img></p>

<p>Расширение позволяет создавать, просматривать и редактировать метаданные
в формате <a href="http://www.iso.org/iso/catalogue_detail.htm?csnumber=26020" target="_blank" class="external">ISO19115/ISO19139</a>,
а также просматривать и редактировать метаданные в формате <a href="http://www.fgdc.gov/metadata/csdgm/" target="_blank" class="external">FGDC</a>.
Поддержка других форматов и стандартов, таких как Dublin Core, планируется
в следующих версиях. Желающие помочь в добавлении новых стандартов и
проспонсировать их добавление будут встречены с распростертыми объятиями.</p>
<p>Возможна работа с метаданными как растровых, так и векторных слоёв
(в данный момент поддерживаются shape-файлы). Если слой не имеет метаданных, то при
попытке их просмотра или редактирования модуль создаст новый пустой файл
на основе профиля, выбранного пользователем.</p>

<h3>Просмотр метаданных</h3>
<p><img src="/images/metatools-03.png" alt="Просмотр метаданных" width="137" height="137"></p>
<p>Просмотр метаданных реализован путем их транслирования в html-представление.
Это позволяет достаточно просто изменять внешний вид формы вывода путем
редактирования файла преобразования xslt. Файлы преобразований хранятся в
каталоге xsl папки расширения, например в ~/.qgis/python/plugins/Metatools/xsl/iso19115.xsl.
Для редактирования этого файла достаточно базовых познаний в xslt и любого
текстового редактора. Пример стандартного оформления приведен ниже.</p>

<p align="center"><img src="/images/metatools-04.png" alt="Окно просмотрщика" width="836" height="782"></img></p>

<p>Используя контекстное меню можно копировать все метаданные или только
выделенный текст, что позволяет копировать информацию в другие редакторы
как в текстовом, так и в HTML-представлении. Кроме того, из контекстного
меню можно отправить метаданные на печать.</p>

<h3>Редактирование метаданных</h3>
<p><img src="/images/metatools-05.png" alt="Редактирование метаданных" width="137" height="137"></p>
<p>Форма редактирования имеет два режима работы: отображение всего дерева
узлов (&laquo;Full view&raquo;)

<p align="center"><img src="/images/metatools-06.png" alt="Редактор метаданных (полный вид)" width="888" height="738"></img></p>

и отображения отфильтрованных полей (&laquo;Filtered view&raquo;).

<p align="center"><img src="/images/metatools-07.png" alt="Редактор метаданных (избранные поля)" width="888" height="738"></img></p>

<p>Такое поведение позволяет быстро редактировать заранее выбранные поля
(например, фильтр можно использовать для быстрого доступа к наиболее
востребованным полям), а при необходимости изменять любые другие, найдя
их в иерархическом списке.</p>
<p>Фильтров может быть сколько угодно, активный фильтр задается в настройках
расширения. Описание фильтра хранится в текстовом виде, поэтому для создания
нового фильтра необходимо создать новый текстовый файл и вписать в него
полный путь к необходимым узлам по одному узлу в каждой строке. Например,
так</p>
<pre>
MD_Metadata -> fileIdentifier
MD_Metadata -> contact -> CI_ResponsibleParty -> individualName
MD_Metadata -> contact -> CI_ResponsibleParty -> organisationName
</pre>
<p>Узнать полный путь просто: при просмотре полного дерева метаданных над
полем редактирования значения в правой части формы выводится полный путь
до соответствующего узла. Скопировать путь можно вызвав контекстное меню
по правой клавише мыши.</p>
<p>Полученный текст без завершающего описания типа и будет искомой строкой
фильтра. Например, узел выглядит так</p>
<pre>MD_Metadata -> dateStamp -> gco:Date</pre>
<p>последняя часть (gco:Date)&nbsp;&mdash; идентификатор типа данных,
который при создании строки фильтра необходимо отбросить. Таким образом,
в файл фильтра попадет строка</p>
<pre>MD_Metadata -> dateStamp</pre>
<p>После этого, сохраняем файл в удобном месте, и в окне настроек расширения
в поле &laquo;Файл фильтра&raquo; указываем этот файл.</p>

<p align="center"><img src="/images/metatools-08.png" alt="Настройка фильтра" width="376" height="350"></img></p>

<p>В каталоге filter папки расширения находится файл с примером набора фильтров.</p>

<p>Для редактирования необходимо выделить нужный узел в левой части
диалогового окна, значение узла отобразится в поле &laquo;Редактировать
значение&raquo; в правой части окна, где его и необходимо откорректировать.
Нажатие на кнопку &laquo;Применить&raquo; приведет к обновлению метаданных,
отменить изменения можно нажав &laquo;Отменить&raquo;. <strong>Внимание!</strong>
Все изменения хранятся в памяти, запись на диск выполняется по нажатию на кнопку
&laquo;Сохранить&raquo;.</p>
<p>При редактировании необходимо помнить, что в настоящее время расширение
не выполняет проверку введенных значений на соответствие со схемой стандарта
т.к. существуют некоторые ограничения платформы разработки. Но будем надеяться,
что в скором времени появится возможность реализовать эту функциональность.</p>

<h3>Работа с шаблонами</h3>
<p><img src="/images/metatools-09.png" alt="Применить шаблоны" width="137" height="137"></p>
<p>Для удобства подготовки метаданных для большого количества слоев
предусмотрен механизм шаблонов. Благодаря ему, пользователь, заполнив один
раз информацию об организации, лицензии, процессах обработки и типе контента,
может применять эти данные сразу к нескольким слоям.</p>
<p><strong>Примечание</strong>: шаблоны работают только при использовании
метаданных в формате ISO19115, поддержка шаблонов для FGDC находится в
разработке.</p>

<p align="center"><img src="/images/metatools-10.png" alt="Применение шаблонов к слоям" width="649" height="399"></img></p>

<p>Можно создавать неограниченное число шаблонов, нажатие на кнопку
&laquo;Manage&raquo; вызовет окно управления соответствующими шаблонами</p>

<p align="center"><img src="/images/metatools-11.png" alt="Управление шаблонами Тип данных" width="387" height="529"></img></p>

<p>Файлы шаблонов хранятся во вложенных каталогах папки templates внутри
каталога расширения.</p>
<p>При записи информация из шаблона будет сохранена в документ метаданных
в соответствии со стандартом.</p>
<p>Помимо применения шаблонов к загруженным слоям, имеется возможность
применять шаблоны к наборам геоданных, которые хранятся на локальном носителе,
без непосредственной загрузки их в QGIS. Для этого необходимо установить
флажок &laquo;Выбрать файлы на диске&raquo; и выбрать необходимые файлы
на диске</p>

<p align="center"><img src="/images/metatools-12.png" alt="Применение шаблонов к файлам" width="649" height="399"></img></p>

<p>При необходимости, можно активировать автоматическое заполнение таких
полей метаданных как максимальный охват слоя, количество каналов, тип данных,
максимальное и минимальное значение для каждого из каналов растра. Эта
возможность включается установкой флага &laquo;Извлечь информацию о слое
в файл метаданных&raquo;. Так же, при обработке растровых слоёв модуль
способен автоматически генерировать так называемые preview файлы для растров,
в формате выбранном пользователем (задается в настройках модуля). За это
отвечает переключатель &laquo;Сгенерировать preview изображение&raquo;.</p>
<p>При наличии текстовых логов автоматизированной обработки данных,
пользователь может присоединить их к метаданным. Для этого перед началом
применения шаблонов необходимо указать файл с логом на диске, после чего
модуль добавит информацию из него ко всем метаданным выбранных слоёв или
файлов.</p>

<h3>Импорт и экспорт метаданных</h3>
<p><img src="/images/metatools-13.png" alt="Импорт метаданных" width="137" height="137">&nbsp;
<img src="/images/metatools-14.png" alt="Экспорт метаданных" width="137" height="137"></p>
<p>Инструменты импорта предназначен для загрузки метаданных слоя из уже
существующего файла метаданных (полезно, если метаданные слоёв практически
идентичны). Инструмент экспорта позволяет сохранить метаданные слоя в
отдельный файл с произвольным именем.</p>

<h3>Проверка метаданных</h3>
<p><img src="/images/metatools-15.png" alt="Проверка метаданных" width="137" height="137"></p>
<p>Инструмент предназначен для валидации (проверки на соответствие выбранному
стандарту) файлов метаданных. В настоящее время инструмент находится в разработке
и поддерживает только метаданные в формате FGDC, информативность сообщений
об ошибках также оставляет желать лучшего.</p>

<p align="center"><img src="/images/metatools-16.png" alt="Результат проверки метаданных" width="566" height="204"></img></p>

<h3>Работа с метаданными в формате FGDC</h3>
<p>Так как части функций для полноценной работы с метаданными расширение
пока не имеет, в его состав временно включены два внешних инструмента:
<a href="http://geology.usgs.gov/tools/metadata/tools/doc/tkme.html" target="_blank" class="external">USGS Tkme</a>
&nbsp;&mdash; редактор FGDC метаданных от Peter N. Schweitzer и
<a href="http://geology.usgs.gov/tools/metadata/tools/doc/mp.html" target="_blank" class="external">mp</a>
&nbsp;&mdash; валидатор для этого же стандарта. Для удобства, кнопки вызова
этих инструментов вынесены на отдельную панель.</p>
<p><img src="/images/metatools-17.png" alt="USGC Tkme" width="32" height="32">&nbsp;&mdash; USGS Tkme</p>
<p><img src="/images/metatools-18.png" alt="mp" width="32" height="32">&nbsp;&mdash; mp</p>
<p>Эти утилиты помогают редактировать документы с учетом специфики стандарта
FGDC, а также проверять уже существующие наборы метаданных на соответствие
стандарту. Запуск утилит производится непосредственно из интерфейса QGIS,
что позволяет удобно обрабатывать метаданные, связанные с загруженными слоями.</p>

<p align="center"><img src="/images/metatools-19.png" alt="Редактирование метаданных в Tkme" width="683" height="496"></img></p>
<p align="center"><img src="/images/metatools-20.png" alt="Проверка метаданных в mp" width="813" height="532"></img></p>

<h3>Настройки модуля</h3>
<p><img src="/images/metatools-21.png" alt="Настройки модуля" width="137" height="137"></p>
<p>Здесь задаются параметры фильтра для режима редактирования &laquo;Избранные
поля&raquo;, формат preview-изображений, профиль метаданных по умолчанию
и настраиваются стили просмотра (параметры преобразования в HTML-представление)
метаданных.</p>

<p align="center"><img src="/images/metatools-08.png" alt="Диалог настройки модуля" width="376" height="350"></img></p>

<h2><strong><a name="03" id="03"></a></strong>3. Заключение</h2>
<p>На данном этапе развития расширение не является идеальным инструментом
работы с метаданными. Не хватает валидации по стандарту и расширенной
работы с узлами. Нет возможности работать со свойствами узлов, что часто
бывает необходимым условием. Помог бы при работе и полнотекстовый поиск
по документу.</p>
<p>Но даже в таком виде расширение получилось достаточно функциональным
и удобным. Разработчики продолжают работать над функционалом и добавлением
поддержки новых стандартов. Будем надеяться, что в новых версиях перечисленные
выше недостатки будут устранены.</p>

<h2><strong><a name="04" id="04"></a></strong>4. Контакты</h2>
<p>Если вы нашли ошибку, у вас есть предложения по улучшению расширения или
просто вопросы по использованию&nbsp;&mdash; напишите <a href="http://www.nextgis.ru/contact/">нам</a>.</p>
<div style="text-align:center;margin:10px 0;"><a href="http://nextgis.ru" target="_blank"><img height="33" width="100" alt="Комания NextGIS: Создание открытого ПО ГИС и реализация проектов" src="http://nextgis.ru/img/nextgis.png" style="margin: 0pt 7px 0pt 0pt; vertical-align: middle;"></a><strong style="font: bold 11px Arial;">Создание открытого ПО ГИС и реализация проектов</strong></div>

<!-- обсуждение на форуме, цифра изменяется при публикации статьи -->
<p class="discuss"><span><!--#include virtual="/scripts/forum-comments-num.php?i=8390"--></span></p>

<div class="links">
<h2>Ссылки по теме</h2>
<ul>
   <li></li>
   </ul>
</div>

<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 08.08.2011
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=7776" target="_blank">Никулин Евгений</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
