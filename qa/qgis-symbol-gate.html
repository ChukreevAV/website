<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Создание комплексных условных знаков в QGIS: &quot;шлюз&quot;</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Статьи</a></li>
</ul>
<!--Contents start-->
<h1>Создание комплексных условных знаков в QGIS: &quot;шлюз&quot; </h1>
<p class="ann">Пошаговый пример создания сложного условного знака </p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=7784"--></span></p>

<p>Новая символика в QGIS позволяет создавать очень сложные условные знаки.   В  версии 1.7 она будет ещё более развитой, чем прежде.   Встроенными средствами можно добиться очень многого, главное знать с   какой стороны подойти.</p>
<p>Цель данной статьи заключается в том, чтобы на конкретном примере   продемонстрировать читателю подходы к составлению условных знаков в   версии QGIS 1.7.</p>
<p>Вот пример сложного в исполнении условного знака - шлюз:</p>
<p class="ill">
    <img src="/images/qgis-symbol-gate-01.png" alt="Условный знак шлюза" width="286" height="114" border="0">
    <span>Условный знак шлюза</span></p>
<p>Может показаться, что построить его средствами QGIS просто невозможно,   однако это не так. Вот так он выглядит после экспорта из компоновки   карты:</p>
<p class="ill">
  <img src="/images/qgis-symbol-gate-07.png" alt="Условный знак 'шлюз' в QGIS (река - отдельный полигональный слой)" width="130" height="123" border="0">
  <span>Условный знак "шлюз" в QGIS (река - отдельный полигональный слой)</span></p>
<p>Как же создать такую красоту? </p>
<p>С этим знаком есть две большие проблемы: отгибающиеся по краям линии,   и треугольник, режущий  шлюз посередине. Первым делом надо решить, как   поступить с самым сложным пунктом - треугольником посередине шлюза, две   стороны которого обведены, а третья - нет; плюс он должен быть   прозрачным. Следуем следующей логике - шлюз всегда   располагается над водой, значит, треугольник не обязательно должен быть   прозрачным, он должен быть цвета воды! Что касается отгибов линий, то   среди предустановленных маркеров есть такие, которые подойдут для их   имитации.</p>
  <p> Приступим. Идём в "Настройки" → "Управление стилями" → "Line" → "Add".   Нам понадобятся 6 линий: 4 маркерных (все маркеры входят в стандартный   набор QGIS) и 2 простых (жмём 5 раз на зелёную кнопочку "+" под окном   слоёв символов ("Symbol layers"), чтобы у нас стало 6 линий). Так они   располагаются послойно сверху вниз: </p>
  <ol>
    <li>Маркерная линия - треугольник, цвета воды, маскирующий нижнее ребро треугольника.</li>
    <li>Маркерная линия - треугольник с чёрной обводкой и заливкой цвета воды.</li>
    <li>Простая белая линия.</li>
    <li>Простая чёрная линия - создаёт чёрную кайму по краям.</li>
    <li>Маркерная линия - закрывающий маркер (повёрнутая на бок галочка) - характерный элемент условных знаков переправ.</li>
    <li>Маркерная линия - открывающий маркер (повёрнутая на бок галочка) - характерный элемент условных знаков переправ.</li>
  </ol>
  <p>Ниже приведены настройки использовавшиеся для его создания. Красным    прямоугольником выделены настройки в которые вносились изменения. Для   уменьшения количества рисунков настройки "Свойств слоя" ("Symbol layer   properties") и "Свойств знака" ("Symbol properties") показаны на одном   рисунке (только для маркерных линий).</p>
  <p> Начнём разбор с самого нижнего слоя нашего условного знака и будем   подниматься выше, пока не достигнем самого верхнего - так будет удобнее   объяснять.    В самом низу (6-й слой) расположим открывающий маркер:
    <ul>
        <li>Выделяем самую нижнюю линию и в поле ("Symbol layer type") "Тип   слоя" (доступны опции: "простая линия", "маркерная линия", "обрамление   линии") выбираем "маркерная линия" ("Marker line"). Чёрная дефолтная   линия превращается в ряд красных кружочков.</li>
      <li>В "Свойствах слоя" ("Symbol layer properties") выбираем "on first vertex only".</li>
      <li>Далее нажимаем кнопку "Изменить" ("Change"). Открывается диалог "Свойства знака" ("Symbol properties").</li>
      <li>Выбираем маркер в виде галочки.</li>
      <li>Выставляем нужный "Цвет обводки" ("Border color") - чёрный (уже стоит по умолчанию).</li>
      <li>"Размер" ("Size") - 2,0 (уже стоит по умолчанию).</li>
      <li>"Угол" ("Angle") - 0,0 (уже стоит по умолчанию).</li>
      <li>"Смещение по X" ("Offset X") - 0,2 (задаём самостоятельно).</li>
    </ul>
  <p>Смещение задаётся для того, чтобы получить эффект загибающихся краёв,   то есть значение подбирается таким образом, чтобы крылья галочки   выходили из концов чёрных обрамляющих линий создаваемого условного   знака. Обратите внимание, что в окошке предварительного просмотра   ("Symbol preview") "Свойств <em><strong>слоя</strong></em>" (не "свойств знака") маркеры на краях линий обрезаются, так что параметры размера и смещения маркера в окне "Свойства <em><strong>знака</strong></em>" задаются на глаз и потом исправляются после применения стиля к конкретной линии.</p>
  <p>Вот так выглядят наши настройки для 6-го слоя:</p>
<p class="ill"><img src="/images/qgis-symbol-gate-03.png" alt="Настройки открывающего маркера (6-й слой)" width="582" height="809" border="0"><span>Настройки открывающего маркера (6-й слой)</span></p>
<p>Аналогично поступаем с закрывающим маркером (5-й слой), только отмечаем   строку "on last vertex only" в "Свойствах слоя", а в "Свойствах знака",   выбрав тот же маркер, что и в прошлый раз, задаём ему те же параметры,   что и предыдущему, корме значения угла - выставляем ему значение 180,00.   Вот так выглядят эти настройки: </p>
<p class="ill">
  <img src="/images/qgis-symbol-gate-04.png" alt="Настройки закрывающего маркера (5-й слой)" width="580" height="786" border="0">
  <span>Настройки закрывающего маркера (5-й слой)</span></p>
<p>Над открывающим и закрывающим маркерами мы расположим два слоя из   простых линий. Чтобы получить эффект обрамления белой линии двумя   чёрными, создадим толстую (толщина задаётся опцией "Толщина линии" ("Pen   width")) чёрную линию и расположим над ней белую линию потоньше.   Параметры для чёрной толстой линии  (4-й слой) показаны  на рисунке   внизу. Обратите внимание, что выбран "Плоский" ("Flat") стиль "Концов"   ("Cap style"). Объяснение будет дано ниже.</p>
<p class="ill">
  <img src="/images/qgis-symbol-gate-05.png" alt="Настройки простой чёрной линии (4-й слой)" width="591" height="501" border="0">
  <span>Настройки простой чёрной линии (4-й слой)</span></p>
<p>Теперь над чёрной толстой линией разместим белую линию потоньше (3-й   слой). Для неё выберем стиль концов "Квадратные" ("Square"). Настройки   показаны на этом рисунке:</p>
<p class="ill"><img src="/images/qgis-symbol-gate-06.png" alt="Настройки простой белой линии (3-й слой)" width="591" height="501" border="0">
<span>Настройки простой белой линии (3-й слой)</span></p>
<p>Здесь используется один нюанс, который полезно запомнить: в новой символике<strong> линия не обрывается на последнем узле</strong>   -  после конечного узла идёт этот самый (пусть и совсем крохотный)   "конец",  который бывает трёх видов: квадратный, плоский и круглый. "Плоский" - <strong>короче</strong> остальных.    Мы используем более короткий "конец" для чёрной линии внизу и более    длинный - для белой линии наверху, чтобы чёрная линия не образовывала   прямоугольник вокруг белой. Вот так будет выглядеть наш условный знак,   если для чёрной линии в 4-м слое тоже выбрать квадратный конец:</p>
<p class="ill"><img src="/images/qgis-symbol-gate-02.png" alt="Для чёрной линии в 4-ом слое выбраны квадратные концы" width="119" height="70" border="0">
<span>Для чёрной линии в 4-ом слое выбраны квадратные концы</span></p>
<p>Теперь создадим треугольную "прорезь" в середине нашего условного знака.   Для этого нам понадобится 2 практически одинаковых маркерных слоя. Один   (нижний) будет создавать треугольную "прорезь", а второй - маскировать   нижнюю грань первого. Настройки для нижнего слоя (2-й слой) представлены   на рисунке внизу. Для маркера выбрано положение "on central point" и   "Смещение" ("Line offset") "-0,30" (чтобы нижняя грань треугольника была   на одном уровне с нижним краем простой чёрной линии 4-го слоя). Для   обводки треугольника выбран чёрный цвет, а цвет заливки соответствует   используемому цвету воды (этот цвет используется для водных объектов в   проекте по составлению условных знаков).</p>
<p class="ill"><img src="/images/qgis-symbol-gate-09.png" alt="Настройки маркерной линии (2-й слой)" width="578" height="787" border="0">
<span>Настройки маркерной линии (2-й слой)</span></p>
<p>Наконец, в самом верхнем слое (1-й слой) выбираем маркерную линию,   помещаем маркер в центральную точку знака. Отличия от предыдущего слоя   заключаются в том, что на этот раз цвет обводки треугольника совпадает с   цветом заливки (цвет водного объекта); треугольник имеет чуть меньший   размер, чтобы не перекрывать треугольник из предыдущего слоя там где не   надо и не вылезать за пределы нижней кромки условного знака; "смещение"   не выставляется (то есть данный треугольник оказывается чуть ниже   предыдущего):</p>
<p class="ill"><img src="/images/qgis-symbol-gate-08.png" alt="Настройки маркерной линии (2-й слой)" width="579" height="795" border="0">
<span>Настройки маркерной линии (первый слой)</span></p>
<p>Теперь сохраняем условный знак, проверяем как он выглядит в деле, и, по   результатам, корректируем настройки для маркерных линий в 5-ом и 6-ом   слоях.    На этом конкретном примере была продемонстрирована мощь редактора   условных знаков QGIS "новая символика". Используя несколько нехитрых   приёмов, описанных выше можно создавать очень сложные и красивые   условные знаки для ваших проектов.
  <!-- обсуждение на форуме, цифра изменяется при публикации статьи -->   
</p>
<p class="discuss"><span><!--#include virtual="/scripts/forum-comments-num.php?i=7784"--></span></p>
<!-- ссылки -->
<div class="links">
	<h2>Ссылки по теме</h2>
		<ul>
			<li><a href="/docs/qgis/index.html">Руководство пользователя QGIS </a><a href="http://lpdaac.usgs.gov/landdaac/tools/modis/about.asp" target="_blank" class="external"></a></li>
			</ul>
</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 21.02.2011<br>
Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=7619" target="_blank">Юрий Рябов </a></span></p>
<!--#include virtual="/inc/footer2.php" -->
