<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Создание и редактирование векторных слоев средствами QGIS</title>
<!--#include virtual="/inc/header2.txt" -->
<!--Contents start-->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<h1>Создание и  редактирование векторных слоев средствами QGIS</h1>
            <p class="ann">Описание инструментария QGIS для работы с векторными данными</p>
            <p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=2505"--></span></p>
            <p>QGIS – динамично развивающаяся свободная пользовательская ГИС, представляющая довольно развитый инструментарий для работы с любой пространственной информацией. Мы уже разбирали <a href="georef-qgis.html">вопросы привязки</a> растровых данных с помощью QGIS. В этой статье мы остановимся на работе с векторными объектами. Данная статья иллюстрирована примерами англоязычного интерфейса, однако вы легко можете использовать и русифицированный.</p>
            <p><strong>Оглавление</strong></p>
            <ol>
                  <li><a href="#01">Создание векторного слоя</a></li>
                  <li><a href="#02">Настройка параметров редактирования векторного слоя</a></li>
                  <li><a href="#03">Топологическое редактирование и прилипание нескольких слоев</a></li>
                  <li><a href="#04">Работа с точечными слоями</a></li>
                  <li><a href="#05">Работа с линейными слоями</a></li>
                  <li><a href="#06">Работа с полигональными слоями</a></li>
            </ol>


<!-- Первый раздел -->
            <p><strong><img src="/images/1.gif" alt="1" width="33" height="41" align="left" /><a name="01" id="01"></a>Создание векторного слоя</strong></p>
	    <p>Для создания векторного слоя выберем New Vector Layer в меню Layer или воспользуемся кнопкой  <img src="../images/qgis-vector-41.gif" alt="qgis-41" width="32" height="32" />, по умолчанию расположенной на панели инструментов. В открывшемся диалоговом окне зададим необходимые параметры.</p>
	    <p align="center"><img src="../images/qgis-vector-01.gif" alt="qgis-01" width="416" height="463" /><br />
	    Создание нового векторного слоя</p>
	    <p>Во-первых, это формат файла, в котором  будут храниться данные нового слоя. В текущей версии QGIS (0.11.0 – Metis) таким  форматом, причем единственным, является ESRI Shapefile. Во-вторых, тип создаваемого слоя, здесь  всё стандартно – точечный (Point), линейный (Line)  или полигональный (Polygon). Также необходимо определить минимум  одно поле таблицы атрибутов. В поле Name задается  его имя, а в поле Type  выбирается тип –  действительное число (Real), целое число (Integer)  или строка (String). Для добавления и удаления полей служат  кнопки  <img src="../images/qgis-vector-02.gif" alt="qgis-02" width="32" height="32" />и <img src="../images/qgis-vector-03.gif" alt="qgis-03" width="32" height="32" />.  После того, как все необходимые параметры были  заданы, нажимаем кнопку OK, задаем имя папки, в которой будут храниться наши  данные, и переходим к редактированию только что созданного слоя.</p>
	    <p>Отметим, что встроенный  в QGIS редактор таблиц атрибутов не позволяет добавлять  новые и удалять имеющиеся поля созданного ранее shape-файла,  однако это ограничение можно обойти, установив <a href="qgis-attr.html">специальное расширение</a>. </p>
	    <p><strong><img src="/images/2.gif" alt="2" width="33" height="41" align="left" /><a name="02" id="02"></a>Настройка параметров редактирования векторного слоя</strong></p>
	    <p>Для настройки параметров редактирования выберем Options в меню Settings и перейдем на вкладку Digitizing. В открывшемся диалоговом окне видим три группы параметров: Rubberband, Snapping и Vertex markers.</p>
	    <p align="center"><img src="../images/qgis-vector-10.gif" alt="qgis-10" width="643" height="603" /></p>
	    <p align="center">Настройка параметров редактирования</p>
	    <p>Параметры Line width и Line color группы Rubberband определяют толщину и цвет линии,  используемой при рисовании линейных и полигональных объектов.</p>
	    <p>Параметр Marker style группы Vertex markers определяет стиль маркера вершины - Semi transparent circle (полупрозрачный   круг) или Cross  (перекрестие).</p>
	    <p>Группа параметров Snapping отвечает за настройку прилипания –  автоматического совмещения узлов объектов при редактировании. Default snap mode – режим прилипания по умолчанию. Можно  задать один из трех режимов: to  vertex (к вершине), to segment (к сегменту),  to vertex and segment (к вершине и   сегменту). Default snapping tolerance in  layer units – порог прилипания. Режим и порог прилипания  работают следующим образом: при подведении курсора мыши на определенное  расстояние (порог прилипания) от  сегмента или вершины (в зависимости от режима прилипания),  рисуемая линия автоматически продолжается до касания с ближайшим сегментом или  вершиной. На рисунке представлен пример использования различных режимов прилипания.  </p>
	    <p align="center"><img src="../images/qgis-vector-11.gif" alt="qgis-11" width="336" height="227" /></p>
	    <p align="center">Режимы прилипания (большой кружок – вершины существующей линии, синяя,  маленький – последняя вершина создаваемой линии, красная): а) к сегменту, б) к  вершине</p>
	    <p>Search radius for vertex edits in layer units – радиус поиска ближайших вершин,  используется при перемещении, удалении или добавлении вершин. Если в круг с  центром в месте щелчка мышью и радиусом Search radius for vertex edits in layer units попадает хотя бы одна вершина, то  выбирается ближайшая из них. При нулевом значении параметра Search radius for vertex edits in layer units или в случае если в указанный круг не  попадает ни одной вершины появляется сообщение о том, что не задан порог  прилипания, хотя порог прилипания здесь непричем. Порог прилипания  и радиус поиска ближайших вершин задаются в единицах измерения слоя.</p>
	    <p align="center"><img src="../images/qgis-vector-12.gif" alt="qgis-12" width="523" height="326" /></p>
	    <p align="center">Сообщение об отсутствии порога прилипания</p>
	    <p>Для сохранения изменений жмем OK. Данные настройки будут применяться ко  всем слоям новых проектов, создаваемых в QGIS.</p>
	    <p><strong><img src="/images/3.gif" alt="2" width="33" height="41" align="left" /><a name="03" id="03"></a>Топологическое редактирование и прилипание нескольких слоев</strong></p>
	    <p>Кроме только что рассмотренных настроек, в  QGIS имеются дополнительные возможности,  позволяющие, помимо всего прочего, настроить параметры прилипания в отдельности  для каждого слоя. Рассмотрим дополнительные настройки редактирования и параметры прилипания. </p>
	    <p>В меню Settings выбираем Project Properties и переходим на вкладку General. Нас будет интересовать группа  параметров Digitizing.</p>
	    <p align="center"><img src="../images/qgis-vector-13.gif" alt="qgis-13" width="477" height="538" /></p>
	    <p align="center">Настройка параметров проекта</p>
	    <p>Enable topological editing – включение режима топологического  редактирования. Если топологическое редактирование включено, то при перемещении  вершины, принадлежащей одновременно нескольким объектам (полигонам   или линиям), их геометрия изменится в соответствии с новым  положением перемещенной вершины. Если же топологическое редактирование  отключено, то изменения коснутся только одного объекта.</p>
	    <p align="center"><img src="../images/qgis-vector-14.gif" alt="qgis-14" width="600" height="414" /></p>
	    <p align="center">Включенный  (а) и выключенный (б)  режим топологического редактирования</p>
	    <p>Avoid intersections of new polygons – предотвращение пересечения новых  полигонов. Если активировать этот пункт, то при создании нового полигона в  случае наложения его на уже существующий, часть нового полигона, попадающая в  наложение, будет исключена.</p>
	    <p align="center"><img src="../images/qgis-vector-15.gif" alt="qgis-15" width="600" height="171" /> </p>
	    <p align="center">Пример предотвращения пересечения полигонов</p>
	    <p>Нажимаем кнопку Snapping options и переходим к настройке прилипания для отдельных  слоев.</p>
	    <p align="center"><img src="../images/qgis-vector-16.gif" alt="qgis-16" width="668" height="336" /></p>
	    <p align="center"> Настройка прилипания для отдельных слоев</p>
	    <p>В столбце Layer расположены слои текущего проекта. Если  слой отмечен крестиком, то настройки прилипания для него включены. В столбце Mode настраивается режим прилипания для  каждого слоя, а в столбце Tolerance  – порог расстояния прилипания.</p>
	    <p>ВАЖНО!!! Если нажать OK в окне Snapping options, а затем Apply в окне Project Properties, то настройки Default snap mode и Default snapping tolerance in layer units, которые мы указывали до этого,  утрачивают свою силу для текущего проекта навсегда. И поэтому каждый раз,  добавляя новый слой, вам необходимо через Snapping options указывать для него настройки прилипания.</p>
	    <p>На этом процесс настройки параметров редактирования  векторного слоя можно считать оконченным.</p>
	    <p><strong><img src="/images/4.gif" alt="4" width="33" height="41" align="left" /><a name="04" id="04"></a>Работа с точечными слоями</strong></p>
	    <p>Прежде чем приступать к редактированию  любого векторного слоя убедитесь в том, что у вас включена панель инструментов Digitizing. Если она отсутствует, то ее следует  включить: в меню View  выберете Toolbar Visibility и  активируйте панель Digitizing.  Добавьте в проект имеющийся или создайте новый точеный слой, следуя  вышеприведенным инструкциям.  После этого выберите его, щелкнув на нем в легенде, иконка Toggle editing станет активной: <img src="../images/qgis-vector-17.gif" alt="qgis-17" width="32" height="31" />.  Для того чтобы начать редактирование, щелкните на ней (в QGIS по умолчанию слой открыт только для чтения).  Панель инструментов Digitizing для точечного слоя будет  выглядеть следующим образом:</p>
	    <p align="center"><img src="../images/qgis-vector-18.gif" alt="qgis-18" width="546" height="44" /></p>
	    <p align="center">Панель  инструментов Digitizing точечного слоя</p>
	    <p>Щелкните на иконке Capture Point:  <img src="../images/qgis-vector-40.gif" alt="qgis-40" width="32" height="31" />для  того чтобы добавить новый точечный объект. После этого левой кнопкой мыши  щелкните в то место, где бы вы хотели его расположить. В появившемся окне  укажите значения атрибутов. На этом процедура добавления нового  точечного объекта закончена.</p>
	    <p align="center"><img src="../images/qgis-vector-19.gif" alt="qgis-19" width="475" height="387" /></p>
	    <p align="center"> Окно ввода значений атрибутов</p>
	    <p>Попробуйте добавить ещё один точечный  объект. Если после щелчка на новом месте объект не появляется, убедитесь в том,  что у вас не включен режим прилипания к вершине. В этом случае новый точечный  объект может прилипнуть к уже существующему и слиться с ним. В таком случае  следует просто отключить прилипание. </p>
	    <p>Инструмент Move Feature: <img src="../images/qgis-vector-20.gif" alt="qgis-20" width="31" height="30" />позволяет перемещать точечные объекты.  Этот инструмент работает следующим образом: нажимаем на иконку <img src="../images/qgis-vector-20.gif" alt="qgis-20" width="31" height="30" />,  после чего щелкаем рядом с объектом, который мы хотим переместить. В  соответствии со значением Search  radius for vertex edits in layer units выбирается ближайший точечный объект,  при этом он становится выделенным. Не отпуская левой клавиши мыши, переместим  наш объект  на новое место и отпустим  клавишу – объект будет перемещен.</p>
	    <p>С точечным объектом можно производить  простейшие операции, такие как удаление: <img src="../images/qgis-vector-21.gif" alt="qgis-21" width="32" height="31" />, вырезание: <img src="../images/qgis-vector-22.gif" alt="qgis-22" width="24" height="24" />, копирование: <img src="../images/qgis-vector-23.gif" alt="qgis-23" width="22" height="22" /> и  вставку: <img src="../images/qgis-vector-24.gif" alt="qgis-24" width="24" height="24" />, причем вставлять вырезанный или  скопированный объект можно как на текущий слой, так и на любой другой слой  такого же типа. Но прежде чем осуществлять эти операции, нужный объект следует  выделить. Для этого существует инструмент Select Features:  <img src="../images/qgis-vector-25.gif" alt="qgis-25" width="32" height="31" />панели инструментов Attributes.</p>
	    <p>Кроме того, в QGIS есть возможность редактирования атрибутов.  Щелкните на иконке Open  Table: <img src="../images/qgis-vector-26.gif" alt="qgis-26" width="22" height="22" /> панели инструментов Attributes. Перед вами откроется диалоговое окно.</p>
	    <p align="center"><img src="../images/qgis-vector-27.gif" alt="qgis-27" width="569" height="461" /></p>
	    <p align="center">Окно редактирования атрибутов</p>
	    <p>Для начала редактирования нажмите кнопку Start editing, отредактируйте атрибуты и нажмите  кнопку Stop editing, после чего подтвердите или откажитесь  от сохранения внесенных изменений. Как уже отмечалось выше, пока операции по  удалению имеющихся и добавлению новых полей в таблицу атрибутов shape-файла в QGIS реализованы только с помощью <a href="qgis-attr.html">специального расширения</a>.</p>
	    <p><strong><img src="/images/5.gif" alt="5" width="33" height="41" align="left" /><a name="05" id="05"></a>Работа с линейными слоями</strong></p>
	    <p>Добавьте в проект имеющийся или создайте  новый линейный слой,  следуя вышеприведенным инструкциям. После этого выберите его, щелкнув на нем в  легенде. Для того чтобы начать редактирование, щелкните на иконке Toggle editing: <img src="../images/qgis-vector-17.gif" alt="qgis-17" width="32" height="31" />,  панель инструментов будет выглядеть следующим образом:</p>
	    <p align="center"><img src="../images/qgis-vector-28.gif" alt="qgis-28" width="546" height="44" /></p>
	    <p align="center">Панель инструментов Digitizing линейного  слоя</p>
	    <p>Чтобы добавить линейный объект, щелкните  на иконке Capture Line:  <img src="../images/qgis-vector-29.gif" alt="qgis-29" width="32" height="31" />.  После чего последовательно указывая вершины, используя левую клавишу мыши,  нарисуйте линейный объект. Точка, завершающая ввод линейного объекта,  указывается щелчком правой клавиши мыши. В появившемся окне укажите значения  атрибутов. На этом процедура добавления нового линейного объекта закончена.</p>
	    <p>Работа инструментов удаления, вырезки,  копирования и вставки линейных объектов аналогична работе этих же инструментов  в случае точечных объектов.</p>
	    <p>Инструмент Move Feature:<img src="../images/qgis-vector-20.gif" alt="qgis-20" width="31" height="30" />позволяет перемещать кроме точечных также  и линейные объекты. Этот инструмент работает следующим образом: нажимаем на  иконку<img src="../images/qgis-vector-20.gif" alt="qgis-20" width="31" height="30" />,  после чего щелкаем рядом с объектом, который мы хотим переместить. В  соответствии со значением Search  radius for vertex edits in layer units выбирается ближайшая вершина, а линия,  которой принадлежит эта вершина, становится выделенной. Не отпуская левой  клавиши мыши, переместим выделенную линию на новое место и отпустим клавишу –  объект будет перемещен. </p>
	    <p>Инструмент Move Vertex: <img src="../images/qgis-vector-30.gif" alt="qgis-30" width="32" height="31" /> позволяет перемещать вершины линейного  объекта. Этот инструмент работает следующим образом: нажимаем на иконку<img src="../images/qgis-vector-30.gif" alt="qgis-30" width="32" height="31" />,  после чего щелкаем рядом с вершиной, которую хотим переместить. В соответствии  со значением Search  radius for vertex edits in layer units выбирается ближайшая вершина. Не  отпуская левой клавиши мыши, переместим выбранную вершину на нужное место и  отпустим клавишу. Перемещение вершины будет происходить в соответствии с  настройками прилипания для данного слоя (не допускайте   прилипания вершины к другой вершине одного и того же объекта). </p>
	    <p>Инструмент Add Vertex: <img src="../images/qgis-vector-31.gif" alt="qgis-31" width="32" height="31" /> позволяет добавлять новые вершины к  линейному объекту. Этот инструмент работает следующим образом: нажимаем на  иконку <img src="../images/qgis-vector-31.gif" alt="qgis-31" width="32" height="31" />,  после чего щелкаем в то место, куда мы хотим добавить новую вершину. В  соответствии с параметром Search  radius for vertex edits in layer units выбирается отрезок ломаной (подсвечивается), на который будет добавлена новая  вершина. Не отпуская левой клавиши мыши, переместим добавленную (пока виртуально) вершину на нужное место и отпустим  клавишу либо отпустим её сразу после нажатия, если нужным местом является место  щелчка. Если расстояние от места, на котором была отпущена левая клавиша мыши,  до ближайшего сегмента или вершины (в зависимости от   режима прилипания) меньше порога прилипания, то новая вершина  добавится либо к сегменту, либо к вершине (подобных   ситуаций прилипания к вершинам следует избегать), в противном  случае новая вершина добавится непосредственно в то место, где была отпущена  левая клавиша мыши. </p>
	    <p>Инструмент Delete Vertex:  <img src="../images/qgis-vector-32.gif" alt="qgis-32" width="32" height="31" /> позволяет удалять вершины линейных  объектов. Этот инструмент работаем следующим образом: нажимаем на иконку<img src="../images/qgis-vector-32.gif" alt="qgis-32" width="32" height="31" />,  после чего щелкаем рядом с вершиной, которую мы хотим удалить. В соответствии  со значением Search  radius for vertex edits in layer units выбирается ближайшая вершина и отмечается  перекрестием. При отпускании левой клавиши мыши отмеченная вершина удалится.</p>
	    <p>И, наконец, рассмотрим последний  инструмент, использующийся при редактировании линейных слоев. Инструмент Split Features:  <img src="../images/qgis-vector-33.gif" alt="qgis-33" width="32" height="31" /> позволяет разделять линейные объекты на  несколько отдельных объектов. Очевидно, что разделить объект на несколько  частей можно либо в точках сегмента, либо в вершинах. В первом случае отключаем  прилипание к вершинам, нажимаем на иконку <img src="../images/qgis-vector-33.gif" alt="qgis-33" width="32" height="31" /> и проводим секущую через точку сегмента, в  которой мы хотим разделить объект. Во втором случае, наоборот, включаем  прилипание к вершинам и проводим секущую через вершину, в которой следует  разделить объект. Отметим, что таким образом можно разделять одновременно  несколько объектов.</p>
	    <p>Точно также как и в случае с точечным  слоем, в линейном слое можно осуществлять редактирование атрибутов, используя инструмент  Open Table: <img src="../images/qgis-vector-26.gif" alt="qgis-26" width="22" height="22" />.</p>
	    <p><strong><img src="/images/6.gif" alt="6" width="33" height="41" align="left" /><a name="06" id="06"></a>Работа с полигональными слоями</strong></p>
	    <p>Добавьте в проект имеющийся или создайте  новый полигональный слой, следуя вышеприведенным инструкциям. После этого выберите его, щелкнув на  нем в легенде. Для того чтобы начать редактирование, щелкните на иконке Toggle editing: <img src="../images/qgis-vector-17.gif" alt="qgis-17" width="32" height="31" />,  панель инструментов будет выглядеть следующим образом:</p>
	    <p align="center"><img src="../images/qgis-vector-34.gif" alt="qgis-34" width="548" height="47" /></p>
	    <p align="center"> Панель инструментов Digitizing полигонального  слоя</p>
	    <p>Принцип работы с инструментами полигонального  слоя аналогичен работе с инструментами линейного слоя, поскольку полигон есть  не что иное, как замкнутая линия. Однако есть инструменты, которые при работе с  линейным слоем были недоступны. Вот на них и остановимся.</p>
	    <p>Чтобы добавить полигон, щелкните на  иконке Capture Polygon: <img src="../images/qgis-vector-35.gif" alt="qgis-35" width="32" height="31" />.  После чего последовательно указывая вершины, используя левую клавишу мыши,  нарисуйте полигональный объект. Точка, завершающая ввод полигона, указывается  щелчком правой клавиши мыши.  В  появившемся окне укажите значения атрибутов. На этом процедура добавления  нового полигонального объекта закончена.</p>
	    <p>Рассмотрим новые инструменты, которые  были недоступны при редактировании линейного слоя. Инструмент Add Ring:  <img src="../images/qgis-vector-36.gif" alt="qgis-36" width="32" height="31" /> позволяет создавать полигоны в виде  кольца. Для этого сначала нарисуйте полигон, затем нажмите на иконку <img src="../images/qgis-vector-36.gif" alt="qgis-36" width="32" height="31" /> и нарисуйте полигон внутри уже имеющегося.  Область последнего полигона будет исключена из имеющегося, и в результате мы  получим полигон в форме кольца.</p>
	    <p align="center"><img src="../images/qgis-vector-37.gif" alt="qgis-37" width="326" height="274" /></p>
	    <p align="center">Полигон в форме кольца</p>
	    <p>Инструмент Add Island:  <img src="../images/qgis-vector-38.gif" alt="qgis-38" width="32" height="31" /> позволяет добавлять к полигонам в форме  колец острова. Для того, чтобы добавить остров, выделите полигон в форме  кольца, используя инструмент Select  Features: <img src="../images/qgis-vector-25.gif" alt="qgis-25" width="32" height="31" />,  затем нажмите на иконку  <img src="../images/qgis-vector-38.gif" alt="qgis-38" width="32" height="31" /> и нарисуйте внутри кольца острова.</p>
	    <p align="center"><img src="../images/qgis-vector-39.gif" alt="qgis-39" width="298" height="208" /></p>
	    <p align="center">Полигон в форме кольца с островом</p>
	    <p>Точно также как и в случае с точечным и  линейным слоем, в полигональном слое можно осуществлять редактирование  атрибутов, используя инструмент Open Table: <img src="../images/qgis-vector-26.gif" alt="qgis-26" width="22" height="22" />.</p>
	    <p class="discuss">
			<span><!--#include virtual="/scripts/forum-comments-num.php?i=2505"--></span>
			</p>
		<div class="links">
		<h2>Ссылки по теме</h2>
		<ul>
               <li><a href="georef-qgis.html">Географическая привязка данных с помощью QGIS</a></li>
			   <li><a href="qgis-attr.html">Обход ограничения на работу с полями атрибутивных таблиц shape-файлов в QGIS</a></li>
		</ul>
		</div>
            <!--#include virtual="/scripts/date.php" -->
<!--Contents end-->
<p class="status"><span>Дата создания: 27.09.2008
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=6901" target="_blank">Денис Рыков</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
