<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Импорт текстовых табличных данных с координатной привязкой в shape-файл</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Импорт  табличных данных с координатной привязкой в shape-файл (ArcGIS) </h1>
<p class="ann">XLS -&gt; TXT(CSV) -&gt; SHP Выполнение операции с помощью ArcGIS</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=721"--></span></p>
<p>Несмотря на то, что существует много методов получения данных с GPS непосредственно в ArcGIS, часто, в связи с организационными причинами или отсутствия специального кабеля соединяющего GPS и компьютер, данные переносятся через табличный или текстовый файл. Рекомендации приведенные ниже, надеюсь, позволят избежать многих типичных ошибок и затруднений.</p>
<p>Для экспериментов можно воспользоваться <a href="/other/txt2points-ag.zip">этим набором данных</a>. </p>
            <h2>1. Требования к исходным данным</strong></h2>
            <p>Перед началом работы убедитесь, что: </p>
            <ol>
            <li><strong>Формат представления координат:</strong> если вы используете для координат формат представления данных <strong>DD MM SS.SSSS</strong> (например 50° 50’ 21.2132’’), вам необходимо перевести их в формат <strong>DD. DDDDDDD</strong> (например предыдущему примеру будет соответствовать 50.839226) (<a href="/qa/dms2dd.html">подробнее о переводе координат из одного формата в другой</a>).</li>
            <li><strong>Название полей:</strong> колонкам желательно давать короткое название на английском языке или английскими символами, колонки с координатами могут идти в любой последовательности и называться также по-любому. Названия не должны содержать таких знаков как тире, пробел, скобки, знак номера (№), запятая. Названия полей также не должны состоять из нескольких слов. </li>
            <li><strong>Универсальный идентификатор:</strong> если вы собираетесь затем привязывать к этой таблице другую, записи обеих таблиц должны иметь универсальные идентификаторы, посредством которых будет осуществляться связывание (универсальные идентификаторы можно будет добавить позже).</li>
            <li><strong>Разделитель целой и дробной части </strong>координат должен быть таким же, как и в настройках операционной системы (по умолчанию – запятая, лучше сразу сменить на точку). <a href="/qa/txt2points.html">Подробнее о настройке нужного разделителя </a></li></ol>
              <h2>2. Сохранение из Excel</h2>
              <p>Для переноса данных из таблицы Excel в ArcGIS, вам необходимо сохранить их в текстовом формате с разделителями – табуляциями в Excel - <strong> Text (Tab delimited) </strong> или<strong></strong><strong> DBF 3 (dBase III)</strong>. </p>
              </p>
              <p align="center"><img src="/images/txt2points-ag-01.gif" width="668" height="79" border="1" /></p>
              <h2>3. Загрузка таблицы в ArcGIS</h2>
              <p>Полученный на первом этапе файл нужно добавить в ArcMap (<strong>File\Add Data…</strong>).</p>
              <p>После добавления вашего файла, если оно прошло нормально и никаких сообщений об ошибках не было, файл добавится в раздел <strong> Source </strong>фрейма данных. В окне карты никаких данных пока не появится, так как вы загрузили таблицу и программа пока не знает, что в ней содержатся данные о координатах (в принципе вы можете загружать и любые другие таблицы, не обязательно с координатами). В этом разделе данные нельзя менять местами, так как он показывает только информацию об источнике данных (порядок визуализации меняется в разделе <strong> Display</strong>). Подробнее </p>
              <p align="center"><img src="/images/txt2points-ag-02.gif" width="268" height="52" border="1" /></p>
              <p>В зависимости от того, загружали вы таблицу в формате DBF или Text, иконка слева от названия файла таблицы будет разная. Отличие DBF от Text так же заключается в том, что вы не сможете редактировать данные в формате Text в ArcGIS, пока не переведете вашу текстовую таблицу в шейп-файл или DBF. </p>
              <p align="center"><img src="/images/txt2points-ag-03.gif" width="266" height="196" border="1" /></p>
              <h2>4. Просмотр таблицы и изменение параметров отображения данных</h2>
              <p>Загруженную таблицу можно просмотреть, щелкнув по ней правой кнопкой мыши и выбрав <strong>Open</strong> (Открыть). Если ваши координаты содержали много знаков после запятой, а точнее более 6, то остальные разряды показаны не будут, хотя в таблице они останутся. Чтобы они тоже отображались нужно дважды щелкнуть на названии таблицы и выбрать закладку <strong>Fields</strong> (она же открывается по умолчанию). Где напротив каждого поля находится кнопка <strong>...</strong>, нажав на которую можно изменить представление данных (<strong>но не сами данные!</strong>).</p>
              <p align="center"><img src="/images/txt2points-ag-04.gif" width="590" height="410" border="1" /></p>
              <p>Нажав на нее, можно выбрать вместе 6 разрядов после запятой (точки), выбрать большую цифру и в таблице покажутся остальные импортированные данные.</p>
              <p align="center"><img src="/images/txt2points-ag-05.gif" width="354" height="371" border="1" /></p>
              <p align="center">&nbsp;</p>
              <h2>5. Преобразование таблицы в виртуальную точечную тему</h2>
              <p>Для того, чтобы загруженная таблица содержащая координаты была преобразована в точечную тему, то есть приобрела помимо атрибутивной, еще и пространственную информацию необходимо выполнить операцию <strong> Display </strong><strong> XY </strong><strong> Data …</strong> щелкнув правой кнопкой мыши на загруженной таблице.</p>
              <p>В появившемся окне нужно выбрать названия полей соответствующих соответственно долгое (X) и широте (Y), а так же систему координат импортируемых данных.</p>
              <p>После этой операции, в закладке Source у выбранной таблицы появится еще один пункт имеющий название <strong> Table1 Events </strong>(где вместо Table1 будет стоять название вашей таблицы). </p>
              <p align="center"><img src="/images/txt2points-ag-06.gif" width="264" height="184" border="1" /></p>
              <p>А на переключившись на закладку Display (где отображаются пространственные данные), мы увидим появившуюся тему с одноименным названием и объекты на карте. </p>
              <p align="center"><img src="/images/txt2points-ag-07.gif" width="266" height="159" border="1" /></p>
              <h2>6. Сохранение точечной темы в новый шейп-файл.</h2>
              <p>Однако, полученная тема является виртуальной и сохраняется только в проекте ArcGIS (*.mxd), чтобы преобразовать ее в отдельный шейп-файл, необходимо провести операцию экспорта. Для этого, правой кнопкой щелкаем на Table1 Events и выбираем <strong>Data\ Export Data…</strong> и сохраняем готовый шейп-файл в нужную нам папку.</p>
              <p align="center"><img src="/images/txt2points-ag-08.gif" width="549" height="443" border="1" /></p>
              <p>Если у Вас есть замечания, предложения или иные пути решения обсуждаемых проблем - будем рады добавить недостающую информацию к этой статье. Вы можете отправить свои комментарии используя форму или адрес электронной почты приведенные ниже.</p>
              <p class="discuss">
			  	<span><!--#include virtual="/scripts/forum-comments-num.php?i=721"--></span>
			</p>
			<div class="links">
			   <h2>Ссылки по теме</h2>
			   <ul>
			               <li><a href="/qa/txt2points.html">Импорт  табличных данных с координатной привязкой в shape-файл (Arcview GIS)</a></li>
			   </ul>
			</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 04.12.2005
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=2" target="_blank">Максим Дубинин</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
