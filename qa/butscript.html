<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Создание кнопки и назначение ей скрипта в Arcview 3.x</title>
<!--#include virtual="/inc/header2.txt" -->
<!--Contents start-->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<h1>Создание кнопки и назначение ей скрипта в Arcview 3.x</h1>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=4069"--></span></p>
          <p>Для того, чтобы создать кнопку и подключить к ней скрипт
            нужно выполнить следующие операции:</p>
          <p>1. Понять в какую группу документов должна быть подключена
            эта кнопка: Views, Tables, Charts, Layouts, Scripts или какую-то другую.          </p>
          <p>2. Дважды щелкнуть мышкой на панели инструментов Arcview
            (не важно в какой группе вы в это время находитесь). Должно открыться
            окно <b>Customize</b><img src="../images/butscript1.jpg" width="382" height="275" align="right" />          </p>
          <p>3. Затем выбрать в поле <b>Type</b> тип документа (View,
            Table, Layout и т.д.) в котором будет работать скрипт, в этом поле
            будут перечислены все доступные на данный момент типы. Если вы добавили
            кнопку в тип документа Script, то в панели кнопок View (Вида) она
            не появится.          </p>
          <p>*если некий тип документа создается
            включением определенного расширения ( то есть по умолчанию такого
            типа документов в Arcview нет), а вам надо добавить в нее кнопку,
            то, для того, чтобы это сделать, необходимо сначала включить расширение
            добавляющее данный тип документа.</p>
          <p>4. В поле <b>Category </b>выберите нужный тип кнопки.
            Кнопки бывают 2-х типов:<br />
          </p>
          <ul>
            <li>простые (Buttons)            </li>
            <li>инструменты (Tools)          </li>
          </ul>
          <p>Отличие их состоит в том, что простая кнопка после нажатия
            немедленно выполняет какую-либо операцию, например открывает окно
            &quot;Добавить тему&quot;, а инструмент переключает действие в особый
            режим, а само действие выполняется только после использования это
            инструмента, например инструмент Identify. Допустим вам нужно добавить
            простую кнопку. Следовательно выбираем категорию <b>Buttons</b>.</p>
          <p>5. Определяем место где будет находиться кнопка, для
            этого перемещаем черную рамку которая сначала оконтуривает первую
            кнопку туда где мы хотим вставить новую кнопку, то есть на существующую
            кнопку перед ней и нажимаем кнопку <b>New</b>. Появляется новая кнопка.<img src="../images/butscript2.jpg" width="381" height="298" align="right" /></p>
          <p>6. Добавляем <a href="addscript.html">связанный с этой
            кнопкой скрипт</a>. Скрипт перед тем как быть присоединен к кнопке
            должен быть подгружен в проект и обязательно скомпилирован. Для этого
            дважды щелкаем на поле <b>Click </b>и выбираем из появившегося окна
            менеджера скриптов (Sript manager) нужный скрипт.</p>
          <p>На этом процесс подключения кнопки можно считать завершенным.
            Описание других полей заполнение которых не обязательно:</p>
          <ul>
            <li><b>Disabled</b> значением этого поле может быть только
              false\true, обычно используется в совокупности со скриптом подключаемым
              через поле Update, блокирование кнопки осуществляется если не выполнено
              некоторое условие (например, нет тем в TOC)</li>
            <li><b>Help</b> Строка помощи для кнопки, вводится в
              виде tool tip//help string, где tool tip - то что будет отображаться
              во всплывающем, при наведении на кнопку окошке, а help string -
              то что будет отображаться (возможно более развернуто) внизу экрана
              в строке статуса. Два параметра разделяются обязательным знаком
              &quot;//&quot; </li>
            <li><b>HelpTopic</b> Название раздела в файле помощи
              Arcview</li>
            <li><b>Icon</b> Используемая для кнопки иконка, при двойном
              щелчке на этом поле появляется окно Менеждера иконок (Icon Manager),
              которое облегчает процесс выбора существующей, подгрузки новой иконки</li>
            <li><b>Invisible</b> Включение/отключение режима невидимости
              кнопки</li>
            <li><b>Tag</b> Дополнительная текстовая строка к которой
              можно получить доступ через запрос <b>ObjectTag</b></li>
            <li><b>Update</b> Скрипт выполняемый при любом изменении
              в активном окне проекта, обычно используется для проверки необходимого
              условия для включения\выключения (см.Disabled) кнопки. </li>
          </ul>
          <p>Соответственно, если ваша цель - сделать так, чтобы
            у вас в проекте была такая же кнопка как в проекте товарища, но это
            невозможно сделать путем загрузки соответствующего расширения, то
            проще всего добавить кнопку так как указано выше и присоединить к
            ней скрипт добытый путем указанным <a href="addscript.html">здесь</a>.</p>
          <p>Существую также экзотические случаи, когда создается
            новый тип документа аналогичный существующему, например расширением
            <a href="../programs/avenue/auto_til.zip">Automatic Tiled Layouts</a>
            создается группа <b>Tiles </b>полностью аналогичная группе <b>Layouts</b>,
            но подключаемые к группе Layouts расширения не будут автоматически
            подключаться к группе <b>Tiles</b>, что может быть очень неудобно,
            например тем, что нельзя воспользоваться таким удобным расширением
            как <b>Graticules and Grids</b>, которое работает только в <b>Layouts</b>,
            но так как эти группы полностью аналогичны, то обмануть расширение
            можно способом указанным выше, скопировав кнопку и все ее параметры
            в группу <b>Tiles</b> из группы <b>Layouts</b>.</p>
<p class="discuss"><span><!--#include virtual="/scripts/forum-comments-num.php?i=4069"--></span></p>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 30.11.2002
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=2" target="_blank">Максим Дубинин</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
