<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Использование метрики Левенштейна для поиска аналогов названий</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Использование метрики Левенштейна для поиска аналогов названий</h1>
<p class="ann">Описание алгоритма и скрипт</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=3938"--></span></p>
<p><strong>Оглавление</strong></p>
<ol>
	  <li><a href="#intro">Введение</a></li>
	  <li><a href="#theory">Теория </a></li>
	  <li><a href="#code">Программная реализация </a></li>
</ol>

<!-- Первый раздел -->
<h2><strong><a name="01" id="01"></a></strong>1. Введение </h2>
<p><a href="http://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D1%81%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D0%B5_%D0%9B%D0%B5%D0%B2%D0%B5%D0%BD%D1%88%D1%82%D0%B5%D0%B9%D0%BD%D0%B0" target="_blank" class="external">Расстояние Левенштейна</a> (также редакционное расстояние или дистанция редактирования)  — мера разницы двух строк относительно минимального количества операций вставки, удаления и замены, необходимых для перевода одной строки в другую или другими словами расстояние между строками.</p>
<p>В данной статье вводится понятие метрики, заданной на множестве строк и приводится пример функции, написанной на языке Python, вычисляющей расстояние между двумя строками.</p>
<p>Часто приходится иметь дело с информацией, представимой в виде последовательности символов, чисел и т.п., т.е. строковыми данными. При этом не менее часто в строковую информацию вносятся искажения, избежать которых очень трудно. Простейшим примером может служить любая более менее крупная база данных: почти навеняка в ней содержатся ошибки оператора, сделанные при наборе. Поэтому задача сравнения строк, определение степени их близости между собой, - задача весьма востребованная. </p>
<p>Практическая задача может быть представлена следующим образом. Имеем два набора данных, в нашем случае исходный - список названий населенных пунктов к которым нужно найти альтернативы, опорный - список правильных названий населенных пунктов. Исходный список может изобиловать ошибками и неточностями, необходимо посчитать расстояние от каждого вхождения исходного списка к опорным. Результат 0 может показывать, что в исходном списке есть абсолютный аналог в опорном, 1, что в опорном есть аналоги отличающиеся на 1 символ и т.д. </p>
<p>Метрика Левеншейна использовалась для перевода базы данных по населенным пунктам с Vmap0 <a href="/qa/vmap0-settl-rus.html">на русский язык</a>. В качестве опорной использовалась база данных КЛАДР.</p>
<h2><strong><a name="theory" id="theory"></a></strong>2. Теория</h2>

<p>Предположим, что имеется некоторое множество каких-либо элементов (например, множество символьных строк, или множество точек на плоскости или др.). Предположим, что было выбрано наугад два элемента заданного множества, и перед нами стоит задача установить, насколько они близки друг к другу. Если элементы заданного множества - точки евклидова пространства, то все решается просто: зная координаты точек, мы всегда можем определить расстояние между ними. А если множество состоит из более сложных объектов, у которых нет координат (как, например, строки)? Таким образом мы приходим к необходимости создания инструмента, позволяющего измерять расстояния между элементами множества. Таким инструментом является метрика - математическое обобщение понятия "расстояние".</p>
<p>Метрика - это фунция <img src="/images/levenshtein-01.png" alt="d(x,y)" width="67" height="25" />, которая берет на входе два элемента x и y исходного множества, и возвращает расстояние между этими элементами. Однако, функция <img src="/images/levenshtein-01.png" alt="d(x,y)" width="67" height="25" /> - это не любая функция, а удовлетворяющая определенным условиям:</p>
<ol>
  <li><img src="/images/levenshtein-02.png" alt="d(x,y)>=0" width="96" height="25" /> для любых пар x и y, причем <img src="/images/levenshtein-03.png" alt="d(x,y)=0" width="96" height="25" /> тогда и только тогда, когда x=y. Требование очевидно: расстояние между объектами не может быть меньше нуля, и расстояние между совпадающими объектами должно быть равно нулю.</li>
                  <li><img src="/images/levenshtein-04.png" alt="d(x,y)=d(y,x)" width="150" height="25" /> для любых x и y. Также очевидное требование: расстояние не должно зависеть от того, как мы его меряем от x к y или в обратном направлении, от y к x.</li>
                  <li><img src="/images/levenshtein-05.png" alt="d(x,y)+d(y,z)&gt;=d(x,z)" width="230" height="25" />. Это неравенство должно выполняться для любых x,y и z. Суть этого неравенства также понятна: путь "напрямую" должен быть короче (во всяком случае, не длиннее), чем "в объезд".</li>
</ol>
<p>Эти три условия называются аксиомами метрики, а множество, на котором задана функция <img src="/images/levenshtein-01.png" alt="d(x,y)" width="67" height="25" />, удовлетворяющая этим аксиомам - метрическим пространством.</p>
            <p>Понятно, что на одном и том же множестве можно задать разные метрики и в результате будут получаться разные пространства. При этом, может оказаться так, что при одном выборе метрики <img src="/images/levenshtein-06.png" alt="d(x1,y1)&lt;d(x2,y2)" width="226" height="44" />, а при другом выборе для этих же точек будет выполняться противоположное неравенство: <img src="/images/levenshtein-07.png" alt="d(x1,y1)&gt;d(x2,y2)" width="226" height="44" />. Поэтому при решении конкретной задачи, возможно, потребуется длительный процесс построения адекватной метрики.</p>
            <p>На множестве строк может быть задано большое число метрик, соответствующих той или иной задаче. Здесь рассмотрим одну из такого рода метрик, называемую метрикой Левенштейна. Эту метрику применяют обычно для определения степени искажения строк. Мы не будем давать строгого определения метрики Левенштейна, лишь заметим, что, говоря простым языком, эта метрика представляет собой число опечаток, которые были сделаны при наборе строки test по сравнению с эталоном pattern. Например:</p>

	<table width="85%" align="center">
		<tr>
			<th>test</th>		<th>pattern</th>		<th>d(test,pattern)</th>
		</tr>
		<tr>
			<td>abcd</td>		<td>acd</td>		<td>1</td>
		</tr>
		<tr>
			<td>abcd1</td>		<td>abcd5</td>		<td>1</td>
		</tr>
		<tr>
			<td>bcd</td>		<td>acd</td>		<td>1</td>
		</tr>
		<tr>
			<td>axyd</td>		<td>acd</td>		<td>2</td>
		</tr>
		<tr>
			<td>acbd</td>		<td>abcd</td>		<td>2</td>
		</tr>
		<tr>
			<td>xyz</td>		<td>abcd</td>		<td>4</td>
		</tr>
	</table>
            <h2><strong><a name="code" id="code"></a></strong>3. Программная реализация </h2>
            <ul>
              <li>Python</li>
              <li>Pascal и внешняя dll</li>
              </ul>
            <h3>Python</h3>
            <p>Для решения конкретной задачи можно использовать следующую программную реализацию на языке Питон.</p>
            <p>Работа производится с файлами dbf. Для работы необходим скрипт <a href="http://dbfpy.sourceforge.net/" target="_blank" class="external">dbfpy</a>. Перед запуском программы необходимо установить dbfpy. </p>
<p>Для работы необходимо:</p>
<ol>
  <li>Скачать и распаковать <a href="/programs/python/levenshtein.7z">программный код</a> </li>
  <li>Установить парамеры в файле <strong>config.conf</strong>. Необходимо установить:
    <ul>
      <li> имя исходного файла - для которого надо произвести поиск: inFile и название поля в нем </li>
      <li>имя рефенц-файла - является источником альтернатив: alternativeFile и название поля в нем inField</li>
      <li>имя выходного файла - будет являться копией исходного + добавленные поля с результатом: newFile - имя файла, newStringField - имя строкового поля и максимальное число символов в этом поле (maxStrLen) и, наконец, newNumField - имя поля, в котором будут храниться полученные в результате работы скрипта расстояния до найденных альтернатив</li>
      <li> настройки поиска: maxDist - максимально допустимое расстояние между шаблоном и альтернативой, levelCount - число уровней поискового дерева</li>
        </ul>
  </li>
  <li>Запустить скрипт поиска альтернатив <strong>conv.py</strong> при этом автоматически будет создано дерево поиска, определяемое в модуле  <strong>searchtree.py</strong>. Поисковое дерево ускоряет процесс поиска альтернатив. При настройке числа уровней дерева нужно учитывать два противоположных требования: с одной стороны, чем больше уровней дерева будет построено, тем быстрее будет идти поиск альтернатив на больших файлах, с другой стороны, чем больше уровней будет задано, тем дольше будет строиться дерево.</li>
</ol>
<p>Пример результата можно посмотреть в файле <strong>out1-sample.dbf</strong></p>
<h3>Pascal и внешняя DLL </h3>
<p><a href="/programs/scripts/levenshtein.7z">Скачать</a> исходный код на Pascal, DLL и скрипт на Avenue для использования библиотеки в Arcview GIS.
  <!-- обсуждение на форуме, цифра изменяется при публикации статьи --> Функция check принимает два строковых параметры и выдает целое число - результат.
</p>
<p class="discuss">
   <span><!--#include virtual="/scripts/forum-comments-num.php?i=3938"--></span>
</p>
<!-- ссылки -->
<div class="links">
	<h2>Ссылки по теме</h2>
		<ul>
			<li><a href="http://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D1%81%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D0%B5_%D0%9B%D0%B5%D0%B2%D0%B5%D0%BD%D1%88%D1%82%D0%B5%D0%B9%D0%BD%D0%B0" target="_blank" class="external">Расстояние Левенштейна на Wikipedia</a></li>
			<li><a href="http://ru.wikibooks.org/wiki/Расстояние_Левенштейна" target="_blank" class="external">Реализации алгоритма на других языках программирования </a></li>
		</ul>
</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 09.09.2009
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=6597" target="_blank">Дмитрий Колесов</a>, <a href="/forum/memberlist.php?mode=viewprofile&u=2" target="_blank">Максим Дубинин</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
