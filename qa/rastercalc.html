<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Растровая арифметика в QGIS с помощью RasterCalc</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>Растровая арифметика в QGIS с помощью RasterCalc</h1>
<p class="ann">Растровая арифметика в QGIS</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=6302"--></span></p>
<p>RasterCalc&nbsp;&mdash; легкий в использовании и функциональный калькулятор
растров реализованный как расширение для свободной ГИС с открытым кодом&nbsp;&mdash; QGIS.</p>
<p><strong>Оглавление</strong></p>
<ol>
    <li><a href="#01">Замечания по установке</a></li>
    <li><a href="#02">Работа с расширением</a></li>
    <li><a href="#contacts">Контакты</a></li>
</ol>

<!-- Первый раздел -->
<h2><strong><a name="01" id="01"></a></strong>1. Замечания по установке</h2>
<p>Расширение доступно из <a href="/programs/qgis/qgis-repo.xml">репозитория ГИС-Лаб</a>.</p>
<p>RasterCalc разработан для QGIS версии 1.0.0 и старше. Для своей работы
требует наличия следующих Python-модулей:</p>
<ul>
  <li>pyparsing&nbsp;&mdash; библиотека синтаксического анализа</li>
  <li>osgeo.gdal&nbsp;&mdash; Python интерфейс к библиотеке GDAL</li>
</ul>
<p>Если эти модули отсутсвуют, при попыке запуска расширения появится
сообщение об ошибке.</p>
<p>Проще всего тем, кто пользуется инсталлятором OSGeo4W&nbsp;&mdash; в нем
есть все необходимое. Нужные пакеты называются pyparsing и gdal-python.
Если используется официальный установщик &laquo;все-в-одном&raquo; (не OSGeo4W):
потребуется скачать и установить <a href="http://pyparsing.wikispaces.com" target="_blank" class="external">pyparsing</a>,
все остальные модули уже включены в инсталлятор.</p>

<!-- Второй раздел -->
<h2><strong><a name="02" id="02"></a></strong>2. Работа с расширением</h2>
<p>После подключения и запуска расширения с помощью кнопки <img src="/images/rastercalc-01.png" alt="Кнопка расширения" width="32" height="32"></img>
появится окно, похожее на калькулятор:
<p><img src="/images/rastercalc-02.png" alt="Окно плагина" width="742" height="460"></img></p>
<ol>
  <li>список растров, загруженных в проект. Растры сгруппированы по размерам</li>
  <li>список каналов растра, заполняется автоматически при выборе растра</li>
  <li>кнопки для быстрой вставки функций. Тут же находится выпадающий список
  шаблонов выражений</li>
  <li>область ввода, в которой по мере набора отображается выражение. Поддерживается
  копирование и вставка текста
  <li>строка сообщений, в которой отображаются ошибки, предупреждения и
  информационные сообщения</li>
  <li>кнопка очистки области ввода</li>
  <li>выпадающий список для управления форматом пикселей итогового растра</li>
  <li>поле для ввода имени итогового файла</li>
  <li>флажок, позволяющий загружить результат вычислений на карту</li>
  <li>кнопки запуска вычислений и закрытия окна</li>
</ol>
<p>Формат выражений&nbsp;&mdash; традиционный, как в математике; есть поддержка
скобок, в том числе вложенных. Имена растров должны заключаться в квадратные
скобки ("[]"), после имени растра через &laquo;собаку&raquo; ("@") обязательно указывается
номер канала. Вставка имени растра выполняется по двойному клику на соответствующем
элементе списка растров, при этом автоматически будет использован (и добавлен к
имени) 1й канал. Вставка выбранного растра вместе с нужным номером канала возможна
по двойному клику на нужный номер канала в списке каналов.</p>
<p>Некоторые распространенные операции доступны в виде &laquo;шаблонов&raquo;. После
выбора такого &laquo;шаблона&raquo; из выпадающего списка, в область ввода
вставляется заготовка, в которой условные растры нужно заменить своими.</p>
<p>В процессе набора выражения осуществляется его проверка. При наличии ошибок в
строку сообщений выводится соответсвующий текст, а кнопка &laquo;Рассчитать&raquo;
блокируется.</p>
<p>При помощи кнопок быстрого ввода доступны:</p>
<ol>
  <li>арифметические действия (+, -, *, /)</li>
  <li>тригонометрические функции (sin, cos, tan, asin, acos, atan)</li>
  <li>натуральный логарифм (log), экспонента (exp) и возведение в степень (^)</li>
  <li>вставка скобок, знак взятия канала</li>
</ol>
<p>Реализованы, но не имеют кнопок быстрой вставки (т.е. вводить необходимо вручную):</p>
<ol>
  <li>операторы сравнения (&lt;, &gt;, =, !=, &lt;=, &gt;=)</li>
  <li>условные операторы (lt - меньше, gt - больше, eq - равно, ne - не равно,
  le - меньше или равно, ge - больше или равно)</li>
</ol>
<p>Операторы сравнения позволяют попиксельно сравнить канал растра с некоторой
величиной или другим каналом этого же или любого другого растра. Результатом
сравнения будет растр, в котором все пиксели, удовлетворяющие условию получат
значение 1, а все остальные, соответственно, 0.</p>
<p>Условные операторы являются дальнейшим развитием операторов сравнения.
Оператор принимает три аргумента:</p>
<ol>
  <li>растр, который сравнивается</li>
  <li>величина, с которой сравниваем</li>
  <li>величина, используемая для замены значений</li>
</ol>
<p>Второй и третий аргументы могут быть числом, произвольным каналом растра
(в этом случае выполняется попиксельное сравнение и/или замена), выражением.</p>
<p>Рассмотрим использование условных операторов на примерах. Конструкцию</p>
<pre>le( [relief]@1, 50, 200 )</pre>
<p>следует читать так: всем пикселям 1го канала растра relief, значение
которых меньше или равно 50, присвоить значение 200. Еще два примера</p>
<pre>eq( [relief]@1, [mask]@4, 150 )</pre>
<p>пиксели растра relief, значение которых равно соответствующим пикселям
растра mask станут равны 150.</p>
<pre>gt( [relief]@1, [mask]@4, [base]@2 )</pre>
<p>пиксели растра relief, значение которых больше или равно соответствующим
пикселям растра mask будут заменены соответствующими пикселями растра base.</p>
<h2><strong><a name="contacts" id="contacts"></a></strong>3. Контакты</h2>
<p>Если вы нашли ошибку, у вас есть предложения по улучшению плагина или просто вопросы
по использванию&nbsp;&mdash; напишите <a href="mailto:alexander.bruy@gmail.com">разработчикам</a> (еще <a href="/contacts.html">контакты</a>).</p>
<p class="discuss"><span><!--#include virtual="/scripts/forum-comments-num.php?i=6302"--></span></p>

<div class="links">
	<h2>Ссылки по теме</h2>
		<ul><li><a href="/docs/qgis">Документация по QGIS</a></li>
		</ul>
</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 27.01.2010
<br>Автор(ы): <a href="forum/memberlist.php?mode=viewprofile&u=5325" target="_blank">Александр Бруй</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
