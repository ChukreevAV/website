<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: Добавление новых систем координат, сфероидов, трансформаций в ArcGIS</title>
<!--#include virtual="/inc/header2.txt" -->
<!--Contents start-->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<h1>Добавление новых систем координат, сфероидов, трансформаций в ArcGIS</h1>
<p class="ann">Статья для тех, кого стандартный набор различных элементов  систем координат недостаточен. Разобрана на конкретном примере  технология добавления новой системы координат и набора параметров трансформации. </p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=1474"--></span></p>
<p>В процессе работы с ArcGIS, пользователь имеет возможность создавать свои сфероиды, системы координат и трансформации, однако сохранены они будут только для данного проекта, при открытии нового, по умолчанию, их придется создавать заново.</p>
            <p>Используя описываемый ниже подход, можно создавать постоянные описания новых элементов описания систем координат, используемые во многих проектах и создаваемые один раз. С помощью данного подхода можно создавать следующие элементы: </p>
            <ul>
              <li>datum - датум </li>
              <li>geogcs - географическая система координат </li>
              <li>geogtran - набор параметров трансформации из определенной географической системы координат в WGS84 </li>
              <li>primem - главный меридиан </li>
              <li>projcs - спроектированная (прямоугольная) система координат </li>
              <li>spheroid - сфероид (эллипсоид) </li>
              <li>unit - единица измерения </li>
            </ul>
            <p>1. Создать переменную PEOBJEDITHOME равную пути к определенной папке, где будут храниться описания элементов, в начале данная папка будет пуста, например:</p>
            <tcode>PEOBJEDITHOME = C:\Gis\arcexe9x\csparams\</tcode>
            <p>2. В созданной папке необходимо создать описания нужных элементов описания системы координат. Названия файлов описаний и их содержание должны следовать строго определенной форме. Ошибка в содержании может привести к неработоспособности ArcGIS. </p>
            <ul>
              <li>DATUM,code,&quot;name&quot;,&lt;spheroid_code&gt;</li>
              <li>GEOGTRAN,code,&quot;name&quot;,&lt;gcs1_code&gt;,&lt;gcs2_code&gt;,&lt;method_code&gt;, &lt;parameter_code1&gt;,&lt;parameter_value1&gt;,..., &lt;parameter_codeN&gt;,&lt;parameter_valueN&gt;</li>
              <li>PRIMEM,code,&quot;name&quot;,&lt;value&gt;</li>
              <li>GEOGCS,code,&quot;name&quot;,&lt;datum_code&gt;,&lt;primem_code&gt;,&lt;unit_code&gt;</li>
              <li>PROJCS,code,&quot;name&quot;,&lt;gcs_code&gt;,&lt;projection_code&gt;, &lt;parameter_code1&gt;,&lt;parameter_value1,..., &lt;parameter_codeN&gt;,&lt;parameter_valueN&gt;,&lt;unit_code&gt;</li>
              <li>SPHEROID,code,&quot;name&quot;,&lt;semimajor axis&gt;,&lt;1/f&gt;</li>
              <li>UNIT,code,&quot;name&quot;,&lt;value&gt;</li>
            </ul>
            <p>В одном файле элементов описания может содержаться несколько описаний этого элемента. Каждому описанию (новому и существующему) соответствует определенны код, по которому этот элемент будет потом связан с другими элементами. Стандартные коды для различных элементов и рекомендуемые коды для новых элементов этого же типа (в скобках):</p>
            <ul>
              <li>Линейные единицы измерения 9000-9099 (209000-209099) </li>
              <li>Угловые единицы измерения 9100-9199 (209100-209199)</li>
              <li>Сфероиды 7000-7999 (207000-207999)</li>
              <li>Датумы 6000-6999 (206000-206999)</li>
              <li>Стандартные меридианы 8900-8999 (208900-208999)</li>
              <li>Географические системы координат 4000-4999 (204000-204999)</li>
              <li>Спроектированные системы координат 2000-2999 (202000-202999)</li>
              <li>Наборы параметров трансформации 8000-8399 (208000-208399)</li>
            </ul>
            <p>Таким образом, для новых описаний использовать значение стандартного кода для этого элемента + 200000. Например: для нового описания сфероида, зная что для уже существующих описаний рарезервирован диапазон 7000-7999 лучше использовать 207000-207999. </p>
            <p>Параметры в файле должны быть разделены запятыми, поэтому использовать запятую для разделения целой и дробной части нельзя. Для некоторых элементов вместо значений параметров могут использоваться специальные обозначения - макросы. </p>
            <p>Элементы высокого уровня требуют предварительного создания и настройки элементов более низкого уровня. Например: для определения новой географической системы координат может понадобится определить также новый сфероид и датум, если они еще не определены. Также, если изменяются параметры элемента низкого уровня, меняются связанные с ним элементы высокого уровня. Например: изменив параметры единиц измерения &quot;метры&quot;, изменятся все использующие этот элемент проекции.</p>
            <p>После определения новых элементов, первый вызов списка элементов в ArcGIS может занять значительное время.</p>
            <p><strong>Пример создание новой системы координат и комплекса преобразований NEWCS - WGS1984</strong></p>
            <p>Данный пример показывает пример пошаговой настройки всех составляющих нового описания системы координат, значения, используемые в примере выбраны случайным образом и не являются параметрами какой-либо системы координат. Для использования конкретного преобразования, пользователю понадобится ввести свои значения. </p>
            <p>1. Создать описание нового сфероида</p>
            <tcode><strong>/* SPHEROID,code,&quot;name&quot;,&lt;semimajor axis&gt;,&lt;1/f&gt; */</strong><br />
                  SPHEROID,207001,&quot;NEW&quot;,6378136,298.25784</tcode>
            <p>2. Создать новый датум</p>
            <p>Код сфероида - 207001 связывает созданный датум со сфероидом созданным на предыдущем этапе. </p>
            <tcode><strong>/* DATUM,code,&quot;name&quot;,&lt;spheroid_code&gt; */</strong><br />
                  DATUM,206001,&quot;D_NEW&quot;,207001</tcode>
            <p>3. Создать новую систему координат и файл его описания </p>
            <p>Код датума - 206001 связывает новую систему координат с новым датумом. </p>
            <tcode><strong>/* GEOGCS,code,&quot;name&quot;,&lt;datum_code&gt;,&lt;primem_code&gt;,&lt;unit_code&gt; */ </strong>GEOGCS,204001,&quot;NEWCS&quot;,206001,PE_PM_GREENWICH,PE_U_DEGREE</tcode>
            <p>Отдельный файл описания географической системы координат (расширение файла - prj) включает определенные на предыдущих шагах описания датума и сфероида и понадобится для присвоения этой системы координат новым данным. Данный файл должен быть размещен в одной поддиректорий директории Coordinate Systems, находящейся в директории инсталляции ArcGIS. Например, месторасположение файла *.prj с описанием новой системы координат может быть таким: </p>
            <p>c:\Gis\arcgis\Coordinate Systems\Geographic Coordinate Systems\Europe\new.prj</p>
            <tcode>GEOGCS[&quot;NEWCS&quot;,DATUM[&quot;D_NEW&quot;,<br />
                  SPHEROID[&quot;KRASOVSKY2&quot;,6378245,298.3]]<br />
                  PRIMEM[&quot;Greenwich&quot;,0.0],UNIT[&quot;Degree&quot;,0.0174532925199433]]</tcode>
            <p>4. Создать набор параметров трансформации</p>
            <p>Этот набор параметров должен, помимо нового кода для себя (208001), сослаться на код новой системы координат (204001), так как трансформация в данном примере осуществляется в WGS84, то вместо ее кода, можно использовать специальное название (макрос) для этой системы вместо кода - <span>PE_GCS_WGS_1984. Далее, в зависимости от выбранного типа трансформации (в данном случае PE_MTH_COORDINATE_FRAME), также необходимо также определить все ее параметры.</p>
            <tcode><strong>/* GEOGTRAN,code,&quot;name&quot;,&lt;gcs1_code&gt;,&lt;gcs2_code&gt;,&lt;method_code&gt;, &lt;parameter_code1&gt;,&lt;parameter_value1&gt;,..., &lt;parameter_codeN&gt;,&lt;parameter_valueN&gt; */ <br />
                </strong>GEOGTRAN,208001,&quot;NEWCS_To_WGS_1984&quot;,204001,&quot;PE_GCS_WGS_1984&quot;,<br />
                &quot;PE_MTH_COORDINATE_FRAME&quot;,&quot;PE_PAR_X_AXIS_TRANSLATION&quot;,-1.08,<br />
                &quot;PE_PAR_Y_AXIS_TRANSLATION&quot;,-0.27,&quot;PE_PAR_Z_AXIS_TRANSLATION&quot;,-0.9,<br />
                &quot;PE_PAR_X_AXIS_ROTATION&quot;,0.0,&quot;PE_PAR_Y_AXIS_ROTATION&quot;,0.0,<br />
                &quot;PE_PAR_Z_AXIS_ROTATION&quot;,-0.16,&quot;PE_PAR_SCALE_DIFFERENCE&quot;,-0.12</p></tcode>
            <p>5. Проверить работоспособность</p>
            <p>Для того, чтобы убедиться, что  все работает корректно, необходимо:</p>
            <ul>
              <li>Загрузить ArcGIS и добавить тему, имеющую систему координат GCS_WGS_1984</li>
              <li>Установить систему координат фрейма данных равную NewCS (View\Data Frame Properties\Coordinate System\Predefined)</li>
              <li>После выбора системы координат, необходимо нажать на кнопку Transformations, если все перечисленные выше шаги сделаны правильно, ArcGIS автоматически найдет и предложит созданную трансформацию &quot;NEWCS_To_WGS_1984&quot; с настроенными параметрами. </li>
            </ul>
            <p align="center"><img src="/images/newcs-ag-01.gif" alt="настройки трансформации" width="426" height="308" /> </p>
            <p class="discuss">
				<span><!--#include virtual="/scripts/forum-comments-num.php?i=1474"--></span>
			</p>
			<div class="links">
			<h2>Ссылки по теме</h2>
			<ul>
               <li><a href="http://edndoc.esri.com/arcsde/9.1/capi_concepts/using_persistent_user.htm" target="_blank" class="external">Using persistent user-defined objects</a></li>
			</ul>
			</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 15.04.2007
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=2" target="_blank">Максим Дубинин</a></span></p>
<!--#include virtual="/inc/footer2.php" -->