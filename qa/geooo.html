<!--#include virtual="/inc/header02.txt" -->
<title>GIS-Lab: GeOOo: административное деление РФ в OpenOffice</title>
<!--#include virtual="/inc/header2.txt" -->
<div class="cont">
<div class="col1">

<ul class="path">
   <li class="first"><a href="/">Главная</a></li>
   <li><a href="/qa.html">Вопросы и ответы</a></li>
</ul>
<!--Contents start-->
<h1>GeOOo: административное деление РФ в OpenOffice </h1>
<p class="ann">Использование  данных деления РФ для GeOOo/OpenOffice</p>
<p class="discuss discuss_top"><span><!--#include virtual="/scripts/forum-comments-num.php?i=7427"--></span></p>
<p>Одним из приложений картографии является бизнес-анализ, где картография используется для  оценки ситуации и построения тематических карт и схем. Коснемся смежных программ, разрабатываемых во Франции и традиционно слабо освещенных в интернете. Надеюсь, это станем первой частью цикла статей о Business Intelligence, но в данном случае она предназначена для самого широкого круга читателей.</p>

<p>Эта статья посвящена GeOOo ― расширению для работы с тематическими картами в OpenOffice (LibreOffice, Go-OO и т.п.). Программа позволяет создавать наглядные карты распределения показателей, например такие:</p>
<p align="center"><img src="/images/geooo-01.png" alt="" width="670" height="449" border="0" /></p>
<p>&nbsp;</p>
<h2>GeOOo</h2>
<p>Разработчик ― Christian Hervé. <a href="http://code.google.com/p/geooo/" target="_blank" class="external">Страница разработки</a> и <a href="http://geoooblog.blogspot.com/" target="_blank" class="external">блог автора</a>.</p>
<p>Лицензия ― GPL v2 и CC-BY.</p>
<p>Адрес в каталоге расширений OpenOffice: <a href="http://extensions.services.openoffice.org/project/GeOOo" target="_blank" class="external">http://extensions.services.openoffice.org/project/GeOOo</a>. Для установки расширения необходимо нажать Get It и открыть его с помощью OpenOffice, менеджер расширений сделает все что нужно. </p>
<p>Для работы потребуются OO.Calc и  OO.Draw. Необходим также OO.Base, так как программа  хранит настройки в базе данных. Для  перевода интерфейса программы на русский  язык, положите файл <a href="/other/geooo.7z">DialogStrings_ru.properties</a> в  папку:</p>
<pre>C:\Documents and Settings\%Имя_пользователя%\Application Data\<br>LibreOffice\3\user\uno_packages\cache\uno_packages\%случ._имя%.tmp_\geooo.oxt\geooo\</pre>
<p>Или в OpenOffice (Windows 7):</p>
<pre>C:\Users\%Имя_пользователя\AppData\Roaming\OpenOffice.org\3\user\uno_packages\<br>cache\uno_packages\%случ._имя%.tmp_\geooo.oxt\geooo\</pre>
<p>Благодаря проекту собирающему <a href="osm-adm.html">данные по АТД РФ</a>, на базе данных OpenStreetMap подготовлена карта регионов России. Она была переведена в формат SVG и на ее основе был создан файл для программы Draw, используемый как основа. </p>
<p>Откройте таблицу «Данные.ods». Как видите, это обычные данные демографии (по состоянию на 1 января 2010 г.). На каждый субъект федерации приведено общая численность население, количество родившихся и умерших. Для связи с картой введено поле «Код», где каждому региону присвоено обозначение по ИСО 3166-2.</p>
<p>Начать работу с GeOOo нужно с открытия OO.Draw, далее откроем файл russia.odg и выберем из меню Tools\Add-On\GeOOo.</p>
<p align="center"><img src="/images/geooo-05.png" alt="" width="453" height="330" border="0" /></p>
<p>&nbsp; </p>
<p><strong>Шаг 1. Original data</strong></p>
<p>В графе <em>Таблица</em> пишем «Russia», <em>Лист</em> ― «Демография». В будущем программа запомнит эти значения и их можно будет выбрать из списка.</p>
<p>Выбираем технику ― цвет.</p>
<p><strong>Шаг 2. Where are data</strong></p>
<p>Цветовая шкала. Можно задать, вводя пограничные значения вручную и выбирая цвета. Но мы воспользуемся подготовленной палитрой. Нажмите на кнопку «…» и укажите файл «Палитра.ods». Чуть позже я расскажу как он создается.</p>
<p>Укажите путь к файлу таблицы ― «Данные.ods».</p>
<p><strong>Шаг 3. What data deal</strong></p>
<p>Как упоминалось выше, <em>Ключ</em> для связи таблицы и карты записан в колонке «Код». Графа <em>Описание</em> не обязательная, но можете сослаться на колонку «Субъект». Значение (Знач. 1) будем брать из колонки «Население».</p>
<p><strong>Шаг 4. Which display options</strong></p>
<p>Зададим только формат чисел «### ###» (без дробной части с разделением тысяч).</p>
<p>Нажимаем «Запуск» и программа приступает к работе:</p>
<p align="center"><img src="/images/geooo-02.png" alt="" border="0" /></p>
<p><strong>Круговые диаграммы </strong></p>
<p>Теперь добавим к этой карте информацию по родившимся и умершим. В таблице эта информация содержится в колонках «Родилось» и «Умерло». Вновь запускаем приложение GeOoo и выбираем из списка таблицу «Russia» и лист «Демография». Будет использоваться техника «Полукруги».</p>
<p>На третьем шаге укажем колонки:</p>
<ul>
  <li><em>Знач. 1</em> ― Родилось</li>
  <li><em>Знач. 2</em> ― Умерло</li>
  </ul>
<p>Выберите для них цвета и описание Легенды (можно аналогично ввести «Родилось» и «Умерло»).</p>
<p>На следующем этапе размеры кругов укажите как 3 и 12 мм (зависит от используемой карты и требуемого результата). И обязательно поставьте галочку «не очищать пред. результат», иначе информация о численности населения будет удалена с карты.</p>
<p>Результат:</p>
<p align="center"><img src="/images/geooo-03.png" alt="" border="0" /></p>
<p>Программа старается разместить полукруги в центрах полигонов, но если результат неудовлетворительный, то их можно поправить вручную.</p>
<p>Программа предлагает несколько техник и различные варианты настроек. В частности, карта из примера рассчитана на число классов не более 10. Если понадобится больше, то придется вручную создать стили geo11, geo12 и т.д. на базе стиля geo.</p>
<p><strong>Палитра</strong></p>
<p>При анализе зачастую градации шкалы известны заранее. Например, если проводится бизнес-анализ, то это могут быть показатели «убыточность», «минимальная ликвидность», «прибыльное производство».</p>
<p>Здесь же приведены шаги по созданию равномерно распределенной палитры. Воспользуемся понятием «персентиль» (частный случай квантиля). Это такая величина, которая делит выборку на 100 частей, причем в каждую из них попадает одинаковое число значений. Это позволяет выделить мелкие различия в часто встречающихся случаях и объединить редкие.</p>
<p>Например, создается шкала для равнинного рельефа с редкими возвышенностями. если использовать линейное распределение, то все низинные области скорее всего попадут в один класс и будут неразличимы. Использование персентилей выделит больше классов для часто встречающихся показателей (отметки на равнине) и меньше для редких (гористые районы).</p>
<p>Пример вычислений по колонке «Население» приведен в файле «Данные.ods». Программа GeOOo также добавляет на панель инструментов новую функцию ― цветной градиент. Для него нужно задать начальный и конечный цвета, выделить диапазон и нажать кнопку:</p>
<p align="center"><img src="/images/geooo-04.png" alt="" border="0" /></p>
<p>Чтобы сохранить палитру для дальнейшего использования скопируйте ее в новый файл (не забудьте преобразовать формулы в значения). Колонка цвета называется «col», значений ― «val».</p>
<p><strong>Примечание</strong></p>
<p>Программа GeOOo работает достаточно стабильно, но LibreOffice при ее использовании может сообщить об ошибке при закрытии документов. За все время общения с программой ничего критического не произошло.</p>
<p><strong>Другие разработки </strong></p>
<p>Существует коммерческий аналог GeOOo ― <a href="http://www.multiracio.com/eurooffice/products/eurooffice-map-chart" target="_blank" class="external">EuroOffice Chart Map</a>. Приложение распространяется свободно, но есть расширенная платная версия Pro.</p>
<p>Адрес в каталоге расширений OpenOffice: <a href="http://extensions.services.openoffice.org/project/eurooffice-chart-map" target="_blank" class="external">http://extensions.services.openoffice.org/project/eurooffice-chart-map</a></p>
<p>Упомянем остальные разработки  того же автора, которые пригодятся в  дальнейшем:</p>
<ul>
  <li><a href="http://extensions.services.openoffice.org/fr/project/RGB" target="_blank" class="external">RGB</a> ― улучшенная палитра для выбора цвета;</li>
  <li><a href="http://extensions.services.openoffice.org/fr/project/DbR" target="_blank" class="external">Database Range</a> ― работа с базами данных. Далее по тексту мы приведем пример работы с GeOOo, где данные загружаются просто из таблицы OO.Calc, но для серьезной работы может потребоваться работа с базами данных;</li>
  <li><a href="http://geoooblog.blogspot.com/p/kmlooo.html" target="_blank" class="external">KmlOOo</a> ― расширение для импорта в OO.Draw данных в формате KML.</li>
</ul>
<p>Бесплатные  карты можно загрузить с сайтов:</p>
<ul>
  <li><a href="http://d-maps/" target="_blank" class="external">d-maps.com</a></li>
  <li><a href="http://histgeo.ac-aix-marseille.fr/carto/index.htm" target="_blank" class="external">Histoire-Geographie de l'academie d'Aix-Marseille</a></li>
</ul>
<p>Кстати, сайт d-maps.com поддерживается компанией <a href="http://www.begraphic.com/" target="_blank" class="external">BeGraphics</a>, предлагающей решения, аналогичные GeOOo, для Microsoft Office и распространяющей пакет BeGraphic Lite Version бесплатно. Приятная программа, <a href="http://www.begraphic.com/interactive-maps.html" target="_blank" class="external">красивые карты</a>.</p>
<p>Здесь же отметим <a href="http://ooo.hg.free.fr/ooohg/ooohg.html" target="_blank" class="external">Ooo.HG</a> ― History and Geography (автор Gilles Badufle), это расширение галереи OpenOffice, где собраны контурные карты и элементы оформления (указатели на север, масштабные линейки), тематические карты (физгеография, экономика, религии), исторические карты и временные шкалы, материалы по демографии. В общем, полный набор методического материала для преподавателя истории, географии и социологии. Все материалы распространяются на условиях Creative Commons.</p>
<!-- обсуждение на форуме, цифра изменяется при публикации статьи -->   
<p class="discuss">
   <span><!--#include virtual="/scripts/forum-comments-num.php?i=7427"--></span>
</p>
<!-- ссылки -->
<div class="links">
	<h2>Ссылки по теме</h2>
		<ul>
			<li><a href="osm-adm.html">Границы административно-территориального деления РФ из OpenStreetMap</a></li>
			</ul>
</div>
<!--Contents end-->
<!--#include virtual="/scripts/date.php" -->
<p class="status"><span>Дата создания: 03.04.2011
<br>Автор(ы): <a href="/forum/memberlist.php?mode=viewprofile&u=6850" target="_blank">Mavka</a></span></p>
<!--#include virtual="/inc/footer2.php" -->
